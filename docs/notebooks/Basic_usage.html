<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Why lnpy? &mdash; tmmc-lnpy 999 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="API Reference" href="../api_autosummary.html" />
    <link rel="prev" title="Installation" href="../installation.html" />
<link rel="stylesheet" href="https://pages.nist.gov/nist-header-footer/css/nist-combined.css">
  <script src="https://code.jquery.com/jquery-1.12.4.min.js" type="text/javascript"></script>
  <script src="https://pages.nist.gov/nist-header-footer/js/nist-header-footer.js" type="text/javascript" defer="defer"></script>

<script async type="text/javascript" id="_fed_an_ua_tag" src="https://dap.digitalgov.gov/Universal-Federated-Analytics-Min.js?agency=NIST&subagency=github&pua=UA-42404149-54&yt=true&exts=ppsx,pps,f90,sch,rtf,wrl,txz,m1v,xlsm,msi,xsd,f,tif,eps,mpg,xml,pl,xlt,c"></script>
<script type="text/javascript" src="https://pages.nist.gov/leaveNotice/js/jquery.leaveNotice-nist.min.js"></script>
<script>
$(document).ready(function(){
  // Mark external (non-nist.gov) A tags with class "external"
  //If the adress start with https and ends with nist.gov
  var re_nist = new RegExp('^https?:\/\/((^\/)*\.)*nist\\.gov(\/|$)');
  //Regex to find address that start with https
  var re_absolute_address = new RegExp('^((https?:)?\/\/)');
  $("a").each(function(){
    var url=$(this).attr('href');
    if(re_nist.test(url) || !re_absolute_address.test(url)){
      $(this).addClass('local');
    }else{
      //This a href appears to be external, so tag it
      $(this).addClass('external');
    }
  });
  // Add leaveNotice to external A elements
  $('a.external').leaveNotice();
});
</script>
<link rel="stylesheet" type="text/css" href="https://pages.nist.gov/leaveNotice/css/jquery.leaveNotice.css" />


</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> tmmc-lnpy
          </a>
              <div class="version">
                999
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../readme.html">tmmc-lnpy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Why lnpy?</a></li>
<li class="toctree-l1"><a class="reference internal" href="#Usage">Usage</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#lnPiMasked">lnPiMasked</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Reweighting-results">Reweighting results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Calculating-Ensemble-properites">Calculating Ensemble properites</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#Collections-of-lnPi-Values">Collections of lnPi Values</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Accessing-properties-of-colleciton">Accessing properties of colleciton</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#Loading-examples">Loading examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="#Single-component-system-with-phase-transitions.">Single component system with phase transitions.</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Breaking-it-down-segmentation">Breaking it down segmentation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#local-maxima">local maxima</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Watershed">Watershed</a></li>
<li class="toctree-l3"><a class="reference internal" href="#local-free-energy">local free energy</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Construct-colleciton">Construct colleciton</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#At-a-different-\ln-z-value">At a different <span class="math notranslate nohighlight">\(\ln z\)</span> value</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Tagging-phases">Tagging phases</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#Calculation-Binodal-and-spinodal">Calculation Binodal and spinodal</a></li>
<li class="toctree-l1"><a class="reference internal" href="#Multi-component-systems">Multi component systems</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Considering-lines-of-constant-\ln-z-or-constant-\Delta-\ln-z.">Considering lines of constant <span class="math notranslate nohighlight">\(\ln z\)</span> or constant <span class="math notranslate nohighlight">\(\Delta \ln z\)</span>.</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Multicomponent-system-with-phase-transitions">Multicomponent system with phase transitions</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../api_autosummary.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../authors.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../history.html">History</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">tmmc-lnpy</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Why lnpy?</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/notebooks/Basic_usage.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<p>You can view this notebook <a class="reference external" href="https://github.com/wpk-nist-gov/lnpy/blob/master/doc/notebooks/Basic_usage.ipynb">on Github</a>.</p>
<section id="Why-lnpy?">
<h1>Why lnpy?<a class="headerlink" href="#Why-lnpy?" title="Permalink to this heading"></a></h1>
<p><code class="docutils literal notranslate"><span class="pre">lnpy</span></code> is a python package to analyze the main output of Grand Canonical Transition Matrix Monte Carlo (GC-TMMC) simulations: <span class="math notranslate nohighlight">\(\ln \Pi(N)\)</span>. Hence the name. <code class="docutils literal notranslate"><span class="pre">lnpy</span></code> is designed to calculate a host of properties in the Canonical and Grand Canonical ensembles. For a review of GC-TMMC and the property <span class="math notranslate nohighlight">\(\ln \Pi(N)\)</span>, look at some of the following references:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://journals.aps.org/pre/abstract/10.1103/PhysRevE.67.012102">Evaluating surface tension using grand-canonical transition-matrix Monte Carlo simulation and finite-size scaling</a></p></li>
<li><p><a class="reference external" href="http://dx.doi.org/10.1063/1.2064628">Direct evaluation of multicomponent phase equilibria using flat-histogram methods</a></p></li>
<li><p><a class="reference external" href="http://link.aip.org/link/?JCP/118/9915/1">Direct calculation of liquid–vapor phase equilibria from transition matrix Monte Carlo simulation</a></p></li>
<li><p><a class="reference external" href="http://dx.doi.org/10.1021/jp040218y">Metastability and instability in the Lennard-Jones fluid investigated by transition-matrix Monte Carlo</a></p></li>
</ul>
<p><span class="math notranslate nohighlight">\(\Pi(N; \mu, T, V)\)</span> is the macrostate probablity of abserving <span class="math notranslate nohighlight">\(N\)</span> particles at a given chemical potential <span class="math notranslate nohighlight">\(\mu\)</span>, temperature <span class="math notranslate nohighlight">\(T\)</span> and volume <span class="math notranslate nohighlight">\(V\)</span>. We drop the explicit mention of <span class="math notranslate nohighlight">\(\mu\)</span>, <span class="math notranslate nohighlight">\(V\)</span> and <span class="math notranslate nohighlight">\(T\)</span> below for simplicity. This distribution is related to the grand canoncial ensemble by:</p>
<div class="math notranslate nohighlight">
\[\Pi(N) = \frac{\exp(\beta \mu N) Q(N, V, T)}{\Xi(\mu, V, T)}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\beta = 1 / (k_{\rm B} T)\)</span> is the inverse temperature, <span class="math notranslate nohighlight">\(k_{\rm B}\)</span> is Boltzmann’s constant, <span class="math notranslate nohighlight">\(Q(N, V, T)\)</span> is the canonical partition funciton, and <span class="math notranslate nohighlight">\(\Xi(\mu, V, T)\)</span> is the grand canonical partition function. GC-TMMC simulation provide a means to calculate the <span class="math notranslate nohighlight">\(\ln \Pi(N; \mu, V, T)\)</span> directly. One of the truely excellent qualities of such simulations is that once <span class="math notranslate nohighlight">\(\ln \Pi\)</span> is collected at a given chemical potential <span class="math notranslate nohighlight">\(\mu_0\)</span>, it can be rescaled to any
other chemical potential <span class="math notranslate nohighlight">\(\mu\)</span> through rescaling of the form:</p>
<div class="math notranslate nohighlight">
\[\ln \Pi(N; \mu, V, T) = \ln \Pi(N; \mu_0, V, T) + \beta N (\mu - \mu_0) + C\]</div>
<p>where <span class="math notranslate nohighlight">\(C\)</span> is a normalization constant which does not effect most calculated properties. From <span class="math notranslate nohighlight">\(\ln \Pi(N)\)</span>, many thermodynamic properties can be calculated. The grand potential <span class="math notranslate nohighlight">\(\Omega\)</span>, and hence the system pressure <span class="math notranslate nohighlight">\(p\)</span>, can be obtained from</p>
<div class="math notranslate nohighlight">
\[\beta \Omega = -\beta p V = \ln \Pi(0) + \ln \left[\sum_N \Pi(N, \mu, V, T) \right]\]</div>
<p>Also, grand canonical averages can be calulated from canonical averages using <span class="math notranslate nohighlight">\(\ln \Pi(N)\)</span>:</p>
<div class="math notranslate nohighlight">
\[\overline{X} = \frac{\sum_N \Pi(N) X(N)}{\sum_N \Pi(N)}\]</div>
<p>Plus, <span class="math notranslate nohighlight">\(\ln \Pi\)</span> can be directly analyzed to identify unique phases, phase transitions, limits of stability, etc. The package <code class="docutils literal notranslate"><span class="pre">lnpy</span></code> provides a simple means to perform all the above calculations simply, and quickly.</p>
</section>
<section id="Usage">
<h1>Usage<a class="headerlink" href="#Usage" title="Permalink to this heading"></a></h1>
<div class="line-block">
<div class="line">Lets consider a simple example: a Lennard-Jones (LJ) fluid at supercritical temperatures.</div>
<div class="line">An example value of <span class="math notranslate nohighlight">\(\ln \Pi(N)\)</span> (shorted to <code class="docutils literal notranslate"><span class="pre">lnPi</span></code>) can be loaded directly from <code class="docutils literal notranslate"><span class="pre">lnpy</span></code> package:</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">lnpy.examples</span>

<span class="n">data_dict</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="n">load_example_dict</span><span class="p">(</span><span class="s1">&#39;lj_sup&#39;</span><span class="p">)</span>
<span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
lnPi_data:[-1559.75 -1550.74 -1542.43 ...   -10.01   -11.02   -12.08]
lnPi_mask:[False False False ... False False False]
state_kws:{&#39;beta&#39;: 0.6666666666666666, &#39;volume&#39;: 512.0}
extra_kws:{&#39;PE&#39;: array([    0.  ,     0.  ,    -0.02, ..., -1643.18, -1648.71, -1654.36])}
lnz:[2.77]
</pre></div></div>
</div>
<p>Here, we have the parameters</p>
<ul class="simple">
<li><p>lnPi_data: the actual value of <span class="math notranslate nohighlight">\(\ln \Pi(N)\)</span>.</p></li>
<li><p>lnPi_mask: bool array. where <code class="docutils literal notranslate"><span class="pre">mask</span> <span class="pre">==</span> <span class="pre">True</span></code>, values are ‘masked out’</p></li>
<li><p>state_kws: dict of ‘state’ variables. Here, it include the inverse temperature ‘beta’ <span class="math notranslate nohighlight">\(=\beta = 1/(k_{\rm B} T)\)</span> and the systems volume ‘volume’ <span class="math notranslate nohighlight">\(=V\)</span></p></li>
<li><p>extra_kws: dict of ‘extra’ variables. Here, it include ‘PE’, the canonical potential energy</p></li>
<li><p>lnz: log of activity <span class="math notranslate nohighlight">\(\ln z = \beta \mu\)</span>, where <span class="math notranslate nohighlight">\(\mu\)</span> is chemical potential.</p></li>
</ul>
<section id="lnPiMasked">
<h2>lnPiMasked<a class="headerlink" href="#lnPiMasked" title="Permalink to this heading"></a></h2>
<p>The first important class is <code class="docutils literal notranslate"><span class="pre">lnPiMasked</span></code>. This class handles the basics of dealing with <span class="math notranslate nohighlight">\(\ln \Pi(N)\)</span>. To create it, to the following.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>


<span class="n">ref</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">lnPiMasked</span><span class="o">.</span><span class="n">from_data</span><span class="p">(</span>
    <span class="n">lnz</span><span class="o">=</span><span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;lnz&#39;</span><span class="p">],</span>
    <span class="n">lnz_data</span><span class="o">=</span><span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;lnz&#39;</span><span class="p">],</span>
    <span class="n">data</span><span class="o">=</span><span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;lnPi_data&#39;</span><span class="p">],</span>
    <span class="n">mask</span><span class="o">=</span><span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;lnPi_mask&#39;</span><span class="p">],</span>
    <span class="n">state_kws</span><span class="o">=</span><span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;state_kws&#39;</span><span class="p">],</span>
    <span class="n">extra_kws</span><span class="o">=</span><span class="n">data_dict</span><span class="p">[</span><span class="s1">&#39;extra_kws&#39;</span><span class="p">]</span>
<span class="p">)</span>
<span class="n">ref</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;lnPi(lnz=[2.76512052])&gt;
</pre></div></div>
</div>
<p>To access the underlying data, use the follwing</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ref</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x7fa8a100af10&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Basic_usage_7_1.png" src="../_images/notebooks_Basic_usage_7_1.png" />
</div>
</div>
<section id="Reweighting-results">
<h3>Reweighting results<a class="headerlink" href="#Reweighting-results" title="Permalink to this heading"></a></h3>
<p>One of the amazing things about <span class="math notranslate nohighlight">\(\ln \Pi(N)\)</span> calculated at some chemical potential <span class="math notranslate nohighlight">\(\mu_{\rm ref}\)</span> is that it can be reweighted to any other chemical potential <span class="math notranslate nohighlight">\(\mu\)</span>. This is done with the formula</p>
<div class="math notranslate nohighlight">
\[\ln \Pi(N, \mu) = \ln \Pi(N, \mu_{\rm ref}) + \beta (\mu - \mu_{\rm ref}) N\]</div>
<p>To reweight data to another value of <span class="math notranslate nohighlight">\(\ln z\)</span>, do the following</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">reweight</span><span class="p">(</span><span class="mf">4.0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>

<span class="c1"># compare to orginal</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ref</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">ref</span><span class="o">.</span><span class="n">lnz</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">new</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">new</span><span class="o">.</span><span class="n">lnz</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;lnPi(lnz=[4.])&gt;
</pre></div></div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x7fa890797b80&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Basic_usage_9_2.png" src="../_images/notebooks_Basic_usage_9_2.png" />
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">lnPiMasked</span></code> has a variety of utilities to work with the <span class="math notranslate nohighlight">\(\ln \Pi(N)\)</span> data. For example</p>
<ul class="simple">
<li><p>zeromax: shift <span class="math notranslate nohighlight">\(\ln \Pi(N)\)</span> shuch that maximum value is zero. Useful for numerical stability</p></li>
<li><p>ma : <code class="docutils literal notranslate"><span class="pre">MaskedArray</span></code> view of data. Used when constructing phases, and working with multicomponent data.</p></li>
<li></li>
</ul>
<p>Check out the api docs for further details</p>
</section>
</section>
<section id="Calculating-Ensemble-properites">
<h2>Calculating Ensemble properites<a class="headerlink" href="#Calculating-Ensemble-properites" title="Permalink to this heading"></a></h2>
<p><span class="math notranslate nohighlight">\(\ln \Pi(N)\)</span> can be used to calculate a variety of properties in the Canonical and Grand Canonical ensembles. To make everything easier, the actual value of <span class="math notranslate nohighlight">\(\ln \Pi(N)\)</span> is wrapped in an DataArray object, which provides some nice data goodies. To access this view, use the <code class="docutils literal notranslate"><span class="pre">ref.xce</span></code> or <code class="docutils literal notranslate"><span class="pre">ref.xge</span></code> accessors (short for <em>x</em>array <em>c</em>onical/<em>g</em>rand canonical ensemble). For example, the canonical properties can be obtained as follows:</p>
<div class="admonition note">
<p>Note: We only show some of the data.</p>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># pressure</span>
<span class="n">ref</span><span class="o">.</span><span class="n">xce</span><span class="o">.</span><span class="n">pressure</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;pressure&#x27; (n_0: 5)&gt;
array([-0.        ,  0.00100796,  0.00319043,  0.00560728,  0.00813105])
Coordinates:
    beta     float64 0.6667
    volume   float64 512.0
  * n_0      (n_0) int64 0 1 2 3 4
Attributes:
    long_name:  $p({\bf n},V,T)$</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'pressure'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>n_0</span>: 5</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-570ac24d-5eb0-4238-9501-e0d2d950e414' class='xr-array-in' type='checkbox' checked><label for='section-570ac24d-5eb0-4238-9501-e0d2d950e414' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>-0.0 0.001008 0.00319 0.005607 0.008131</span></div><div class='xr-array-data'><pre>array([-0.        ,  0.00100796,  0.00319043,  0.00560728,  0.00813105])</pre></div></div></li><li class='xr-section-item'><input id='section-01f76919-7537-447d-b3a3-42ff5aba9568' class='xr-section-summary-in' type='checkbox'  checked><label for='section-01f76919-7537-447d-b3a3-42ff5aba9568' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>beta</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.6667</div><input id='attrs-d39f7f47-886d-46e5-838e-0db91649b895' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d39f7f47-886d-46e5-838e-0db91649b895' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-26b8040a-e76c-4c56-abe6-753624586167' class='xr-var-data-in' type='checkbox'><label for='data-26b8040a-e76c-4c56-abe6-753624586167' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(0.66666667)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>volume</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>512.0</div><input id='attrs-15f77fd6-022b-475f-b004-bed399b5e713' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-15f77fd6-022b-475f-b004-bed399b5e713' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f05c8e1a-02e2-48fc-8a7b-b95bdb3f0256' class='xr-var-data-in' type='checkbox'><label for='data-f05c8e1a-02e2-48fc-8a7b-b95bdb3f0256' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(512.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>n_0</span></div><div class='xr-var-dims'>(n_0)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4</div><input id='attrs-a5f1074d-fe36-4bf9-b35b-a020bf466f8e' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a5f1074d-fe36-4bf9-b35b-a020bf466f8e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5efadbff-1bf8-47c9-a127-7c3206d9b5c5' class='xr-var-data-in' type='checkbox'><label for='data-5efadbff-1bf8-47c9-a127-7c3206d9b5c5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>$n_0$</dd></dl></div><div class='xr-var-data'><pre>array([0, 1, 2, 3, 4])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-1630ff20-8061-4d2e-b565-57f4f496422f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-1630ff20-8061-4d2e-b565-57f4f496422f' class='xr-section-summary' >Attributes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>$p({\bf n},V,T)$</dd></dl></div></li></ul></div></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#  scaled Helmholtz free energy</span>
<span class="n">ref</span><span class="o">.</span><span class="n">xce</span><span class="o">.</span><span class="n">betaF</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;betaF&#x27; (n_0: 5)&gt;
array([  0.        ,  -6.23817948, -11.78825896, -16.93743845,
       -21.80391793])
Coordinates:
    beta     float64 0.6667
    volume   float64 512.0
  * n_0      (n_0) int64 0 1 2 3 4
Attributes:
    dims_n:         [&#x27;n_0&#x27;]
    dims_lnz:       [&#x27;lnz_0&#x27;]
    dims_comp:      [&#x27;component&#x27;]
    dims_state:     [&#x27;lnz_0&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]
    dims_rec:       []
    standard_name:  helmholtz_free_energy
    long_name:      $\beta F({\bf n},V,T)$</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'betaF'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>n_0</span>: 5</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-9b2fa6da-f8ab-4431-9ddc-0477adf2ce0c' class='xr-array-in' type='checkbox' checked><label for='section-9b2fa6da-f8ab-4431-9ddc-0477adf2ce0c' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.0 -6.238 -11.79 -16.94 -21.8</span></div><div class='xr-array-data'><pre>array([  0.        ,  -6.23817948, -11.78825896, -16.93743845,
       -21.80391793])</pre></div></div></li><li class='xr-section-item'><input id='section-29226c04-cb6a-4265-b2d5-5f14a31e17e1' class='xr-section-summary-in' type='checkbox'  checked><label for='section-29226c04-cb6a-4265-b2d5-5f14a31e17e1' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>beta</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.6667</div><input id='attrs-0e2dad9e-0b9a-4153-99fe-40aaeccbd1a7' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0e2dad9e-0b9a-4153-99fe-40aaeccbd1a7' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f21fb88a-2c14-4fe8-be37-a8d7b44aa357' class='xr-var-data-in' type='checkbox'><label for='data-f21fb88a-2c14-4fe8-be37-a8d7b44aa357' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(0.66666667)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>volume</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>512.0</div><input id='attrs-2b52134b-2695-4fe2-83b3-e84f013dae4f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2b52134b-2695-4fe2-83b3-e84f013dae4f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f5d1eb6f-c58d-4e26-ab5a-2784401f550b' class='xr-var-data-in' type='checkbox'><label for='data-f5d1eb6f-c58d-4e26-ab5a-2784401f550b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(512.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>n_0</span></div><div class='xr-var-dims'>(n_0)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4</div><input id='attrs-8b211b92-c0b6-4659-9293-e2f29fa7a322' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8b211b92-c0b6-4659-9293-e2f29fa7a322' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-84bbcd06-9ec6-40c1-b185-9a1aec44b7ef' class='xr-var-data-in' type='checkbox'><label for='data-84bbcd06-9ec6-40c1-b185-9a1aec44b7ef' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>$n_0$</dd></dl></div><div class='xr-var-data'><pre>array([0, 1, 2, 3, 4])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-6e322c0f-86e4-4d11-9b96-4f90f696660d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-6e322c0f-86e4-4d11-9b96-4f90f696660d' class='xr-section-summary' >Attributes: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>dims_n :</span></dt><dd>[&#x27;n_0&#x27;]</dd><dt><span>dims_lnz :</span></dt><dd>[&#x27;lnz_0&#x27;]</dd><dt><span>dims_comp :</span></dt><dd>[&#x27;component&#x27;]</dd><dt><span>dims_state :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]</dd><dt><span>dims_rec :</span></dt><dd>[]</dd><dt><span>standard_name :</span></dt><dd>helmholtz_free_energy</dd><dt><span>long_name :</span></dt><dd>$\beta F({\bf n},V,T)$</dd></dl></div></li></ul></div></div></div>
</div>
<p>Look at the documentation for all the properties available. To quickly construct a dataset of multiple properties, use the <code class="docutils literal notranslate"><span class="pre">table</span></code> method.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">xce</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span><span class="s1">&#39;betaF&#39;</span><span class="p">],</span> <span class="n">default_keys</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">ds</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:   (n_0: 436)
Coordinates:
    beta      float64 0.6667
    volume    float64 512.0
  * n_0       (n_0) int64 0 1 2 3 4 5 6 7 8 ... 428 429 430 431 432 433 434 435
Data variables:
    pressure  (n_0) float64 -0.0 0.001008 0.00319 0.005607 ... 5.786 5.854 5.893
    betaF     (n_0) float64 0.0 -6.238 -11.79 -16.94 ... -352.4 -348.7 -344.8
Attributes:
    long_name:  $p({\bf n},V,T)$</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-112797ae-a6dd-4932-887d-bad09da7509c' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-112797ae-a6dd-4932-887d-bad09da7509c' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>n_0</span>: 436</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-5b77c1c0-8cfa-4d9d-a927-15d9d3cba62f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-5b77c1c0-8cfa-4d9d-a927-15d9d3cba62f' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>beta</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.6667</div><input id='attrs-f8ff6e3b-44fc-4d09-9b04-3ba16a5a4ae5' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f8ff6e3b-44fc-4d09-9b04-3ba16a5a4ae5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-710640e2-d71b-44f9-921d-69ed5e0c7398' class='xr-var-data-in' type='checkbox'><label for='data-710640e2-d71b-44f9-921d-69ed5e0c7398' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(0.66666667)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>volume</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>512.0</div><input id='attrs-1984b117-9852-421e-977c-7631fd426e81' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1984b117-9852-421e-977c-7631fd426e81' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-640c33e1-756e-4781-ab4b-8d243ecbf059' class='xr-var-data-in' type='checkbox'><label for='data-640c33e1-756e-4781-ab4b-8d243ecbf059' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(512.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>n_0</span></div><div class='xr-var-dims'>(n_0)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 ... 431 432 433 434 435</div><input id='attrs-c2a33289-0d23-495e-a2a6-c0814dbbeba2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-c2a33289-0d23-495e-a2a6-c0814dbbeba2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-73de7c9c-a0c9-43a3-82b0-48aef8e20787' class='xr-var-data-in' type='checkbox'><label for='data-73de7c9c-a0c9-43a3-82b0-48aef8e20787' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>$n_0$</dd></dl></div><div class='xr-var-data'><pre>array([  0,   1,   2, ..., 433, 434, 435])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-20ea3607-cb8b-494e-a8a3-e55ea025cacc' class='xr-section-summary-in' type='checkbox'  checked><label for='section-20ea3607-cb8b-494e-a8a3-e55ea025cacc' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>pressure</span></div><div class='xr-var-dims'>(n_0)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-0.0 0.001008 ... 5.854 5.893</div><input id='attrs-61666f1b-6b62-42af-9b74-5b197d39ca8d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-61666f1b-6b62-42af-9b74-5b197d39ca8d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-85696c95-c5d2-4651-a7c3-f58617750cac' class='xr-var-data-in' type='checkbox'><label for='data-85696c95-c5d2-4651-a7c3-f58617750cac' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>$p({\bf n},V,T)$</dd></dl></div><div class='xr-var-data'><pre>array([-0.00000000e+00,  1.00795898e-03,  3.19042969e-03,  5.60727539e-03,
        8.13105469e-03,  1.07110840e-02,  1.33245117e-02,  1.59626221e-02,
        1.86035449e-02,  2.12531396e-02,  2.39138379e-02,  2.65724268e-02,
        2.92237793e-02,  3.18847852e-02,  3.45402539e-02,  3.71912988e-02,
        3.98437793e-02,  4.24513916e-02,  4.50499219e-02,  4.76741602e-02,
        5.02820508e-02,  5.28891064e-02,  5.55045117e-02,  5.80831055e-02,
        6.06579199e-02,  6.32146143e-02,  6.57673828e-02,  6.83276221e-02,
        7.08482520e-02,  7.33880127e-02,  7.59249902e-02,  7.84426318e-02,
        8.09484668e-02,  8.34514746e-02,  8.59810840e-02,  8.84699268e-02,
        9.09261328e-02,  9.33975293e-02,  9.58728223e-02,  9.83368213e-02,
        1.00797920e-01,  1.03231289e-01,  1.05678340e-01,  1.08122197e-01,
        1.10520381e-01,  1.12914243e-01,  1.15324980e-01,  1.17722622e-01,
        1.20133154e-01,  1.22532861e-01,  1.24934062e-01,  1.27297793e-01,
        1.29691787e-01,  1.32085884e-01,  1.34399619e-01,  1.36757651e-01,
        1.39123389e-01,  1.41462568e-01,  1.43806025e-01,  1.46144854e-01,
        1.48474775e-01,  1.50824722e-01,  1.53090674e-01,  1.55359731e-01,
        1.57746826e-01,  1.60114805e-01,  1.62430020e-01,  1.64709902e-01,
        1.67055029e-01,  1.69411143e-01,  1.71716338e-01,  1.73960508e-01,
        1.76163545e-01,  1.78509873e-01,  1.80828252e-01,  1.83095083e-01,
        1.85397539e-01,  1.87673262e-01,  1.89966621e-01,  1.92227944e-01,
...
        2.41144821e+00,  2.43941208e+00,  2.46474643e+00,  2.49182352e+00,
        2.52185649e+00,  2.55185917e+00,  2.58335501e+00,  2.61155211e+00,
        2.64050670e+00,  2.67121149e+00,  2.70174746e+00,  2.73371677e+00,
        2.76553628e+00,  2.79666366e+00,  2.82648006e+00,  2.85977036e+00,
        2.89344684e+00,  2.92455606e+00,  2.95870041e+00,  2.99367556e+00,
        3.02772368e+00,  3.06307060e+00,  3.09984945e+00,  3.13746029e+00,
        3.17279385e+00,  3.20745304e+00,  3.24353609e+00,  3.28000669e+00,
        3.31804157e+00,  3.35525206e+00,  3.39285756e+00,  3.43347425e+00,
        3.47512361e+00,  3.51374995e+00,  3.55369184e+00,  3.59754333e+00,
        3.63821462e+00,  3.67967000e+00,  3.72410434e+00,  3.76816885e+00,
        3.80753144e+00,  3.85033347e+00,  3.89739490e+00,  3.94103914e+00,
        3.98881466e+00,  4.03375941e+00,  4.07758450e+00,  4.12425794e+00,
        4.17009086e+00,  4.21737066e+00,  4.26946438e+00,  4.31971126e+00,
        4.36427285e+00,  4.41670709e+00,  4.46721311e+00,  4.51497176e+00,
        4.56795852e+00,  4.62053264e+00,  4.67139978e+00,  4.71933167e+00,
        4.77446846e+00,  4.83430838e+00,  4.88988394e+00,  4.94484867e+00,
        4.99826279e+00,  5.05576434e+00,  5.11593608e+00,  5.17409159e+00,
        5.23279714e+00,  5.29388224e+00,  5.35440210e+00,  5.41664957e+00,
        5.47422335e+00,  5.53065666e+00,  5.59730717e+00,  5.65966039e+00,
        5.72173746e+00,  5.78577560e+00,  5.85422369e+00,  5.89278464e+00])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>betaF</span></div><div class='xr-var-dims'>(n_0)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 -6.238 -11.79 ... -348.7 -344.8</div><input id='attrs-762853f3-cd4c-4f21-92e9-3cb61aeefe43' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-762853f3-cd4c-4f21-92e9-3cb61aeefe43' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f077b270-dc79-4353-8970-555b49b40c96' class='xr-var-data-in' type='checkbox'><label for='data-f077b270-dc79-4353-8970-555b49b40c96' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>dims_n :</span></dt><dd>[&#x27;n_0&#x27;]</dd><dt><span>dims_lnz :</span></dt><dd>[&#x27;lnz_0&#x27;]</dd><dt><span>dims_comp :</span></dt><dd>[&#x27;component&#x27;]</dd><dt><span>dims_state :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]</dd><dt><span>dims_rec :</span></dt><dd>[]</dd><dt><span>standard_name :</span></dt><dd>helmholtz_free_energy</dd><dt><span>long_name :</span></dt><dd>$\beta F({\bf n},V,T)$</dd></dl></div><div class='xr-var-data'><pre>array([   0.        ,   -6.23817948,  -11.78825896,  -16.93743845,
        -21.80391793,  -26.45169741,  -30.92217689,  -35.24305637,
        -39.43488586,  -43.51427534,  -47.49263482,  -51.3802843 ,
        -55.18540378,  -58.91534327,  -62.57494275,  -66.17037223,
        -69.70504171,  -73.18350119,  -76.61015068,  -79.98718016,
        -83.31692964,  -86.60257912,  -89.8454786 ,  -93.04802809,
        -96.21263757,  -99.34036705, -102.43368653, -105.49306601,
       -108.5203955 , -111.51717498, -114.48366446, -117.42170394,
       -120.33183342, -123.21554291, -126.07309239, -128.90524187,
       -131.71352135, -134.49843083, -137.26048032, -140.0003198 ,
       -142.71866928, -145.41596876, -148.09328824, -150.75033773,
       -153.38838721, -156.00779669, -158.60911617, -161.19235565,
       -163.75846514, -166.30706462, -168.8393841 , -171.35487358,
       -173.85522306, -176.33899255, -178.80819203, -181.26244151,
       -183.70210099, -186.12725047, -188.53863996, -190.93596944,
       -193.32005892, -195.6906584 , -198.04822788, -200.39366737,
       -202.72645685, -205.04623633, -207.35395581, -209.64960529,
       -211.93391478, -214.20585426, -216.46667374, -218.71597322,
       -220.9550527 , -223.18332219, -225.40031167, -227.60704115,
       -229.80326063, -231.98917011, -234.1650796 , -236.33078908,
...
       -517.57634594, -516.70443742, -515.8063279 , -514.88603639,
       -513.93637587, -512.95905135, -511.95257783, -510.91577731,
       -509.8561921 , -508.76502588, -507.64792636, -506.49973331,
       -505.32308209, -504.11578421, -502.88146288, -501.61907936,
       -500.32342584, -498.99915233, -497.64648581, -496.25981229,
       -494.84338477, -493.39481425, -491.91429574, -490.39921822,
       -488.8508627 , -487.27222118, -485.66168466, -484.01847615,
       -482.34284843, -480.63193791, -478.89023839, -477.11274027,
       -475.29930056, -473.44842984, -471.56710749, -469.6462433 ,
       -467.68825729, -465.6964695 , -463.66638676, -461.59751234,
       -459.49117603, -457.35434961, -455.17433569, -452.95667897,
       -450.70189785, -448.40261144, -446.07120492, -443.6974159 ,
       -441.28684118, -438.83551406, -436.34514405, -433.80612803,
       -431.23135871, -428.61769449, -425.95531147, -423.25743386,
       -420.51563787, -417.72985682, -414.90105215, -412.03128963,
       -409.12353928, -406.16320457, -403.15736475, -400.10615663,
       -397.01065581, -393.87252309, -390.68368018, -387.44808786,
       -384.16527904, -380.83505572, -377.4540159 , -374.02668999,
       -370.54602357, -367.02674195, -363.45618333, -359.83096831,
       -356.1615208 , -352.43810628, -348.66757176, -344.83638224])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-76fc55a3-ae43-4144-886c-6363fe12ffe7' class='xr-section-summary-in' type='checkbox'  checked><label for='section-76fc55a3-ae43-4144-886c-6363fe12ffe7' class='xr-section-summary' >Attributes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>$p({\bf n},V,T)$</dd></dl></div></li></ul></div></div></div>
</div>
<p>This can be easily converted to a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>beta</th>
      <th>volume</th>
      <th>pressure</th>
      <th>betaF</th>
    </tr>
    <tr>
      <th>n_0</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.666667</td>
      <td>512.0</td>
      <td>-0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.666667</td>
      <td>512.0</td>
      <td>0.001008</td>
      <td>-6.238179</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.666667</td>
      <td>512.0</td>
      <td>0.003190</td>
      <td>-11.788259</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.666667</td>
      <td>512.0</td>
      <td>0.005607</td>
      <td>-16.937438</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.666667</td>
      <td>512.0</td>
      <td>0.008131</td>
      <td>-21.803918</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>To access Grand Canonical properties, use the <code class="docutils literal notranslate"><span class="pre">xge</span></code> accessor</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ref</span><span class="o">.</span><span class="n">xge</span><span class="o">.</span><span class="n">pressure</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;pressure&#x27; ()&gt;
array(4.57687966)
Coordinates:
    lnz_0    float64 2.765
    beta     float64 0.6667
    volume   float64 512.0
Attributes:
    dims_n:      [&#x27;n_0&#x27;]
    dims_lnz:    [&#x27;lnz_0&#x27;]
    dims_comp:   [&#x27;component&#x27;]
    dims_state:  [&#x27;lnz_0&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]
    dims_rec:    []
    long_name:   $p(\mu,V,T)$</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'pressure'</div></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-b17320bc-55dc-4e44-83d5-4c9015470b61' class='xr-array-in' type='checkbox' checked><label for='section-b17320bc-55dc-4e44-83d5-4c9015470b61' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>4.577</span></div><div class='xr-array-data'><pre>array(4.57687966)</pre></div></div></li><li class='xr-section-item'><input id='section-1ff72385-90b4-4ff7-8fcb-7afb4cb5d73e' class='xr-section-summary-in' type='checkbox'  checked><label for='section-1ff72385-90b4-4ff7-8fcb-7afb4cb5d73e' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>lnz_0</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.765</div><input id='attrs-49c390ba-8fef-4a89-a70a-e2165e540f3f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-49c390ba-8fef-4a89-a70a-e2165e540f3f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-26b4a2d1-d6c5-4a7b-a8cd-c29fe72213e2' class='xr-var-data-in' type='checkbox'><label for='data-26b4a2d1-d6c5-4a7b-a8cd-c29fe72213e2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(2.76512052)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>beta</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.6667</div><input id='attrs-7e0072bb-f1f5-4f95-bdf6-01ba3eebffcf' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7e0072bb-f1f5-4f95-bdf6-01ba3eebffcf' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b0de9aa1-19f9-487f-8361-4faec763ff49' class='xr-var-data-in' type='checkbox'><label for='data-b0de9aa1-19f9-487f-8361-4faec763ff49' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(0.66666667)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>volume</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>512.0</div><input id='attrs-6244fdce-b83e-4066-bfda-999c3ed3b7e3' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-6244fdce-b83e-4066-bfda-999c3ed3b7e3' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-278bb6f4-8697-4d9c-98cc-28cb87b9d651' class='xr-var-data-in' type='checkbox'><label for='data-278bb6f4-8697-4d9c-98cc-28cb87b9d651' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(512.)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a9f55692-08a1-41be-bfc9-816d5c6ee3a0' class='xr-section-summary-in' type='checkbox'  checked><label for='section-a9f55692-08a1-41be-bfc9-816d5c6ee3a0' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>dims_n :</span></dt><dd>[&#x27;n_0&#x27;]</dd><dt><span>dims_lnz :</span></dt><dd>[&#x27;lnz_0&#x27;]</dd><dt><span>dims_comp :</span></dt><dd>[&#x27;component&#x27;]</dd><dt><span>dims_state :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]</dd><dt><span>dims_rec :</span></dt><dd>[]</dd><dt><span>long_name :</span></dt><dd>$p(\mu,V,T)$</dd></dl></div></li></ul></div></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ref</span><span class="o">.</span><span class="n">xge</span><span class="o">.</span><span class="n">betaF</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;betaF&#x27; ()&gt;
array(-423.16867869)
Coordinates:
    lnz_0    float64 2.765
    beta     float64 0.6667
    volume   float64 512.0
Attributes:
    dims_n:         [&#x27;n_0&#x27;]
    dims_lnz:       [&#x27;lnz_0&#x27;]
    dims_comp:      [&#x27;component&#x27;]
    dims_state:     [&#x27;lnz_0&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]
    dims_rec:       []
    standard_name:  helmholtz_free_energy
    long_name:      $\beta F(\mu,V,T)$</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'betaF'</div></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-f9ab7374-8aed-46c4-bac3-4363460e2118' class='xr-array-in' type='checkbox' checked><label for='section-f9ab7374-8aed-46c4-bac3-4363460e2118' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>-423.2</span></div><div class='xr-array-data'><pre>array(-423.16867869)</pre></div></div></li><li class='xr-section-item'><input id='section-6c233ca7-5d18-4e5c-a3e1-4073c0ed59f3' class='xr-section-summary-in' type='checkbox'  checked><label for='section-6c233ca7-5d18-4e5c-a3e1-4073c0ed59f3' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>lnz_0</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.765</div><input id='attrs-41373bfc-e756-4cc7-bdfe-df25dea23160' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-41373bfc-e756-4cc7-bdfe-df25dea23160' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-316d6a62-03e9-4d7a-b45a-aa2033785322' class='xr-var-data-in' type='checkbox'><label for='data-316d6a62-03e9-4d7a-b45a-aa2033785322' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(2.76512052)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>beta</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.6667</div><input id='attrs-17ff7fc4-6c89-464a-9a78-13d7e4038f76' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-17ff7fc4-6c89-464a-9a78-13d7e4038f76' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-141118c4-21b6-478b-9522-7691a49414f8' class='xr-var-data-in' type='checkbox'><label for='data-141118c4-21b6-478b-9522-7691a49414f8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(0.66666667)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>volume</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>512.0</div><input id='attrs-e644de33-2d89-4de4-9798-3cc19f1cd5cc' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e644de33-2d89-4de4-9798-3cc19f1cd5cc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-23ee8d98-dd3a-49d2-8b02-e5cf4624db68' class='xr-var-data-in' type='checkbox'><label for='data-23ee8d98-dd3a-49d2-8b02-e5cf4624db68' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(512.)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-8c4e1257-dd29-4865-8838-3f23b7a6e844' class='xr-section-summary-in' type='checkbox'  checked><label for='section-8c4e1257-dd29-4865-8838-3f23b7a6e844' class='xr-section-summary' >Attributes: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>dims_n :</span></dt><dd>[&#x27;n_0&#x27;]</dd><dt><span>dims_lnz :</span></dt><dd>[&#x27;lnz_0&#x27;]</dd><dt><span>dims_comp :</span></dt><dd>[&#x27;component&#x27;]</dd><dt><span>dims_state :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]</dd><dt><span>dims_rec :</span></dt><dd>[]</dd><dt><span>standard_name :</span></dt><dd>helmholtz_free_energy</dd><dt><span>long_name :</span></dt><dd>$\beta F(\mu,V,T)$</dd></dl></div></li></ul></div></div></div>
</div>
<p>Or, to calculate multiple properties, again, use the <code class="docutils literal notranslate"><span class="pre">table</span></code> method</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ref</span><span class="o">.</span><span class="n">xge</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">,</span><span class="s1">&#39;betaF&#39;</span><span class="p">],</span> <span class="n">default_keys</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:   ()
Coordinates:
    lnz_0     float64 2.765
    beta      float64 0.6667
    volume    float64 512.0
Data variables:
    pressure  float64 4.577
    betaF     float64 -423.2
Attributes:
    dims_n:      [&#x27;n_0&#x27;]
    dims_lnz:    [&#x27;lnz_0&#x27;]
    dims_comp:   [&#x27;component&#x27;]
    dims_state:  [&#x27;lnz_0&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]
    dims_rec:    []
    long_name:   $p(\mu,V,T)$</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-bfc5c5f0-0ab1-4647-9dac-7556d33c537e' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-bfc5c5f0-0ab1-4647-9dac-7556d33c537e' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-5e2b73b4-64af-446e-b3d8-35764c5fd0ef' class='xr-section-summary-in' type='checkbox'  checked><label for='section-5e2b73b4-64af-446e-b3d8-35764c5fd0ef' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>lnz_0</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.765</div><input id='attrs-97fd3080-b5ea-44c5-9b8a-956aeb57accf' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-97fd3080-b5ea-44c5-9b8a-956aeb57accf' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b39526b4-68c2-49cc-a5b3-8d9b10f67fbf' class='xr-var-data-in' type='checkbox'><label for='data-b39526b4-68c2-49cc-a5b3-8d9b10f67fbf' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(2.76512052)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>beta</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.6667</div><input id='attrs-1a84c919-c499-4d9b-b686-ba72bf3210ef' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1a84c919-c499-4d9b-b686-ba72bf3210ef' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0084f3f0-c43d-4e86-b0f3-d3fae9c67585' class='xr-var-data-in' type='checkbox'><label for='data-0084f3f0-c43d-4e86-b0f3-d3fae9c67585' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(0.66666667)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>volume</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>512.0</div><input id='attrs-7d833549-b4c6-4f47-8e81-c81563bc03b9' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7d833549-b4c6-4f47-8e81-c81563bc03b9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f58b70b4-70b4-49bf-8684-e4f3a4de4977' class='xr-var-data-in' type='checkbox'><label for='data-f58b70b4-70b4-49bf-8684-e4f3a4de4977' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(512.)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-5b233cbd-cfac-46c8-ba48-6d407d8d6932' class='xr-section-summary-in' type='checkbox'  checked><label for='section-5b233cbd-cfac-46c8-ba48-6d407d8d6932' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>pressure</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>4.577</div><input id='attrs-b72c295e-12be-4231-9c70-92179d5ea3d2' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-b72c295e-12be-4231-9c70-92179d5ea3d2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-31598652-a3d0-49da-9db8-6489a09b21cd' class='xr-var-data-in' type='checkbox'><label for='data-31598652-a3d0-49da-9db8-6489a09b21cd' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>dims_n :</span></dt><dd>[&#x27;n_0&#x27;]</dd><dt><span>dims_lnz :</span></dt><dd>[&#x27;lnz_0&#x27;]</dd><dt><span>dims_comp :</span></dt><dd>[&#x27;component&#x27;]</dd><dt><span>dims_state :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]</dd><dt><span>dims_rec :</span></dt><dd>[]</dd><dt><span>long_name :</span></dt><dd>$p(\mu,V,T)$</dd></dl></div><div class='xr-var-data'><pre>array(4.57687966)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>betaF</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-423.2</div><input id='attrs-174ad246-79d8-46cc-985a-a4bdf5230f9d' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-174ad246-79d8-46cc-985a-a4bdf5230f9d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-43b2c3f0-0389-44b0-a452-131cc9997d64' class='xr-var-data-in' type='checkbox'><label for='data-43b2c3f0-0389-44b0-a452-131cc9997d64' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>dims_n :</span></dt><dd>[&#x27;n_0&#x27;]</dd><dt><span>dims_lnz :</span></dt><dd>[&#x27;lnz_0&#x27;]</dd><dt><span>dims_comp :</span></dt><dd>[&#x27;component&#x27;]</dd><dt><span>dims_state :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]</dd><dt><span>dims_rec :</span></dt><dd>[]</dd><dt><span>standard_name :</span></dt><dd>helmholtz_free_energy</dd><dt><span>long_name :</span></dt><dd>$\beta F(\mu,V,T)$</dd></dl></div><div class='xr-var-data'><pre>array(-423.16867869)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-9df73cf2-150b-46ac-a8cf-34010dcc01b7' class='xr-section-summary-in' type='checkbox'  checked><label for='section-9df73cf2-150b-46ac-a8cf-34010dcc01b7' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>dims_n :</span></dt><dd>[&#x27;n_0&#x27;]</dd><dt><span>dims_lnz :</span></dt><dd>[&#x27;lnz_0&#x27;]</dd><dt><span>dims_comp :</span></dt><dd>[&#x27;component&#x27;]</dd><dt><span>dims_state :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]</dd><dt><span>dims_rec :</span></dt><dd>[]</dd><dt><span>long_name :</span></dt><dd>$p(\mu,V,T)$</dd></dl></div></li></ul></div></div></div>
</div>
<p>The great thing about using the xarray interface is that things like plotting become trivial. For example, use</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ref</span><span class="o">.</span><span class="n">xge</span><span class="o">.</span><span class="n">lnpi</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x7fa8b0fbbdf0&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Basic_usage_24_1.png" src="../_images/notebooks_Basic_usage_24_1.png" />
</div>
</div>
</section>
</section>
<section id="Collections-of-lnPi-Values">
<h1>Collections of lnPi Values<a class="headerlink" href="#Collections-of-lnPi-Values" title="Permalink to this heading"></a></h1>
<p>Ok, we can reweight a <span class="math notranslate nohighlight">\(\ln \Pi(N)\)</span> from one chemical potential to another, and calculate a variety of properties for a <span class="math notranslate nohighlight">\(\ln \Pi(N)\)</span>. But what if we want to calculate properties at a variety of values of <span class="math notranslate nohighlight">\(\ln z\)</span>. We could do list comprehension, but that’s slow, and can get unweildy. Instead, <code class="docutils literal notranslate"><span class="pre">lnPi</span></code> provides a helper class to deal with multiple <code class="docutils literal notranslate"><span class="pre">lnPi</span></code>s. To use it, we must first have a <code class="docutils literal notranslate"><span class="pre">PhaseCreator</span></code>. We will discuss this object in detail later, but for now, know that for
the simple case of a single component system that does not have any phase transitions, it suffices to use the following.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">phase_creator</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">PhaseCreator</span><span class="p">(</span><span class="n">nmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="n">ref</span><span class="p">)</span>

<span class="n">build_phases</span> <span class="o">=</span> <span class="n">phase_creator</span><span class="o">.</span><span class="n">build_phases_mu</span><span class="p">([</span><span class="kc">None</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>To create a collection of with of <code class="docutils literal notranslate"><span class="pre">lnPi</span></code> at differnt values of <code class="docutils literal notranslate"><span class="pre">lnz</span></code>, use the following:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">lnPiCollection</span><span class="o">.</span><span class="n">from_builder</span><span class="p">(</span><span class="n">lnzs</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2000</span><span class="p">),</span> <span class="n">build_phases</span><span class="o">=</span><span class="n">build_phases</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;class lnPiCollection&gt;
lnz_0       phase
-10.000000  0                     [-10.0]
-9.993497   0        [-9.993496748374188]
-9.986993   0        [-9.986993496748374]
-9.980490   0        [-9.980490245122562]
-9.973987   0        [-9.973986993496748]
                             ...
 2.973987   0         [2.973986993496748]
 2.980490   0         [2.980490245122562]
 2.986993   0         [2.986993496748374]
 2.993497   0         [2.993496748374188]
 3.000000   0                       [3.0]
Length: 2000, dtype: object
</pre></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">lnPiCollection</span></code> is a wrapper around <code class="docutils literal notranslate"><span class="pre">pandas.Series</span></code>. This provides an index for each <code class="docutils literal notranslate"><span class="pre">lnPiMasked</span></code> instance. This allows some niceties like indexing by value, groupby, etc.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select by postion</span>
<span class="c1"># scalar index gives object</span>
<span class="n">c</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;lnPi(lnz=[-9.99349675])&gt;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># array-like gives lnPiCollection instance</span>
<span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">1</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;class lnPiCollection&gt;
lnz_0      phase
-9.993497  0        [-9.993496748374188]
dtype: object
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># select by value.  Same as indexing into pandas.Series</span>
<span class="n">c</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="mf">3.0</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;class lnPiCollection&gt;
lnz_0  phase
3.0    0        [3.0]
dtype: object
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># can also query</span>
<span class="n">c</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;lnz_0 &gt; 2.95&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;class lnPiCollection&gt;
lnz_0     phase
2.954477  0         [2.95447723861931]
2.960980  0        [2.960980490245122]
2.967484  0        [2.967483741870936]
2.973987  0        [2.973986993496748]
2.980490  0        [2.980490245122562]
2.986993  0        [2.986993496748374]
2.993497  0        [2.993496748374188]
3.000000  0                      [3.0]
dtype: object
</pre></div></div>
</div>
<section id="Accessing-properties-of-colleciton">
<h2>Accessing properties of colleciton<a class="headerlink" href="#Accessing-properties-of-colleciton" title="Permalink to this heading"></a></h2>
<p>The really nice thing about <code class="docutils literal notranslate"><span class="pre">lnPiColletion</span></code> is that all the properties for <em>all</em> the <code class="docutils literal notranslate"><span class="pre">lnPiMasked</span></code> objects can be calculated at once, in a vectorized way. The same accessor <code class="docutils literal notranslate"><span class="pre">xge</span></code> is available to <code class="docutils literal notranslate"><span class="pre">lnPiCollection</span></code> as for <code class="docutils literal notranslate"><span class="pre">lnPiMasked</span></code>. Note that the <code class="docutils literal notranslate"><span class="pre">xce</span></code> accessor is not available, as it only makes sense for a single value of <code class="docutils literal notranslate"><span class="pre">lnPiMasked</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Note the smart indexing.  The index is inherited from lnPiCollection.index</span>
<span class="n">c</span><span class="o">.</span><span class="n">xge</span><span class="o">.</span><span class="n">pressure</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;pressure&#x27; (lnz_0: 2000, phase: 1)&gt;
array([[6.80940123e-05],
       [6.85383141e-05],
       [6.89855151e-05],
       ...,
       [4.84631185e+00],
       [4.85425839e+00],
       [4.86220769e+00]])
Coordinates:
  * lnz_0    (lnz_0) float64 -10.0 -9.993 -9.987 -9.98 ... 2.98 2.987 2.993 3.0
  * phase    (phase) int64 0
    beta     float64 0.6667
    volume   float64 512.0
Attributes:
    dims_n:      [&#x27;n_0&#x27;]
    dims_lnz:    [&#x27;lnz_0&#x27;]
    dims_comp:   [&#x27;component&#x27;]
    dims_state:  [&#x27;lnz_0&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]
    dims_rec:    [&#x27;sample&#x27;]
    long_name:   $p(\mu,V,T)$</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'pressure'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>lnz_0</span>: 2000</li><li><span class='xr-has-index'>phase</span>: 1</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-a119f77d-41ae-46e7-a39d-f71e610e5d0f' class='xr-array-in' type='checkbox' checked><label for='section-a119f77d-41ae-46e7-a39d-f71e610e5d0f' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>6.809e-05 6.854e-05 6.899e-05 6.944e-05 ... 4.838 4.846 4.854 4.862</span></div><div class='xr-array-data'><pre>array([[6.80940123e-05],
       [6.85383141e-05],
       [6.89855151e-05],
       ...,
       [4.84631185e+00],
       [4.85425839e+00],
       [4.86220769e+00]])</pre></div></div></li><li class='xr-section-item'><input id='section-e322ee4d-7720-4193-aba2-e116a75a5c3d' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e322ee4d-7720-4193-aba2-e116a75a5c3d' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lnz_0</span></div><div class='xr-var-dims'>(lnz_0)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-10.0 -9.993 -9.987 ... 2.993 3.0</div><input id='attrs-38ad8a11-51ec-4e3a-8cbb-373952a06e1f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-38ad8a11-51ec-4e3a-8cbb-373952a06e1f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9802d569-038d-46da-b300-3d58ada2de52' class='xr-var-data-in' type='checkbox'><label for='data-9802d569-038d-46da-b300-3d58ada2de52' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-10.      ,  -9.993497,  -9.986993, ...,   2.986993,   2.993497,
         3.      ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>phase</span></div><div class='xr-var-dims'>(phase)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-7ddc352b-a1ce-4f42-8c9d-e937bc499ff5' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7ddc352b-a1ce-4f42-8c9d-e937bc499ff5' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-025aad44-af7e-40c3-a190-234e2cee51d3' class='xr-var-data-in' type='checkbox'><label for='data-025aad44-af7e-40c3-a190-234e2cee51d3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>beta</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.6667</div><input id='attrs-8c9797b6-e11d-4059-98b9-659a21147811' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-8c9797b6-e11d-4059-98b9-659a21147811' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cb27b427-9917-4b4c-b741-b1aba8e87c03' class='xr-var-data-in' type='checkbox'><label for='data-cb27b427-9917-4b4c-b741-b1aba8e87c03' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(0.66666667)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>volume</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>512.0</div><input id='attrs-b1dba5dd-5a51-42c6-a581-b1a6671b3912' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b1dba5dd-5a51-42c6-a581-b1a6671b3912' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1071d16d-5d0c-4740-bc66-b181ac57c599' class='xr-var-data-in' type='checkbox'><label for='data-1071d16d-5d0c-4740-bc66-b181ac57c599' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(512.)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-207c570c-30c2-4435-af7f-ef6456d5dca0' class='xr-section-summary-in' type='checkbox'  checked><label for='section-207c570c-30c2-4435-af7f-ef6456d5dca0' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>dims_n :</span></dt><dd>[&#x27;n_0&#x27;]</dd><dt><span>dims_lnz :</span></dt><dd>[&#x27;lnz_0&#x27;]</dd><dt><span>dims_comp :</span></dt><dd>[&#x27;component&#x27;]</dd><dt><span>dims_state :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]</dd><dt><span>dims_rec :</span></dt><dd>[&#x27;sample&#x27;]</dd><dt><span>long_name :</span></dt><dd>$p(\mu,V,T)$</dd></dl></div></li></ul></div></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot the results</span>
<span class="n">c</span><span class="o">.</span><span class="n">xge</span><span class="o">.</span><span class="n">pressure</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x7fa8798fae20&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Basic_usage_37_1.png" src="../_images/notebooks_Basic_usage_37_1.png" />
</div>
</div>
<p>This is much more convenient (and much faster) than doing somethign like:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Don&#39;t do things like this</span>
<span class="c1"># It&#39;s super slow</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>

<span class="n">pressures</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">xge</span><span class="o">.</span><span class="n">pressure</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">c</span><span class="p">]</span>

<span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">pressures</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;lnz_0&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x7fa890b1e6d0&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Basic_usage_39_1.png" src="../_images/notebooks_Basic_usage_39_1.png" />
</div>
</div>
</section>
</section>
<section id="Loading-examples">
<h1>Loading examples<a class="headerlink" href="#Loading-examples" title="Permalink to this heading"></a></h1>
<p>lnPi comes with some pre-defined examples. We say above loading a dictionary of data that we then turned into a <code class="docutils literal notranslate"><span class="pre">lnPiMasked</span></code> object. This can be streamlined using the following:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">lnpy.examples</span>
<span class="n">ref</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="n">load_example_maskddata</span><span class="p">(</span><span class="s1">&#39;lj_sup&#39;</span><span class="p">)</span>
<span class="n">ref</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;lnPi(lnz=[2.76512052])&gt;
</pre></div></div>
</div>
<p>Alternatively, for some examples, you can load an object with contains a predefined <code class="docutils literal notranslate"><span class="pre">PhaseCreator</span></code> object. We’ll save this for later.</p>
</section>
<section id="Single-component-system-with-phase-transitions.">
<h1>Single component system with phase transitions.<a class="headerlink" href="#Single-component-system-with-phase-transitions." title="Permalink to this heading"></a></h1>
<p>Next, let’s consider a system with a phase transition. First, lets load some example data</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">lnpy</span>
<span class="kn">import</span> <span class="nn">lnpy.examples</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>

<span class="c1"># Subcritical LJ data</span>
<span class="n">ref</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="n">load_example_maskddata</span><span class="p">(</span><span class="s1">&#39;lj_sub&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># look at the lnPi values</span>
<span class="n">ref</span><span class="o">.</span><span class="n">xge</span><span class="o">.</span><span class="n">lnpi</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x7fa890974640&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Basic_usage_45_1.png" src="../_images/notebooks_Basic_usage_45_1.png" />
</div>
</div>
<div class="line-block">
<div class="line">Notice that this <span class="math notranslate nohighlight">\(\ln \Pi(N)\)</span> has multiple maxima. This indicates that multiple phases coexist.</div>
<div class="line">So calculating properties from the total <code class="docutils literal notranslate"><span class="pre">lnPiMasked</span></code> doesn’t make sense. Instead, the <code class="docutils literal notranslate"><span class="pre">lnPiMasked</span></code> should be divided into phases. The division should be at the local minima in <span class="math notranslate nohighlight">\(\ln \Pi(N)\)</span> (at approximately <code class="docutils literal notranslate"><span class="pre">n_0=100</span></code> in the example above). To perform the segmentation, we turn back to the <code class="docutils literal notranslate"><span class="pre">PhaseCreator</span></code> object. Let see how this works</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This creates a `PhaseCreator` object</span>
<span class="n">phase_creator</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">PhaseCreator</span><span class="p">(</span>
    <span class="n">nmax</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">nmax_peak</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">ref</span><span class="o">=</span><span class="n">ref</span><span class="p">,</span>
    <span class="n">merge_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;efac&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">}</span>
<span class="p">)</span>
<br/><br/></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># call the `build_phases` method creates a lnPiCollection of phases</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">phase_creator</span><span class="o">.</span><span class="n">build_phases</span><span class="p">()</span>
<span class="n">p</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;class lnPiCollection&gt;
lnz_0      phase
-3.609956  0        [-3.6099564097351307]
           1        [-3.6099564097351307]
dtype: object
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot the lnpi values for each &#39;phase&#39;</span>
<span class="n">p</span><span class="o">.</span><span class="n">xge</span><span class="o">.</span><span class="n">lnpi</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hue</span><span class="o">=</span><span class="s1">&#39;lnz_0&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x7fa890b52d00&gt;,
 &lt;matplotlib.lines.Line2D at 0x7fa890b52bb0&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Basic_usage_49_1.png" src="../_images/notebooks_Basic_usage_49_1.png" />
</div>
</div>
<p>What just happened? To segment <span class="math notranslate nohighlight">\(\ln \Pi(N)\)</span> the code does the following:, we For this we do the following</p>
<ol class="arabic simple">
<li><p>Find the local maxima of the <span class="math notranslate nohighlight">\(\ln \Pi(N)\)</span>. This is done wh using <code class="docutils literal notranslate"><span class="pre">lnpy.segment.peak_local_max_adptive</span></code>, which is an an adaptive version of <code class="docutils literal notranslate"><span class="pre">skimage.feature.peak_local_max</span></code>. This finds at most <code class="docutils literal notranslate"><span class="pre">nmax_peak</span></code>. Note that <code class="docutils literal notranslate"><span class="pre">nmax_peak</span></code> can be any number.</p></li>
<li><p>Use the <code class="docutils literal notranslate"><span class="pre">watershed</span></code> segmentation algorithm from the <code class="docutils literal notranslate"><span class="pre">skimage</span></code> package to segment <span class="math notranslate nohighlight">\(-\ln \Pi\)</span> into regions about the local minima in <span class="math notranslate nohighlight">\(-\ln \Pi\)</span> (local maxima in <span class="math notranslate nohighlight">\(\ln \Pi\)</span>).</p></li>
<li><p>Remove any phases that have to low a transition energy. We discuss this further below.</p></li>
<li><p>If the number of ‘phases’ is greater than the maximum allowed number of phases. Merge them. This is done by analyzing the transition energy between phases. Discussed further below.</p></li>
<li><p>Merge phases that have same <code class="docutils literal notranslate"><span class="pre">phase_id</span></code>. Discussed further below.</p></li>
<li><p>Pass list of <code class="docutils literal notranslate"><span class="pre">lnPiMasked</span></code> objects and created <code class="docutils literal notranslate"><span class="pre">index</span></code> to <code class="docutils literal notranslate"><span class="pre">phases_factory</span></code> function. Discussed further below.</p></li>
<li><p>return result</p></li>
</ol>
<p>OK, that’s a bunch of steps. Let take them one at a time.</p>
<section id="Breaking-it-down-segmentation">
<h2>Breaking it down segmentation<a class="headerlink" href="#Breaking-it-down-segmentation" title="Permalink to this heading"></a></h2>
<section id="local-maxima">
<h3>local maxima<a class="headerlink" href="#local-maxima" title="Permalink to this heading"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">maxima_marker</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">peak_local_max_adaptive</span><span class="p">(</span><span class="n">ref</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">num_peaks_max</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>  <span class="n">mask</span><span class="o">=~</span><span class="n">ref</span><span class="o">.</span><span class="n">mask</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s1">&#39;marker&#39;</span><span class="p">)</span>
<span class="n">maxima_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">maxima_marker</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ref</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">maxima_index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ref</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">maxima_index</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;o&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;None&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x7fa8a1c59eb0&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Basic_usage_54_1.png" src="../_images/notebooks_Basic_usage_54_1.png" />
</div>
</div>
</section>
<section id="Watershed">
<h3>Watershed<a class="headerlink" href="#Watershed" title="Permalink to this heading"></a></h3>
<p>OK, great. Now we can segment the data. <code class="docutils literal notranslate"><span class="pre">lnPi</span></code> provides a wrapper to <code class="docutils literal notranslate"><span class="pre">watershed</span></code> through <code class="docutils literal notranslate"><span class="pre">lnpy.segment.Segmenter</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">segment</span><span class="o">.</span><span class="n">Segmenter</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">labels</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">watershed</span><span class="p">(</span><span class="o">-</span><span class="n">ref</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">markers</span><span class="o">=</span><span class="n">maxima_marker</span><span class="p">,</span> <span class="n">mask</span><span class="o">=~</span><span class="n">ref</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span>
<span class="n">labels</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2], dtype=int32)
</pre></div></div>
</div>
<p>Each unique value in <code class="docutils literal notranslate"><span class="pre">labels</span></code> corresponds to a phase. We can construct multiple <code class="docutils literal notranslate"><span class="pre">lnPiMasked</span></code> objects from labels using</p>
</section>
<section id="local-free-energy">
<h3>local free energy<a class="headerlink" href="#local-free-energy" title="Permalink to this heading"></a></h3>
<p>Now, we look at the local free energy. The local (scaled) free energy is defined as <span class="math notranslate nohighlight">\(w(N) = \beta f(N) = -\ln \Pi(N)\)</span>. We consider the energy at the location of the local minima in <span class="math notranslate nohighlight">\(w\)</span> (local maxima in <span class="math notranslate nohighlight">\(\ln \Pi\)</span>) versus the value of <span class="math notranslate nohighlight">\(w\)</span> at the transition between phases (around <span class="math notranslate nohighlight">\(n=100\)</span> in the figure above). This is performed by the class <code class="docutils literal notranslate"><span class="pre">wFreeEnergy</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">w</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">wFreeEnergy</span><span class="o">.</span><span class="n">from_labels</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">ref</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># this is the same as -lnPi[maxima]</span>
<span class="n">w</span><span class="o">.</span><span class="n">w_min</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[126.12754742],
       [ -0.        ]])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">ref</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">maxima_index</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([126.12754742,  -0.        ])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># w.w_tran[i, j] is the &#39;transition&#39; energy going from phase i to phase j</span>
<span class="n">w</span><span class="o">.</span><span class="n">w_tran</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[36]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[         inf, 132.72931142],
       [132.72931142,          inf]])
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># the transition between phases &#39;0&#39; and &#39;1&#39; is at index 87</span>
<span class="n">w</span><span class="o">.</span><span class="n">w_argtran</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[37]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{(0, 1): (87,)}
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">ref</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">87</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[38]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
132.72931142169
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># the change in energy between the phases</span>
<span class="n">w</span><span class="o">.</span><span class="n">delta_w</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[39]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
array([[         inf,   6.601764  ],
       [132.72931142,          inf]])
</pre></div></div>
</div>
<p>This transition energy means the two phases are stable. So move on.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lnpis</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">list_from_masks</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">masks</span><span class="p">)</span>
<span class="n">lnpis</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[40]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;lnPi(lnz=[-3.60995641])&gt;, &lt;lnPi(lnz=[-3.60995641])&gt;]
</pre></div></div>
</div>
</section>
<section id="Construct-colleciton">
<h3>Construct colleciton<a class="headerlink" href="#Construct-colleciton" title="Permalink to this heading"></a></h3>
<p>Now these can be converted to a <code class="docutils literal notranslate"><span class="pre">MaskedlnPiCollection</span></code> object.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">lnPiCollection</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="n">lnpis</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">p</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[41]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;class lnPiCollection&gt;
lnz_0      phase
-3.609956  0        [-3.6099564097351307]
           1        [-3.6099564097351307]
dtype: object
</pre></div></div>
</div>
<p>So, the segmentation can get pretty involved. This is why there is the helper class <code class="docutils literal notranslate"><span class="pre">PhaseCreator</span></code>. There are a slew of options to the different routines. Look at the docs for more information</p>
</section>
</section>
<section id="At-a-different-\ln-z-value">
<h2>At a different <span class="math notranslate nohighlight">\(\ln z\)</span> value<a class="headerlink" href="#At-a-different-\ln-z-value" title="Permalink to this heading"></a></h2>
<p>Let us instead consider a diffent value of chemical potential. One near the critical point.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">phase_creator</span><span class="o">.</span><span class="n">build_phases</span><span class="p">(</span><span class="o">-</span><span class="mf">3.49</span><span class="p">)</span>
<span class="n">p</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[42]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;class lnPiCollection&gt;
lnz_0  phase
-3.49  0        [-3.49]
       1        [-3.49]
dtype: object
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">xge</span><span class="o">.</span><span class="n">lnpi</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hue</span><span class="o">=</span><span class="s1">&#39;phase&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[43]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x7fa890abd0d0&gt;,
 &lt;matplotlib.lines.Line2D at 0x7fa890abd1c0&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Basic_usage_75_1.png" src="../_images/notebooks_Basic_usage_75_1.png" />
</div>
</div>
<p>But lets look at the local free energy ‘w’ defined above. This can be obtained by the accessor <code class="docutils literal notranslate"><span class="pre">wfe</span></code> in <code class="docutils literal notranslate"><span class="pre">lnPiCollection</span></code>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># min(w) in each phase</span>
<span class="n">p</span><span class="o">.</span><span class="n">wfe</span><span class="o">.</span><span class="n">w_min</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[44]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
lnz_0  phase
-3.49  0        122.930891
       1        -45.776165
Name: w_min, dtype: float64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># transition w from phase to phase_nebr</span>
<span class="n">p</span><span class="o">.</span><span class="n">wfe</span><span class="o">.</span><span class="n">w_tran</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[45]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
lnz_0  phase  phase_nebr
-3.49  0      0                    inf
              1             123.785912
       1      0             123.785912
              1                    inf
Name: w_tran, dtype: float64
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># w_tran - w_min</span>
<span class="n">p</span><span class="o">.</span><span class="n">wfe</span><span class="o">.</span><span class="n">dw</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[46]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
lnz_0  phase  phase_nebr
-3.49  0      0                    inf
              1               0.855021
       1      0             169.562078
              1                    inf
Name: delta_w, dtype: float64
</pre></div></div>
</div>
<p>We see that the <span class="math notranslate nohighlight">\(\Delta w\)</span> is pretty low at this value of <span class="math notranslate nohighlight">\(\ln z\)</span>. We passed in the parameter <code class="docutils literal notranslate"><span class="pre">efac=0.8</span></code> in the definition of <code class="docutils literal notranslate"><span class="pre">phase_creator</span></code>. If we instead wish to remove phases with an energy this low, we can do the following:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">phase_creator</span><span class="o">.</span><span class="n">build_phases</span><span class="p">(</span><span class="o">-</span><span class="mf">3.49</span><span class="p">,</span> <span class="n">efac</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
<span class="n">p</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[47]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;class lnPiCollection&gt;
lnz_0  phase
-3.49  0        [-3.49]
dtype: object
</pre></div></div>
</div>
<p>Now if the <span class="math notranslate nohighlight">\(\Delta w\)</span> between phases is smaller than <code class="docutils literal notranslate"><span class="pre">efac</span></code>, the phases are merged. For more information, see thet api docs.</p>
</section>
<section id="Tagging-phases">
<h2>Tagging phases<a class="headerlink" href="#Tagging-phases" title="Permalink to this heading"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">PhaseCreator</span></code> allows passing a callback <code class="docutils literal notranslate"><span class="pre">tag_phases</span></code> to attach a label to each phase. By default, the phases are labeled by there list index. This can be confusing, because over a range of <span class="math notranslate nohighlight">\(\ln z\)</span> values, different physical phases can have the same label. For example</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[48]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">phase_creator</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">PhaseCreator</span><span class="p">(</span>
    <span class="n">nmax</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">nmax_peak</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">ref</span><span class="o">=</span><span class="n">ref</span><span class="p">,</span>
    <span class="n">merge_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;efac&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">}</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">lnPiCollection</span><span class="o">.</span><span class="n">from_builder</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="n">build_phases</span><span class="o">=</span><span class="n">phase_creator</span><span class="o">.</span><span class="n">build_phases</span><span class="p">)</span>

<span class="c1"># this looks weird because have multiple phases and not sure which is which</span>
<span class="n">c</span><span class="o">.</span><span class="n">xge</span><span class="o">.</span><span class="n">pressure</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hue</span><span class="o">=</span><span class="s1">&#39;phase&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[49]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x7fa890a56c10&gt;,
 &lt;matplotlib.lines.Line2D at 0x7fa890a56bb0&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Basic_usage_85_1.png" src="../_images/notebooks_Basic_usage_85_1.png" />
</div>
</div>
<p>Note that this can be fixed by considering ‘stable’ phases only</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">c</span><span class="o">.</span><span class="n">xge</span><span class="o">.</span><span class="n">table</span><span class="p">([</span><span class="s1">&#39;mask_stable&#39;</span><span class="p">,</span><span class="s1">&#39;pressure&#39;</span><span class="p">],</span> <span class="n">default_keys</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">pressure_stable</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;pressure&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s1">&#39;mask_stable&#39;</span><span class="p">]))</span>
    <span class="o">.</span><span class="n">pressure_stable</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="s1">&#39;phase&#39;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">plot</span><span class="p">()</span>


<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[50]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x7fa8a192f490&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Basic_usage_87_1.png" src="../_images/notebooks_Basic_usage_87_1.png" />
</div>
</div>
<p>There are two clear phases here. It would be beneficial to label the liquid and vapour phases differently. So we define the callback tag_pahses</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[51]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">tag_phases</span><span class="p">(</span><span class="n">list_of_phases</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Simple tag_phases callback</span>

<span class="sd">    This looks at the local maximum of each lnPiMasked object.</span>

<span class="sd">    If location of maximum &lt; len(data)/2 -&gt; phase = 0</span>
<span class="sd">    else -&gt; phase = 1</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_of_phases</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;bad tag function&#39;</span><span class="p">)</span>
    <span class="n">argmax0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">xx</span><span class="o">.</span><span class="n">local_argmax</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">xx</span> <span class="ow">in</span> <span class="n">list_of_phases</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">argmax0</span> <span class="o">&lt;=</span> <span class="n">list_of_phases</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[52]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">phase_creator</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">PhaseCreator</span><span class="p">(</span>
    <span class="n">nmax</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">nmax_peak</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">ref</span><span class="o">=</span><span class="n">ref</span><span class="p">,</span>
    <span class="n">merge_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;efac&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">},</span>
    <span class="n">tag_phases</span><span class="o">=</span><span class="n">tag_phases</span>

<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">lnPiCollection</span><span class="o">.</span><span class="n">from_builder</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="n">build_phases</span><span class="o">=</span><span class="n">phase_creator</span><span class="o">.</span><span class="n">build_phases</span><span class="p">)</span>

<span class="n">c</span><span class="o">.</span><span class="n">xge</span><span class="o">.</span><span class="n">pressure</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hue</span><span class="o">=</span><span class="s1">&#39;phase&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[53]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x7fa890acd640&gt;,
 &lt;matplotlib.lines.Line2D at 0x7fa890acd5e0&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Basic_usage_91_1.png" src="../_images/notebooks_Basic_usage_91_1.png" />
</div>
</div>
</section>
</section>
<section id="Calculation-Binodal-and-spinodal">
<h1>Calculation Binodal and spinodal<a class="headerlink" href="#Calculation-Binodal-and-spinodal" title="Permalink to this heading"></a></h1>
<p>The binodal and spinodal can be found using the <code class="docutils literal notranslate"><span class="pre">lnpy.stablity</span></code> module. This module adds accessors to <code class="docutils literal notranslate"><span class="pre">lnPiCollection</span></code> class. A collection is needed to provide a decent guess for the location of the binodal and spinodal.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[54]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">lnpy</span>
<span class="kn">import</span> <span class="nn">lnpy.examples</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>

<span class="c1"># Subcritical LJ data</span>
<span class="n">ref</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="n">load_example_maskddata</span><span class="p">(</span><span class="s1">&#39;lj_sub&#39;</span><span class="p">)</span>

<span class="n">phase_creator</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">PhaseCreator</span><span class="p">(</span>
    <span class="n">nmax</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>
    <span class="n">nmax_peak</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span>
    <span class="n">ref</span><span class="o">=</span><span class="n">ref</span><span class="p">,</span>
    <span class="n">merge_kws</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;efac&#39;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">},</span>
    <span class="n">tag_phases</span><span class="o">=</span><span class="n">tag_phases</span>

<span class="p">)</span>

<span class="c1"># Here we need a scalar builder object.</span>
<span class="n">build_phases</span> <span class="o">=</span> <span class="n">phase_creator</span><span class="o">.</span><span class="n">build_phases_mu</span><span class="p">([</span><span class="kc">None</span><span class="p">])</span>
<br/></pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[55]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># initial guess</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">lnPiCollection</span><span class="o">.</span><span class="n">from_builder</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">build_phases</span><span class="o">=</span><span class="n">phase_creator</span><span class="o">.</span><span class="n">build_phases_mu</span><span class="p">([</span><span class="kc">None</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<p>The spinodal is calculates as the location where <span class="math notranslate nohighlight">\(\Delta w\)</span> equals some value. Lets say we want to define the spindal as the location where <span class="math notranslate nohighlight">\(\Delta w = 1.0\)</span>. We do the following:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[56]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">spinodal</span><span class="p">(</span>
    <span class="n">phase_ids</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="c1"># the id&#39;s of the phases we&#39;re considering</span>
    <span class="n">build_phases</span><span class="o">=</span><span class="n">phase_creator</span><span class="o">.</span><span class="n">build_phases_mu</span><span class="p">([</span><span class="kc">None</span><span class="p">]),</span>
    <span class="c1"># this is the efac parameter for</span>
    <span class="n">build_kws</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">efac</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span>
    <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">as_dict</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">efac</span><span class="o">=</span><span class="mf">1.0</span>

<span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to access the data as a collection, use the `access` attribute</span>
<span class="n">c</span><span class="o">.</span><span class="n">spinodal</span><span class="o">.</span><span class="n">access</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[57]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;class lnPiCollection&gt;
spinodal  lnz_0      phase
0         -3.494734  0        [-3.494734034735128]
                     1        [-3.494734034735128]
1         -4.379828  0        [-4.379828176267564]
                     1        [-4.379828176267564]
dtype: object
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># energetics</span>
<span class="c1"># spinodal 0 is the limit of stability for phase 0 -&gt; phase 1</span>
<span class="c1"># spinodal 1 is the limit of stability for phase 1 -&gt; phase 0</span>
<span class="n">c</span><span class="o">.</span><span class="n">spinodal</span><span class="o">.</span><span class="n">access</span><span class="o">.</span><span class="n">wfe</span><span class="o">.</span><span class="n">dw</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[58]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
spinodal  lnz_0      phase  phase_nebr
0         -3.494734  0      0                    inf
                            1               1.000000
                     1      0             168.038523
                            1                    inf
1         -4.379828  0      0                    inf
                            1             142.179651
                     1      0               1.000000
                            1                    inf
Name: delta_w, dtype: float64
</pre></div></div>
</div>
<p>Now that we have the spinodal, we can calculation the binodal</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[59]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">binodal</span><span class="p">(</span>
    <span class="n">phase_ids</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">build_phases</span><span class="o">=</span><span class="n">phase_creator</span><span class="o">.</span><span class="n">build_phases_mu</span><span class="p">([</span><span class="kc">None</span><span class="p">]),</span>
    <span class="n">build_kws</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">efac</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span>
    <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[60]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># access as collection with the `access` attribute</span>
<span class="n">c</span><span class="o">.</span><span class="n">binodal</span><span class="o">.</span><span class="n">access</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[60]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;class lnPiCollection&gt;
binodal  lnz_0      phase
0        -3.966438  0        [-3.966438059499727]
                    1        [-3.966438059499727]
dtype: object
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[61]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># at the binodal, the two phases should have equal pressure</span>
<span class="n">c</span><span class="o">.</span><span class="n">binodal</span><span class="o">.</span><span class="n">access</span><span class="o">.</span><span class="n">xge</span><span class="o">.</span><span class="n">pressure</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[61]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;pressure&#x27; (binodal: 1, lnz_0: 1, phase: 2)&gt;
array([[[0.01594237, 0.01594237]]])
Coordinates:
  * binodal  (binodal) int64 0
  * lnz_0    (lnz_0) float64 -3.966
  * phase    (phase) int64 0 1
    beta     float64 1.372
    volume   float64 512.0
Attributes:
    dims_n:      [&#x27;n_0&#x27;]
    dims_lnz:    [&#x27;lnz_0&#x27;]
    dims_comp:   [&#x27;component&#x27;]
    dims_state:  [&#x27;lnz_0&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]
    dims_rec:    [&#x27;sample&#x27;]
    long_name:   $p(\mu,V,T)$</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'pressure'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>binodal</span>: 1</li><li><span class='xr-has-index'>lnz_0</span>: 1</li><li><span class='xr-has-index'>phase</span>: 2</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-c2552947-63b8-4b10-8b4f-20c88aff115a' class='xr-array-in' type='checkbox' checked><label for='section-c2552947-63b8-4b10-8b4f-20c88aff115a' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.01594 0.01594</span></div><div class='xr-array-data'><pre>array([[[0.01594237, 0.01594237]]])</pre></div></div></li><li class='xr-section-item'><input id='section-b6c7d219-141a-40f2-8b88-8e23afe95efa' class='xr-section-summary-in' type='checkbox'  checked><label for='section-b6c7d219-141a-40f2-8b88-8e23afe95efa' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>binodal</span></div><div class='xr-var-dims'>(binodal)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-2eb649b2-38c9-40fc-bb41-3792990a4b82' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2eb649b2-38c9-40fc-bb41-3792990a4b82' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e8e88910-cf64-4c47-9485-bde6ad72e102' class='xr-var-data-in' type='checkbox'><label for='data-e8e88910-cf64-4c47-9485-bde6ad72e102' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lnz_0</span></div><div class='xr-var-dims'>(lnz_0)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-3.966</div><input id='attrs-675a5b7e-1a96-4adb-a064-525481b36c9f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-675a5b7e-1a96-4adb-a064-525481b36c9f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f6b07f76-9656-474e-bb21-ccdfdc89753a' class='xr-var-data-in' type='checkbox'><label for='data-f6b07f76-9656-474e-bb21-ccdfdc89753a' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-3.966438])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>phase</span></div><div class='xr-var-dims'>(phase)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1</div><input id='attrs-cf55aae6-dd64-452b-8e89-4942069e2c20' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-cf55aae6-dd64-452b-8e89-4942069e2c20' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-97cc2226-db87-486b-980f-2ea3c8b2145c' class='xr-var-data-in' type='checkbox'><label for='data-97cc2226-db87-486b-980f-2ea3c8b2145c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 1])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>beta</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.372</div><input id='attrs-0f64c0a9-87a2-4f1b-942a-c045612cf819' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-0f64c0a9-87a2-4f1b-942a-c045612cf819' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a36d0e3b-643d-43e5-a64d-d30353665d0c' class='xr-var-data-in' type='checkbox'><label for='data-a36d0e3b-643d-43e5-a64d-d30353665d0c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(1.37228802)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>volume</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>512.0</div><input id='attrs-704aeb86-ede5-409d-be68-84678c39f144' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-704aeb86-ede5-409d-be68-84678c39f144' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-66449af0-34a1-499b-948d-36d008920d07' class='xr-var-data-in' type='checkbox'><label for='data-66449af0-34a1-499b-948d-36d008920d07' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(512.)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-a72afc1f-e890-4e52-9fc4-0d0b0e8ed477' class='xr-section-summary-in' type='checkbox'  checked><label for='section-a72afc1f-e890-4e52-9fc4-0d0b0e8ed477' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>dims_n :</span></dt><dd>[&#x27;n_0&#x27;]</dd><dt><span>dims_lnz :</span></dt><dd>[&#x27;lnz_0&#x27;]</dd><dt><span>dims_comp :</span></dt><dd>[&#x27;component&#x27;]</dd><dt><span>dims_state :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]</dd><dt><span>dims_rec :</span></dt><dd>[&#x27;sample&#x27;]</dd><dt><span>long_name :</span></dt><dd>$p(\mu,V,T)$</dd></dl></div></li></ul></div></div></div>
</div>
<p>To append spinodal/binodal to the dataset, use the following:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[62]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c_total</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">spinodal</span><span class="o">.</span><span class="n">appender</span><span class="p">)</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">binodal</span><span class="o">.</span><span class="n">appender</span><span class="p">)</span>
<span class="n">c_total</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[62]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;class lnPiCollection&gt;
lnz_0       phase
-10.000000  0                      [-10.0]
-9.111111   0          [-9.11111111111111]
-8.222222   0         [-8.222222222222221]
-7.333333   0         [-7.333333333333334]
-6.444444   0         [-6.444444444444445]
-5.555556   0         [-5.555555555555555]
-4.666667   0         [-4.666666666666667]
-3.777778   0        [-3.7777777777777786]
            1        [-3.7777777777777786]
-2.888889   1        [-2.8888888888888893]
-2.000000   1                       [-2.0]
-3.494734   0         [-3.494734034735128]
            1         [-3.494734034735128]
-4.379828   0         [-4.379828176267564]
            1         [-4.379828176267564]
-3.966438   0         [-3.966438059499727]
            1         [-3.966438059499727]
dtype: object
</pre></div></div>
</div>
<p>and if you’d like to sort the index:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[63]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c_total</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[63]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;class lnPiCollection&gt;
lnz_0       phase
-10.000000  0                      [-10.0]
-9.111111   0          [-9.11111111111111]
-8.222222   0         [-8.222222222222221]
-7.333333   0         [-7.333333333333334]
-6.444444   0         [-6.444444444444445]
-5.555556   0         [-5.555555555555555]
-4.666667   0         [-4.666666666666667]
-4.379828   0         [-4.379828176267564]
            1         [-4.379828176267564]
-3.966438   0         [-3.966438059499727]
            1         [-3.966438059499727]
-3.777778   0        [-3.7777777777777786]
            1        [-3.7777777777777786]
-3.494734   0         [-3.494734034735128]
            1         [-3.494734034735128]
-2.888889   1        [-2.8888888888888893]
-2.000000   1                       [-2.0]
dtype: object
</pre></div></div>
</div>
</section>
<section id="Multi-component-systems">
<h1>Multi component systems<a class="headerlink" href="#Multi-component-systems" title="Permalink to this heading"></a></h1>
<p>lnPi is designed to work with single and multicomponent systems. Let’s take a look at a system without phase transitions to start.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[64]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">lnpy.examples</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[65]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="n">load_example_dict</span><span class="p">(</span><span class="s1">&#39;ljmix_sup&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[66]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="mi">4</span><span class="p">))</span>
<span class="n">a</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;lnPi_data&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[66]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.image.AxesImage at 0x7fa879a05eb0&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Basic_usage_110_1.png" src="../_images/notebooks_Basic_usage_110_1.png" />
</div>
</div>
<p>We have finite data along the upper corner of the matrix ‘lnPi_data’. Therefore, the base <code class="docutils literal notranslate"><span class="pre">lnPiMasked</span></code> object, without splitting into phases, also will have a mask. This is why everything was build up from the <code class="docutils literal notranslate"><span class="pre">numpy.ma.MaskedArray</span></code> class.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[67]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[67]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{&#39;lnPi_data&#39;: array([[-759.26449941, -756.19423037, -753.77081946, ..., -424.28411489,
         -425.66274776, -426.93571412],
        [-755.52637941, -752.42375982, -749.96557613, ..., -418.59148639,
         -419.73805248,           nan],
        [-752.45715941, -749.31971691, -746.82151608, ..., -413.26963103,
         -414.54424182,           nan],
        ...,
        [-104.40479985, -102.4117824 ,           nan, ...,           nan,
                   nan,           nan],
        [-105.98668385,           nan,           nan, ...,           nan,
                   nan,           nan],
        [-107.62349885,           nan,           nan, ...,           nan,
                   nan,           nan]]),
 &#39;lnPi_mask&#39;: array([[False, False, False, ..., False, False, False],
        [False, False, False, ..., False, False,  True],
        [False, False, False, ..., False, False,  True],
        ...,
        [False, False,  True, ...,  True,  True,  True],
        [False,  True,  True, ...,  True,  True,  True],
        [False,  True,  True, ...,  True,  True,  True]]),
 &#39;state_kws&#39;: {&#39;temp&#39;: 0.8, &#39;beta&#39;: 1.25, &#39;volume&#39;: 512},
 &#39;extra_kws&#39;: {},
 &#39;lnz&#39;: array([-2.5, -2.5])}
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[68]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ref</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">lnPiMasked</span><span class="o">.</span><span class="n">from_data</span><span class="p">(</span>
    <span class="n">lnz</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;lnz&#39;</span><span class="p">],</span>
    <span class="n">lnz_data</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;lnz&#39;</span><span class="p">],</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;lnPi_data&#39;</span><span class="p">],</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;lnPi_mask&#39;</span><span class="p">],</span>
    <span class="n">state_kws</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;state_kws&#39;</span><span class="p">],</span>
    <span class="n">extra_kws</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;extra_kws&#39;</span><span class="p">],</span>


<span class="p">)</span>
</pre></div>
</div>
</div>
<p>Note that we could have also done:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[69]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ref</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">lnPiMasked</span><span class="o">.</span><span class="n">from_data</span><span class="p">(</span>
    <span class="n">lnz</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;lnz&#39;</span><span class="p">],</span>
    <span class="n">lnz_data</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;lnz&#39;</span><span class="p">],</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;lnPi_data&#39;</span><span class="p">],</span>
    <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;lnPi_data&#39;</span><span class="p">]),</span>
    <span class="n">state_kws</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;state_kws&#39;</span><span class="p">],</span>
    <span class="n">extra_kws</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;extra_kws&#39;</span><span class="p">],</span>

<span class="p">)</span>
</pre></div>
</div>
</div>
<section id="Considering-lines-of-constant-\ln-z-or-constant-\Delta-\ln-z.">
<h2>Considering lines of constant <span class="math notranslate nohighlight">\(\ln z\)</span> or constant <span class="math notranslate nohighlight">\(\Delta \ln z\)</span>.<a class="headerlink" href="#Considering-lines-of-constant-\ln-z-or-constant-\Delta-\ln-z." title="Permalink to this heading"></a></h2>
<p>Considering a multicomponent system will hopefully help explain why some design choices were made for <code class="docutils literal notranslate"><span class="pre">lnpy</span></code>.</p>
<p>It is common to want to consider a multicomponent system along lines of constant ‘something’. For example, we might want to consider a spectrum of values of <span class="math notranslate nohighlight">\(\ln z_0\)</span> while holding <span class="math notranslate nohighlight">\(\ln z_1\)</span> constant. This can be accoumplished using some built in <code class="docutils literal notranslate"><span class="pre">PhaseCreator</span></code> constructors.</p>
<p>First, note that if you know that a particular system will not have a phase transition, specify <code class="docutils literal notranslate"><span class="pre">nmax=1</span></code>. This will make the system skip the <code class="docutils literal notranslate"><span class="pre">lnPi</span></code> segmentation, which is the slowest process in analyzing <span class="math notranslate nohighlight">\(\ln \Pi(N)\)</span>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[70]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">phase_creator</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">PhaseCreator</span><span class="p">(</span><span class="n">nmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="n">ref</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>If you just call the <code class="docutils literal notranslate"><span class="pre">phase_creator.build_phases</span></code> constructor, we have to specify the total (vector) value of <span class="math notranslate nohighlight">\(\ln z\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[71]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">phase_creator</span><span class="o">.</span><span class="n">build_phases</span><span class="p">(</span><span class="n">lnz</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[71]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;class lnPiCollection&gt;
lnz_0  lnz_1  phase
0.0    0.0    0        [0.0, 0.0]
dtype: object
</pre></div></div>
</div>
<p>This is fine. But things like <code class="docutils literal notranslate"><span class="pre">lnPiCollections</span></code>, <code class="docutils literal notranslate"><span class="pre">Spinodal</span></code>, and <code class="docutils literal notranslate"><span class="pre">Binodal</span></code> are setup to work with scalar values of <span class="math notranslate nohighlight">\(\ln z\)</span>. So, we have the following constructors:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[72]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">build_phases</span> <span class="o">=</span> <span class="n">phase_creator</span><span class="o">.</span><span class="n">build_phases_mu</span><span class="p">([</span><span class="kc">None</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[73]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">build_phases</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[73]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;class lnPiCollection&gt;
lnz_0  lnz_1  phase
0.0    -1.0   0        [0.0, -1.0]
dtype: object
</pre></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">PhaseCreator.build_phase_mu</span></code> returns a constructor at fixed values of <span class="math notranslate nohighlight">\(\ln z\)</span> for all but one component. The component given a value of None (the first component in the example above) is the one we can vary. Then calling this constructor will make a new collection with the requested value of <span class="math notranslate nohighlight">\(\ln z\)</span> for the variable component and the fixed values of <span class="math notranslate nohighlight">\(\ln z\)</span> for other components as defined in the constructor.</p>
<p>We can use this to define a collection easily</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[74]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">lnPiCollection</span><span class="o">.</span><span class="n">from_builder</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">build_phases</span><span class="p">)</span>

<span class="n">c</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[74]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;class lnPiCollection&gt;
lnz_0  lnz_1  phase
-3.0   -1.0   0        [-3.0, -1.0]
-1.5   -1.0   0        [-1.5, -1.0]
 0.0   -1.0   0         [0.0, -1.0]
 1.5   -1.0   0         [1.5, -1.0]
 3.0   -1.0   0         [3.0, -1.0]
dtype: object
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[75]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># At a different fixed value.  This time at fixed lnz_0</span>
<span class="n">build_phases</span> <span class="o">=</span> <span class="n">phase_creator</span><span class="o">.</span><span class="n">build_phases_mu</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">lnPiCollection</span><span class="o">.</span><span class="n">from_builder</span><span class="p">(</span><span class="n">lnzs</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">build_phases</span><span class="o">=</span><span class="n">build_phases</span><span class="p">)</span>
<span class="n">c</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[75]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;class lnPiCollection&gt;
lnz_0  lnz_1  phase
0.5    -3.0   0        [0.5, -3.0]
       -1.5   0        [0.5, -1.5]
        0.0   0         [0.5, 0.0]
        1.5   0         [0.5, 1.5]
        3.0   0         [0.5, 3.0]
dtype: object
</pre></div></div>
</div>
<p>Similarly, we can create <code class="docutils literal notranslate"><span class="pre">lnPi</span></code>s at fixed value of <span class="math notranslate nohighlight">\(\Delta \ln z\)</span>, where <span class="math notranslate nohighlight">\(\Delta \ln z_k = \ln z_k - \ln z_f\)</span> where <span class="math notranslate nohighlight">\(f\)</span> is the index of the variable component.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[76]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># fixed value of dlnz_1 = lnz_1 - lnz_0 = 1.0</span>
<span class="n">build_phases</span> <span class="o">=</span> <span class="n">phase_creator</span><span class="o">.</span><span class="n">build_phases_dmu</span><span class="p">([</span><span class="kc">None</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">lnPiCollection</span><span class="o">.</span><span class="n">from_builder</span><span class="p">(</span><span class="n">lnzs</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">build_phases</span><span class="o">=</span><span class="n">build_phases</span><span class="p">)</span>
<span class="n">c</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[76]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;class lnPiCollection&gt;
lnz_0  lnz_1  phase
-3.0   -2.0   0        [-3.0, -2.0]
-1.5   -0.5   0        [-1.5, -0.5]
 0.0    1.0   0          [0.0, 1.0]
 1.5    2.5   0          [1.5, 2.5]
 3.0    4.0   0          [3.0, 4.0]
dtype: object
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[77]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lnz_0</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">get_index_level</span><span class="p">(</span><span class="s1">&#39;lnz_0&#39;</span><span class="p">)</span>
<span class="n">lnz_1</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">get_index_level</span><span class="p">(</span><span class="s1">&#39;lnz_1&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[78]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lnz_1</span> <span class="o">-</span> <span class="n">lnz_0</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[78]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Float64Index([1.0, 1.0, 1.0, 1.0, 1.0], dtype=&#39;float64&#39;)
</pre></div></div>
</div>
</section>
<section id="Multicomponent-system-with-phase-transitions">
<h2>Multicomponent system with phase transitions<a class="headerlink" href="#Multicomponent-system-with-phase-transitions" title="Permalink to this heading"></a></h2>
<p>Next, we consider a multicomponent system</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[79]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ref</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="n">load_example_maskddata</span><span class="p">(</span><span class="s1">&#39;hsmix&#39;</span><span class="p">)</span>
<span class="n">ref</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[79]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;lnPi(lnz=[0.5 0.5])&gt;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[80]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ref</span><span class="o">.</span><span class="n">xge</span><span class="o">.</span><span class="n">lnpi</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[80]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;matplotlib.collections.QuadMesh at 0x7fa820600400&gt;
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Basic_usage_133_1.png" src="../_images/notebooks_Basic_usage_133_1.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[81]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#function to tag &#39;LD&#39; and &#39;HD&#39; phases</span>
<span class="k">def</span> <span class="nf">tag_phases</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;bad tag function&#39;</span><span class="p">)</span>
    <span class="n">argmax0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">xx</span><span class="o">.</span><span class="n">local_argmax</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">xx</span> <span class="ow">in</span> <span class="n">x</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">argmax0</span> <span class="o">&lt;=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>


<span class="n">phase_creator</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">PhaseCreator</span><span class="p">(</span><span class="n">nmax</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nmax_peak</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="n">ref</span><span class="p">,</span> <span class="n">tag_phases</span><span class="o">=</span><span class="n">tag_phases</span><span class="p">,</span>
                                         <span class="n">merge_kws</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">efac</span><span class="o">=</span><span class="mf">0.8</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[83]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">build_phases</span> <span class="o">=</span> <span class="n">phase_creator</span><span class="o">.</span><span class="n">build_phases_mu</span><span class="p">([</span><span class="kc">None</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>

<span class="n">c</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">lnPiCollection</span><span class="o">.</span><span class="n">from_builder</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="n">build_phases</span><span class="p">,</span> <span class="n">unstack</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">c</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[83]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;class lnPiCollection&gt;
lnz_0      lnz_1  phase
-5.000000  0.0    0                      [-5.0, 0.0]
-4.795918  0.0    0        [-4.795918367346939, 0.0]
-4.591837  0.0    0        [-4.591836734693878, 0.0]
-4.387755  0.0    0        [-4.387755102040816, 0.0]
-4.183673  0.0    0        [-4.183673469387755, 0.0]
                                     ...
 4.183673  0.0    1         [4.183673469387756, 0.0]
 4.387755  0.0    1         [4.387755102040817, 0.0]
 4.591837  0.0    1         [4.591836734693878, 0.0]
 4.795918  0.0    1         [4.795918367346939, 0.0]
 5.000000  0.0    1                       [5.0, 0.0]
Length: 65, dtype: object
</pre></div></div>
</div>
<p>Note that here we have used the <code class="docutils literal notranslate"><span class="pre">unstack=False</span></code> option. This means that the results in <code class="docutils literal notranslate"><span class="pre">xge</span></code> will <em>not</em> be unstacked. For example:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[84]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">xge</span><span class="o">.</span><span class="n">betaOmega</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[84]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;betaOmega&#x27; (sample: 65)&gt;
array([-1246.12388491, -1246.12448998, -1246.12523222, -1246.12614278,
       -1246.12725991, -1246.1286306 , -1246.13031256, -1246.13237676,
       -1246.13491046, -1246.13802107, -1246.14184087, -1246.14653294,
       -1246.15229859, -1246.1593867 , -1246.16810551, -1246.1788377 ,
       -1246.19205972, -1010.9087438 , -1246.20836701, -1054.37219518,
       -1246.22850704, -1098.99423283, -1246.25342379, -1144.4775693 ,
       -1246.28431829, -1190.70729484, -1246.32273372, -1237.62335537,
       -1246.37067871, -1285.1875377 , -1246.43081409, -1333.37342804,
       -1246.50675309, -1382.15798324, -1246.60358765, -1431.51759825,
       -1246.72896095, -1481.42620374, -1246.89609727, -1531.84252007,
       -1247.1319439 , -1582.68976406, -1247.47204378, -1633.86017062,
       -1247.86446355, -1685.24884688, -1736.77785101, -1788.39701972,
       -1840.07559237, -1891.79461328, -1943.54206924, -1995.3100774 ,
       -2047.093286  , -2098.88794914, -2150.69137525, -2202.50158717,
       -2254.3171055 , -2306.13680626, -2357.95982463, -2409.78548824,
       -2461.61326981, -2513.44275296, -2565.27360693, -2617.10556771,
       -2668.9384238 ])
Coordinates:
  * sample   (sample) object MultiIndex
  * lnz_0    (sample) float64 -5.0 -4.796 -4.592 -4.388 ... 4.592 4.796 5.0
  * lnz_1    (sample) float64 0.0 0.0 0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0 0.0
  * phase    (sample) int64 0 0 0 0 0 0 0 0 0 0 0 0 ... 1 1 1 1 1 1 1 1 1 1 1 1
    beta     float64 1.0
    volume   float64 1.0
Attributes:
    dims_n:         [&#x27;n_0&#x27;, &#x27;n_1&#x27;]
    dims_lnz:       [&#x27;lnz_0&#x27;, &#x27;lnz_1&#x27;]
    dims_comp:      [&#x27;component&#x27;]
    dims_state:     [&#x27;lnz_0&#x27;, &#x27;lnz_1&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]
    dims_rec:       [&#x27;sample&#x27;]
    standard_name:  grand_potential
    long_name:      $\beta \Omega(\mu,V,T)$</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'betaOmega'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>sample</span>: 65</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-c27da27c-5544-4c89-a5cb-8e72b8579e7a' class='xr-array-in' type='checkbox' checked><label for='section-c27da27c-5544-4c89-a5cb-8e72b8579e7a' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>-1.246e+03 -1.246e+03 -1.246e+03 ... -2.565e+03 -2.617e+03 -2.669e+03</span></div><div class='xr-array-data'><pre>array([-1246.12388491, -1246.12448998, -1246.12523222, -1246.12614278,
       -1246.12725991, -1246.1286306 , -1246.13031256, -1246.13237676,
       -1246.13491046, -1246.13802107, -1246.14184087, -1246.14653294,
       -1246.15229859, -1246.1593867 , -1246.16810551, -1246.1788377 ,
       -1246.19205972, -1010.9087438 , -1246.20836701, -1054.37219518,
       -1246.22850704, -1098.99423283, -1246.25342379, -1144.4775693 ,
       -1246.28431829, -1190.70729484, -1246.32273372, -1237.62335537,
       -1246.37067871, -1285.1875377 , -1246.43081409, -1333.37342804,
       -1246.50675309, -1382.15798324, -1246.60358765, -1431.51759825,
       -1246.72896095, -1481.42620374, -1246.89609727, -1531.84252007,
       -1247.1319439 , -1582.68976406, -1247.47204378, -1633.86017062,
       -1247.86446355, -1685.24884688, -1736.77785101, -1788.39701972,
       -1840.07559237, -1891.79461328, -1943.54206924, -1995.3100774 ,
       -2047.093286  , -2098.88794914, -2150.69137525, -2202.50158717,
       -2254.3171055 , -2306.13680626, -2357.95982463, -2409.78548824,
       -2461.61326981, -2513.44275296, -2565.27360693, -2617.10556771,
       -2668.9384238 ])</pre></div></div></li><li class='xr-section-item'><input id='section-760a7df3-7303-4cb4-81a5-70761ed860f1' class='xr-section-summary-in' type='checkbox'  checked><label for='section-760a7df3-7303-4cb4-81a5-70761ed860f1' class='xr-section-summary' >Coordinates: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>sample</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>MultiIndex</div><input id='attrs-1cf62c57-762d-49fe-b743-35e704a94817' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1cf62c57-762d-49fe-b743-35e704a94817' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e07a500c-21a6-4506-a406-2db0869e3e3c' class='xr-var-data-in' type='checkbox'><label for='data-e07a500c-21a6-4506-a406-2db0869e3e3c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([(-5.0, 0.0, 0), (-4.795918367346939, 0.0, 0),
       (-4.591836734693878, 0.0, 0), (-4.387755102040816, 0.0, 0),
       (-4.183673469387755, 0.0, 0), (-3.979591836734694, 0.0, 0),
       (-3.7755102040816326, 0.0, 0), (-3.571428571428571, 0.0, 0),
       (-3.36734693877551, 0.0, 0), (-3.163265306122449, 0.0, 0),
       (-2.9591836734693877, 0.0, 0), (-2.7551020408163263, 0.0, 0),
       (-2.5510204081632653, 0.0, 0), (-2.3469387755102042, 0.0, 0),
       (-2.142857142857143, 0.0, 0), (-1.9387755102040813, 0.0, 0),
       (-1.7346938775510203, 0.0, 0), (-1.7346938775510203, 0.0, 1),
       (-1.5306122448979593, 0.0, 0), (-1.5306122448979593, 0.0, 1),
       (-1.3265306122448979, 0.0, 0), (-1.3265306122448979, 0.0, 1),
       (-1.1224489795918364, 0.0, 0), (-1.1224489795918364, 0.0, 1),
       (-0.9183673469387754, 0.0, 0), (-0.9183673469387754, 0.0, 1),
       (-0.7142857142857144, 0.0, 0), (-0.7142857142857144, 0.0, 1),
       (-0.5102040816326525, 0.0, 0), (-0.5102040816326525, 0.0, 1),
       (-0.3061224489795915, 0.0, 0), (-0.3061224489795915, 0.0, 1),
       (-0.1020408163265305, 0.0, 0), (-0.1020408163265305, 0.0, 1),
       (0.1020408163265305, 0.0, 0), (0.1020408163265305, 0.0, 1),
       (0.3061224489795915, 0.0, 0), (0.3061224489795915, 0.0, 1),
       (0.5102040816326534, 0.0, 0), (0.5102040816326534, 0.0, 1),
       (0.7142857142857144, 0.0, 0), (0.7142857142857144, 0.0, 1),
       (0.9183673469387754, 0.0, 0), (0.9183673469387754, 0.0, 1),
       (1.1224489795918373, 0.0, 0), (1.1224489795918373, 0.0, 1),
       (1.3265306122448983, 0.0, 1), (1.5306122448979593, 0.0, 1),
       (1.7346938775510203, 0.0, 1), (1.9387755102040813, 0.0, 1),
       (2.1428571428571432, 0.0, 1), (2.3469387755102042, 0.0, 1),
       (2.5510204081632653, 0.0, 1), (2.755102040816327, 0.0, 1),
       (2.959183673469388, 0.0, 1), (3.163265306122449, 0.0, 1),
       (3.36734693877551, 0.0, 1), (3.571428571428571, 0.0, 1),
       (3.775510204081632, 0.0, 1), (3.979591836734695, 0.0, 1),
       (4.183673469387756, 0.0, 1), (4.387755102040817, 0.0, 1),
       (4.591836734693878, 0.0, 1), (4.795918367346939, 0.0, 1), (5.0, 0.0, 1)],
      dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lnz_0</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-5.0 -4.796 -4.592 ... 4.796 5.0</div><input id='attrs-9dbdb00f-5b01-4490-a33c-f1099e83974c' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9dbdb00f-5b01-4490-a33c-f1099e83974c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-03e610d2-1e5b-4488-9688-8cb7d836e504' class='xr-var-data-in' type='checkbox'><label for='data-03e610d2-1e5b-4488-9688-8cb7d836e504' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-5.      , -4.795918, -4.591837, -4.387755, -4.183673, -3.979592,
       -3.77551 , -3.571429, -3.367347, -3.163265, -2.959184, -2.755102,
       -2.55102 , -2.346939, -2.142857, -1.938776, -1.734694, -1.734694,
       -1.530612, -1.530612, -1.326531, -1.326531, -1.122449, -1.122449,
       -0.918367, -0.918367, -0.714286, -0.714286, -0.510204, -0.510204,
       -0.306122, -0.306122, -0.102041, -0.102041,  0.102041,  0.102041,
        0.306122,  0.306122,  0.510204,  0.510204,  0.714286,  0.714286,
        0.918367,  0.918367,  1.122449,  1.122449,  1.326531,  1.530612,
        1.734694,  1.938776,  2.142857,  2.346939,  2.55102 ,  2.755102,
        2.959184,  3.163265,  3.367347,  3.571429,  3.77551 ,  3.979592,
        4.183673,  4.387755,  4.591837,  4.795918,  5.      ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lnz_1</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0</div><input id='attrs-29f7244b-2ba1-4cff-8c4b-1e57214eacc2' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-29f7244b-2ba1-4cff-8c4b-1e57214eacc2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ff5ed352-4837-44b4-afe9-56ad26d11adb' class='xr-var-data-in' type='checkbox'><label for='data-ff5ed352-4837-44b4-afe9-56ad26d11adb' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>phase</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 0 0 0 0 0 0 0 ... 1 1 1 1 1 1 1 1</div><input id='attrs-05860a3f-50a8-4338-9a8e-7e7a98311a61' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-05860a3f-50a8-4338-9a8e-7e7a98311a61' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a17110d3-5696-4036-937f-4ce7fa2ef1c9' class='xr-var-data-in' type='checkbox'><label for='data-a17110d3-5696-4036-937f-4ce7fa2ef1c9' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1,
       0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>beta</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.0</div><input id='attrs-a15c7126-d88d-45d6-a80c-3c4fc5a29561' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a15c7126-d88d-45d6-a80c-3c4fc5a29561' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-64df1db9-239a-48f2-9b6a-dd0a74ed57da' class='xr-var-data-in' type='checkbox'><label for='data-64df1db9-239a-48f2-9b6a-dd0a74ed57da' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(1.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>volume</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.0</div><input id='attrs-5607c55f-2e83-4b38-b06e-c97c22437459' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-5607c55f-2e83-4b38-b06e-c97c22437459' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-cb1bbd4b-cc5c-4af8-9a54-878264c3473c' class='xr-var-data-in' type='checkbox'><label for='data-cb1bbd4b-cc5c-4af8-9a54-878264c3473c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(1.)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-45d9e3c2-9c90-47c0-ba3c-dd2b3504eb39' class='xr-section-summary-in' type='checkbox'  checked><label for='section-45d9e3c2-9c90-47c0-ba3c-dd2b3504eb39' class='xr-section-summary' >Attributes: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>dims_n :</span></dt><dd>[&#x27;n_0&#x27;, &#x27;n_1&#x27;]</dd><dt><span>dims_lnz :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;lnz_1&#x27;]</dd><dt><span>dims_comp :</span></dt><dd>[&#x27;component&#x27;]</dd><dt><span>dims_state :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;lnz_1&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]</dd><dt><span>dims_rec :</span></dt><dd>[&#x27;sample&#x27;]</dd><dt><span>standard_name :</span></dt><dd>grand_potential</dd><dt><span>long_name :</span></dt><dd>$\beta \Omega(\mu,V,T)$</dd></dl></div></li></ul></div></div></div>
</div>
<p>To ‘unstack’ from ‘sample’ dimension to ‘lnz_0’, ‘lnz_1’, etc, you can call <code class="docutils literal notranslate"><span class="pre">unstack</span></code> directly:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[85]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">xge</span><span class="o">.</span><span class="n">betaOmega</span><span class="p">()</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[85]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;betaOmega&#x27; (lnz_0: 50, lnz_1: 1, phase: 2)&gt;
array([[[-1246.12388491,            nan]],

       [[-1246.12448998,            nan]],

       [[-1246.12523222,            nan]],

       [[-1246.12614278,            nan]],

       [[-1246.12725991,            nan]],

       [[-1246.1286306 ,            nan]],

       [[-1246.13031256,            nan]],

       [[-1246.13237676,            nan]],

       [[-1246.13491046,            nan]],

       [[-1246.13802107,            nan]],

...

       [[           nan, -2202.50158717]],

       [[           nan, -2254.3171055 ]],

       [[           nan, -2306.13680626]],

       [[           nan, -2357.95982463]],

       [[           nan, -2409.78548824]],

       [[           nan, -2461.61326981]],

       [[           nan, -2513.44275296]],

       [[           nan, -2565.27360693]],

       [[           nan, -2617.10556771]],

       [[           nan, -2668.9384238 ]]])
Coordinates:
  * lnz_0    (lnz_0) float64 -5.0 -4.796 -4.592 -4.388 ... 4.388 4.592 4.796 5.0
  * lnz_1    (lnz_1) float64 0.0
  * phase    (phase) int64 0 1
    beta     float64 1.0
    volume   float64 1.0
Attributes:
    dims_n:         [&#x27;n_0&#x27;, &#x27;n_1&#x27;]
    dims_lnz:       [&#x27;lnz_0&#x27;, &#x27;lnz_1&#x27;]
    dims_comp:      [&#x27;component&#x27;]
    dims_state:     [&#x27;lnz_0&#x27;, &#x27;lnz_1&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]
    dims_rec:       [&#x27;sample&#x27;]
    standard_name:  grand_potential
    long_name:      $\beta \Omega(\mu,V,T)$</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'betaOmega'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>lnz_0</span>: 50</li><li><span class='xr-has-index'>lnz_1</span>: 1</li><li><span class='xr-has-index'>phase</span>: 2</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-2f476f1b-4ec9-4d20-9831-6d726e0c7652' class='xr-array-in' type='checkbox' checked><label for='section-2f476f1b-4ec9-4d20-9831-6d726e0c7652' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>-1.246e+03 nan -1.246e+03 nan ... nan -2.617e+03 nan -2.669e+03</span></div><div class='xr-array-data'><pre>array([[[-1246.12388491,            nan]],

       [[-1246.12448998,            nan]],

       [[-1246.12523222,            nan]],

       [[-1246.12614278,            nan]],

       [[-1246.12725991,            nan]],

       [[-1246.1286306 ,            nan]],

       [[-1246.13031256,            nan]],

       [[-1246.13237676,            nan]],

       [[-1246.13491046,            nan]],

       [[-1246.13802107,            nan]],

...

       [[           nan, -2202.50158717]],

       [[           nan, -2254.3171055 ]],

       [[           nan, -2306.13680626]],

       [[           nan, -2357.95982463]],

       [[           nan, -2409.78548824]],

       [[           nan, -2461.61326981]],

       [[           nan, -2513.44275296]],

       [[           nan, -2565.27360693]],

       [[           nan, -2617.10556771]],

       [[           nan, -2668.9384238 ]]])</pre></div></div></li><li class='xr-section-item'><input id='section-e3c472cb-28f5-488c-9453-11a2edd9cbd0' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e3c472cb-28f5-488c-9453-11a2edd9cbd0' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lnz_0</span></div><div class='xr-var-dims'>(lnz_0)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-5.0 -4.796 -4.592 ... 4.796 5.0</div><input id='attrs-fdf44a93-5cfa-4a28-a196-0d743402ca84' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-fdf44a93-5cfa-4a28-a196-0d743402ca84' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5e654af7-171f-4cdd-8b40-7d941c254b06' class='xr-var-data-in' type='checkbox'><label for='data-5e654af7-171f-4cdd-8b40-7d941c254b06' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-5.      , -4.795918, -4.591837, -4.387755, -4.183673, -3.979592,
       -3.77551 , -3.571429, -3.367347, -3.163265, -2.959184, -2.755102,
       -2.55102 , -2.346939, -2.142857, -1.938776, -1.734694, -1.530612,
       -1.326531, -1.122449, -0.918367, -0.714286, -0.510204, -0.306122,
       -0.102041,  0.102041,  0.306122,  0.510204,  0.714286,  0.918367,
        1.122449,  1.326531,  1.530612,  1.734694,  1.938776,  2.142857,
        2.346939,  2.55102 ,  2.755102,  2.959184,  3.163265,  3.367347,
        3.571429,  3.77551 ,  3.979592,  4.183673,  4.387755,  4.591837,
        4.795918,  5.      ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lnz_1</span></div><div class='xr-var-dims'>(lnz_1)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0</div><input id='attrs-e82e37a7-5df6-48bb-8b82-03073b3d1840' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e82e37a7-5df6-48bb-8b82-03073b3d1840' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5c32dd88-88f9-4b61-930d-727a5d28b2d3' class='xr-var-data-in' type='checkbox'><label for='data-5c32dd88-88f9-4b61-930d-727a5d28b2d3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>phase</span></div><div class='xr-var-dims'>(phase)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1</div><input id='attrs-301cb954-9a25-4a00-a3d5-43981e2ca7e1' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-301cb954-9a25-4a00-a3d5-43981e2ca7e1' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c45ba5da-2a41-41a9-ac9a-8d56199b2cda' class='xr-var-data-in' type='checkbox'><label for='data-c45ba5da-2a41-41a9-ac9a-8d56199b2cda' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 1])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>beta</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.0</div><input id='attrs-70216310-3b1a-4bb7-9cf6-f383cc2402e9' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-70216310-3b1a-4bb7-9cf6-f383cc2402e9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-fd71f4a4-234c-4f85-98db-a514e976b799' class='xr-var-data-in' type='checkbox'><label for='data-fd71f4a4-234c-4f85-98db-a514e976b799' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(1.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>volume</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.0</div><input id='attrs-7b3e1daf-b295-43fe-9311-408abe6d0383' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7b3e1daf-b295-43fe-9311-408abe6d0383' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9b7d4793-e88d-4b8b-830c-34a43b5a5b59' class='xr-var-data-in' type='checkbox'><label for='data-9b7d4793-e88d-4b8b-830c-34a43b5a5b59' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(1.)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-44d6a7cb-a5fe-435a-932c-5c261e516a97' class='xr-section-summary-in' type='checkbox'  checked><label for='section-44d6a7cb-a5fe-435a-932c-5c261e516a97' class='xr-section-summary' >Attributes: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>dims_n :</span></dt><dd>[&#x27;n_0&#x27;, &#x27;n_1&#x27;]</dd><dt><span>dims_lnz :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;lnz_1&#x27;]</dd><dt><span>dims_comp :</span></dt><dd>[&#x27;component&#x27;]</dd><dt><span>dims_state :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;lnz_1&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]</dd><dt><span>dims_rec :</span></dt><dd>[&#x27;sample&#x27;]</dd><dt><span>standard_name :</span></dt><dd>grand_potential</dd><dt><span>long_name :</span></dt><dd>$\beta \Omega(\mu,V,T)$</dd></dl></div></li></ul></div></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[86]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">xge</span><span class="o">.</span><span class="n">betaOmega</span><span class="p">()</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hue</span><span class="o">=</span><span class="s1">&#39;phase&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[86]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[&lt;matplotlib.lines.Line2D at 0x7fa8799fd970&gt;,
 &lt;matplotlib.lines.Line2D at 0x7fa8a1a5f3a0&gt;]
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Basic_usage_140_1.png" src="../_images/notebooks_Basic_usage_140_1.png" />
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[87]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># spinodal along line of constant lnz_2</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">spinodal</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="n">phase_ids</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">build_phases</span><span class="o">=</span><span class="n">build_phases</span><span class="p">,</span> <span class="n">efac</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">binodal</span><span class="o">.</span><span class="fm">__call__</span><span class="p">(</span><span class="n">phase_ids</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">build_phases</span><span class="o">=</span><span class="n">build_phases</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[88]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create table for spinodal/binodal</span>

<span class="n">t_spin</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">spinodal</span><span class="o">.</span><span class="n">access</span><span class="o">.</span><span class="n">xge</span><span class="o">.</span><span class="n">table</span><span class="p">([</span><span class="s1">&#39;molfrac&#39;</span><span class="p">],</span> <span class="n">ref</span><span class="o">=</span><span class="n">ref</span><span class="p">)</span>
<span class="n">t_bino</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">binodal</span><span class="o">.</span><span class="n">access</span><span class="o">.</span><span class="n">xge</span><span class="o">.</span><span class="n">table</span><span class="p">([</span><span class="s1">&#39;molfrac&#39;</span><span class="p">],</span> <span class="n">ref</span><span class="o">=</span><span class="n">ref</span><span class="p">)</span>
<br/></pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[89]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t_spin</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[89]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2 {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:        (sample: 4, component: 2)
Coordinates:
  * sample         (sample) object MultiIndex
  * spinodal       (sample) int64 0 0 1 1
  * lnz_0          (sample) float64 1.202 1.202 -1.806 -1.806
  * lnz_1          (sample) float64 0.0 0.0 0.0 0.0
  * phase          (sample) int64 0 1 0 1
    beta           float64 1.0
    volume         float64 1.0
Dimensions without coordinates: component
Data variables:
    edge_distance  (sample) float64 31.11 1.0 31.11 29.7
    molfrac        (sample, component) float64 0.01297 0.987 ... 0.979 0.02102
    nvec           (sample, component) float64 2.715 206.5 252.4 ... 206.7 4.438
    betapV         (sample) float64 1.248e+03 1.705e+03 1.246e+03 996.1
Attributes:
    dims_n:      [&#x27;n_0&#x27;, &#x27;n_1&#x27;]
    dims_lnz:    [&#x27;lnz_0&#x27;, &#x27;lnz_1&#x27;]
    dims_comp:   [&#x27;component&#x27;]
    dims_state:  [&#x27;lnz_0&#x27;, &#x27;lnz_1&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]
    dims_rec:    [&#x27;sample&#x27;]
    long_name:   distance from upper edge</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-61f6df54-fae4-49e6-9272-5b049918854f' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-61f6df54-fae4-49e6-9272-5b049918854f' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>sample</span>: 4</li><li><span>component</span>: 2</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-8dcda43a-7b44-42d0-8ef8-1289749c61dd' class='xr-section-summary-in' type='checkbox'  checked><label for='section-8dcda43a-7b44-42d0-8ef8-1289749c61dd' class='xr-section-summary' >Coordinates: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>sample</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>MultiIndex</div><input id='attrs-898dfb13-c39a-4fe9-b7a9-431fcddf5a54' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-898dfb13-c39a-4fe9-b7a9-431fcddf5a54' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-296c129a-9efc-40d8-9704-1d87731fc6ad' class='xr-var-data-in' type='checkbox'><label for='data-296c129a-9efc-40d8-9704-1d87731fc6ad' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([(0, 1.2015754333333324, 0.0, 0), (0, 1.2015754333333324, 0.0, 1),
       (1, -1.8057242053333276, 0.0, 0), (1, -1.8057242053333276, 0.0, 1)],
      dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>spinodal</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 0 1 1</div><input id='attrs-d10ccaed-6dbf-435b-9dc2-eaf67ce89870' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d10ccaed-6dbf-435b-9dc2-eaf67ce89870' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-11bb0d33-fa14-452a-8dad-030bbe862559' class='xr-var-data-in' type='checkbox'><label for='data-11bb0d33-fa14-452a-8dad-030bbe862559' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 0, 1, 1])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lnz_0</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.202 1.202 -1.806 -1.806</div><input id='attrs-4697a737-dfed-4501-9d47-dc33e0d64971' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4697a737-dfed-4501-9d47-dc33e0d64971' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-10d45e59-8098-4538-85cd-6077fa10998b' class='xr-var-data-in' type='checkbox'><label for='data-10d45e59-8098-4538-85cd-6077fa10998b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 1.201575,  1.201575, -1.805724, -1.805724])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lnz_1</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 0.0</div><input id='attrs-2eeedcb5-fee2-4207-8c61-4798c0c95341' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2eeedcb5-fee2-4207-8c61-4798c0c95341' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-860bff02-590e-4854-8652-4e9baeb6392c' class='xr-var-data-in' type='checkbox'><label for='data-860bff02-590e-4854-8652-4e9baeb6392c' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0., 0., 0., 0.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>phase</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 0 1</div><input id='attrs-a060ae83-00ef-417b-a2f8-a34ce6e66fcd' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a060ae83-00ef-417b-a2f8-a34ce6e66fcd' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-40714864-ff41-4e44-94cd-11a64c1dda3f' class='xr-var-data-in' type='checkbox'><label for='data-40714864-ff41-4e44-94cd-11a64c1dda3f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 1, 0, 1])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>beta</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.0</div><input id='attrs-2422213e-790a-4f4a-b967-470bb0c55b3a' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2422213e-790a-4f4a-b967-470bb0c55b3a' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-92f41d39-90c3-4b6b-849f-f8ec510446e4' class='xr-var-data-in' type='checkbox'><label for='data-92f41d39-90c3-4b6b-849f-f8ec510446e4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(1.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>volume</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.0</div><input id='attrs-f66fc05a-6bf5-4c90-b497-6ce38c9090fc' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f66fc05a-6bf5-4c90-b497-6ce38c9090fc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-49daceb8-4b21-4129-8c51-830f903c66e3' class='xr-var-data-in' type='checkbox'><label for='data-49daceb8-4b21-4129-8c51-830f903c66e3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(1.)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-01109378-8469-48ac-a40a-2c1d417b167b' class='xr-section-summary-in' type='checkbox'  checked><label for='section-01109378-8469-48ac-a40a-2c1d417b167b' class='xr-section-summary' >Data variables: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>edge_distance</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>31.11 1.0 31.11 29.7</div><input id='attrs-7133e369-12b4-4880-9eac-ece325cda555' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7133e369-12b4-4880-9eac-ece325cda555' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-bcdacd37-4d9f-4be9-adaf-dc3f0441a8f5' class='xr-var-data-in' type='checkbox'><label for='data-bcdacd37-4d9f-4be9-adaf-dc3f0441a8f5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>dims_n :</span></dt><dd>[&#x27;n_0&#x27;, &#x27;n_1&#x27;]</dd><dt><span>dims_lnz :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;lnz_1&#x27;]</dd><dt><span>dims_comp :</span></dt><dd>[&#x27;component&#x27;]</dd><dt><span>dims_state :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;lnz_1&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]</dd><dt><span>dims_rec :</span></dt><dd>[&#x27;sample&#x27;]</dd><dt><span>long_name :</span></dt><dd>distance from upper edge</dd></dl></div><div class='xr-var-data'><pre>array([31.11269837,  1.        , 31.11269837, 29.69848481])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>molfrac</span></div><div class='xr-var-dims'>(sample, component)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.01297 0.987 1.0 ... 0.979 0.02102</div><input id='attrs-2a93b031-f813-4f19-aeac-46664c80aafb' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2a93b031-f813-4f19-aeac-46664c80aafb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1963db80-986a-46ae-b48a-8cba39ee430b' class='xr-var-data-in' type='checkbox'><label for='data-1963db80-986a-46ae-b48a-8cba39ee430b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>dims_n :</span></dt><dd>[&#x27;n_0&#x27;, &#x27;n_1&#x27;]</dd><dt><span>dims_lnz :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;lnz_1&#x27;]</dd><dt><span>dims_comp :</span></dt><dd>[&#x27;component&#x27;]</dd><dt><span>dims_state :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;lnz_1&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]</dd><dt><span>dims_rec :</span></dt><dd>[&#x27;sample&#x27;]</dd><dt><span>long_name :</span></dt><dd>${\bf x}(\mu,V,T)$</dd></dl></div><div class='xr-var-data'><pre>array([[1.29744853e-02, 9.87025515e-01],
       [9.99985806e-01, 1.41935483e-05],
       [3.17187024e-04, 9.99682813e-01],
       [9.78978241e-01, 2.10217585e-02]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>nvec</span></div><div class='xr-var-dims'>(sample, component)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.715 206.5 252.4 ... 206.7 4.438</div><input id='attrs-36df73c7-1c15-46c1-a3bf-20162a196325' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-36df73c7-1c15-46c1-a3bf-20162a196325' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3e7a0190-8d08-48e8-91b3-c6c97e060149' class='xr-var-data-in' type='checkbox'><label for='data-3e7a0190-8d08-48e8-91b3-c6c97e060149' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>dims_n :</span></dt><dd>[&#x27;n_0&#x27;, &#x27;n_1&#x27;]</dd><dt><span>dims_lnz :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;lnz_1&#x27;]</dd><dt><span>dims_comp :</span></dt><dd>[&#x27;component&#x27;]</dd><dt><span>dims_state :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;lnz_1&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]</dd><dt><span>dims_rec :</span></dt><dd>[&#x27;sample&#x27;]</dd><dt><span>long_name :</span></dt><dd>${\bf n}(\mu,V,T)$</dd></dl></div><div class='xr-var-data'><pre>array([[2.71467322e+00, 2.06516996e+02],
       [2.52439940e+02, 3.58306932e-03],
       [6.67557447e-02, 2.10395021e+02],
       [2.06675356e+02, 4.43797344e+00]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>betapV</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.248e+03 1.705e+03 1.246e+03 996.1</div><input id='attrs-4053bf20-4974-43d4-9bcf-3ca12a31f2ab' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-4053bf20-4974-43d4-9bcf-3ca12a31f2ab' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f1ff1ba4-6481-4bbf-bdfb-cf9b7692b5d5' class='xr-var-data-in' type='checkbox'><label for='data-f1ff1ba4-6481-4bbf-bdfb-cf9b7692b5d5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>dims_n :</span></dt><dd>[&#x27;n_0&#x27;, &#x27;n_1&#x27;]</dd><dt><span>dims_lnz :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;lnz_1&#x27;]</dd><dt><span>dims_comp :</span></dt><dd>[&#x27;component&#x27;]</dd><dt><span>dims_state :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;lnz_1&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]</dd><dt><span>dims_rec :</span></dt><dd>[&#x27;sample&#x27;]</dd><dt><span>standard_name :</span></dt><dd>grand_potential</dd><dt><span>long_name :</span></dt><dd>$\beta p(\mu,V,T)V$</dd></dl></div><div class='xr-var-data'><pre>array([1248.00999152, 1705.21428595, 1246.18714097,  996.09560846])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-daa10c48-fbfa-445c-9fce-59135bf0bbc2' class='xr-section-summary-in' type='checkbox'  checked><label for='section-daa10c48-fbfa-445c-9fce-59135bf0bbc2' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>dims_n :</span></dt><dd>[&#x27;n_0&#x27;, &#x27;n_1&#x27;]</dd><dt><span>dims_lnz :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;lnz_1&#x27;]</dd><dt><span>dims_comp :</span></dt><dd>[&#x27;component&#x27;]</dd><dt><span>dims_state :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;lnz_1&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]</dd><dt><span>dims_rec :</span></dt><dd>[&#x27;sample&#x27;]</dd><dt><span>long_name :</span></dt><dd>distance from upper edge</dd></dl></div></li></ul></div></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[90]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t_spin</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="s1">&#39;sample&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;component==0 and spinodal==phase&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[90]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>spinodal</th>
      <th>lnz_0</th>
      <th>lnz_1</th>
      <th>phase</th>
      <th>beta</th>
      <th>volume</th>
      <th>edge_distance</th>
      <th>molfrac</th>
      <th>nvec</th>
      <th>betapV</th>
    </tr>
    <tr>
      <th>sample</th>
      <th>component</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <th>0</th>
      <td>0</td>
      <td>1.201575</td>
      <td>0.0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>31.112698</td>
      <td>0.012974</td>
      <td>2.714673</td>
      <td>1248.009992</td>
    </tr>
    <tr>
      <th>3</th>
      <th>0</th>
      <td>1</td>
      <td>-1.805724</td>
      <td>0.0</td>
      <td>1</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>29.698485</td>
      <td>0.978978</td>
      <td>206.675356</td>
      <td>996.095608</td>
    </tr>
  </tbody>
</table>
</div></div>
</div>
<p>doing this for multiple values of fixed <code class="docutils literal notranslate"><span class="pre">lnz_1</span></code>:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[91]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">joblib</span> <span class="kn">import</span> <span class="n">Parallel</span><span class="p">,</span> <span class="n">delayed</span>
<span class="kn">from</span> <span class="nn">tqdm.notebook</span> <span class="kn">import</span> <span class="n">tqdm</span>

<span class="k">def</span> <span class="nf">get_bin_spin1</span><span class="p">(</span><span class="n">lnz2</span><span class="p">,</span> <span class="n">phase_creator</span><span class="p">,</span> <span class="n">from_builder</span><span class="p">,</span> <span class="n">from_builder_kws</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">build_phases</span> <span class="o">=</span> <span class="n">phase_creator</span><span class="o">.</span><span class="n">build_phases_mu</span><span class="p">([</span><span class="kc">None</span><span class="p">,</span> <span class="n">lnz2</span><span class="p">])</span>
    <span class="n">lnzs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">from_builder_kws</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">from_builder_kws</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">from_builder</span><span class="p">(</span><span class="n">lnzs</span><span class="p">,</span> <span class="n">build_phases</span><span class="p">,</span> <span class="o">**</span><span class="n">from_builder_kws</span><span class="p">)</span>
    <span class="n">t_spin</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">t_bino</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">c</span><span class="o">.</span><span class="n">spinodal</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">build_phases</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">unstack</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">c</span><span class="o">.</span><span class="n">binodal</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">build_phases</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">unstack</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">t_spin</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">spinodal</span><span class="o">.</span><span class="n">access</span><span class="o">.</span><span class="n">xge</span><span class="o">.</span><span class="n">table</span><span class="p">([</span><span class="s1">&#39;molfrac&#39;</span><span class="p">],</span> <span class="n">ref</span><span class="o">=</span><span class="n">ref</span><span class="p">)</span>
        <span class="n">t_bino</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">binodal</span><span class="o">.</span><span class="n">access</span><span class="o">.</span><span class="n">xge</span><span class="o">.</span><span class="n">table</span><span class="p">([</span><span class="s1">&#39;molfrac&#39;</span><span class="p">],</span> <span class="n">ref</span><span class="o">=</span><span class="n">ref</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">return</span> <span class="n">t_spin</span><span class="p">,</span> <span class="n">t_bino</span>
<br/><br/></pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[92]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">out1</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)(</span><span class="n">delayed</span><span class="p">(</span><span class="n">get_bin_spin1</span><span class="p">)(</span><span class="n">lnz2</span><span class="p">,</span> <span class="n">phase_creator</span><span class="p">,</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">lnPiCollection</span><span class="o">.</span><span class="n">from_builder</span><span class="p">)</span>
                                                      <span class="k">for</span> <span class="n">lnz2</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
                                                     <span class="p">)</span>
<span class="n">spin1</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">out1</span> <span class="k">if</span> <span class="n">s</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">],</span> <span class="s1">&#39;sample&#39;</span><span class="p">)</span>
<span class="n">bino1</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">b</span> <span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">out1</span> <span class="k">if</span> <span class="n">b</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">],</span> <span class="s1">&#39;sample&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[93]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_frame</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="o">**</span><span class="n">kws</span><span class="p">):</span>
    <span class="p">(</span>
        <span class="n">df</span>
        <span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        <span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s1">&#39;molfrac&#39;</span><span class="p">,</span><span class="s1">&#39;phase&#39;</span><span class="p">])</span>
        <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">pV</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;betapV&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">x</span><span class="p">[</span><span class="s1">&#39;beta&#39;</span><span class="p">])</span>
        <span class="p">[</span><span class="s1">&#39;pV&#39;</span><span class="p">]</span>
        <span class="o">.</span><span class="n">to_xarray</span><span class="p">()</span>
        <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hue</span><span class="o">=</span><span class="s1">&#39;phase&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kws</span><span class="p">)</span>
    <span class="p">)</span>


<span class="n">plot_frame</span><span class="p">(</span><span class="n">spin1</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="s1">&#39;sample&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;component==0 and spinodal==phase&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="n">plot_frame</span><span class="p">(</span><span class="n">bino1</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="s1">&#39;sample&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s1">&#39;component==0&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_Basic_usage_148_0.png" src="../_images/notebooks_Basic_usage_148_0.png" />
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../installation.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../api_autosummary.html" class="btn btn-neutral float-right" title="API Reference" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, William P. Krekelberg.
      <span class="lastupdated">Last updated on 2022-09-14.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>