

<!DOCTYPE html>


<html lang="en" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Why tmmc-lnpy? &#8212; tmmc-lnpy 0.2.2 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=12da95d707ffb74b382d" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=12da95d707ffb74b382d" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="https://pages.nist.gov/nist-header-footer/css/nist-combined.css" />
    <link rel="stylesheet" type="text/css" href="https://pages.nist.gov/leaveNotice/css/jquery.leaveNotice.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/sphinx_highlight.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script src="https://code.jquery.com/jquery-3.6.2.min.js"></script>
    <script src="https://pages.nist.gov/nist-header-footer/js/nist-header-footer.js"></script>
    <script src="https://pages.nist.gov/leaveNotice/js/jquery.leaveNotice-nist.min.js"></script>
    <script src="../_static/js/leave_notice.js"></script>
    <script async="async" id="_fed_au_ua_tag" type="text/javascript" src="https://dap.digitalgov.gov/Universal-Federated-Analytics-Min.js?agency=NIST&subagency=github&pua=UA-66610693-1&yt=true&exts=ppsx,pps,f90,sch,rtf,wrl,txz,m1v,xlsm,msi,xsd,f,tif,eps,mpg,xml,pl,xlt,c"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="application/vnd.jupyter.widget-state+json">{"state": {"07f40fcf6ba8482d88e1990ade4473dd": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "23b2317bea634855ab216f09fb8f9e6d": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_5ba27f26f4024fd294659073ba4b45e9", "max": 2000.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_07f40fcf6ba8482d88e1990ade4473dd", "tabbable": null, "tooltip": null, "value": 2000.0}}, "23d077eade8941a9b85046f5e51c5a31": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_302696ebde344fb2add7a7061ec90b27", "placeholder": "\u200b", "style": "IPY_MODEL_3bd9981d9d8a4b1c857cf65f83f19c26", "tabbable": null, "tooltip": null, "value": " 1552/2000 [00:03&lt;00:00, 1174.33it/s]"}}, "2c66bd555af84b0290c3844b51a314ff": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "302696ebde344fb2add7a7061ec90b27": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "3bd9981d9d8a4b1c857cf65f83f19c26": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "3ee44ec6696b4eb284b32a1feb952bca": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_a34bfc10b1e6419e98e5d34460c5d60b", "IPY_MODEL_cfd4469f2f02439189f79f8b52156b69", "IPY_MODEL_23d077eade8941a9b85046f5e51c5a31"], "layout": "IPY_MODEL_8077c9154af1422d93ed460667b34e79", "tabbable": null, "tooltip": null}}, "5ba27f26f4024fd294659073ba4b45e9": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "5f6a68b26613411ea1992bfa3ac607e9": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "733e678f32b14cdab5605c850cc3cd56": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": "hidden", "width": null}}, "8077c9154af1422d93ed460667b34e79": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": "hidden", "width": null}}, "892de3457b9f44b5ba9e9413ff4167d1": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HBoxModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HBoxModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HBoxView", "box_style": "", "children": ["IPY_MODEL_b6d79d676b1b4363838d968564452d09", "IPY_MODEL_23b2317bea634855ab216f09fb8f9e6d", "IPY_MODEL_f9c4485d0cd24bc99e632c57085fb992"], "layout": "IPY_MODEL_733e678f32b14cdab5605c850cc3cd56", "tabbable": null, "tooltip": null}}, "8a662622fd114ac784db945c89ce2d58": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "a34bfc10b1e6419e98e5d34460c5d60b": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_2c66bd555af84b0290c3844b51a314ff", "placeholder": "\u200b", "style": "IPY_MODEL_8a662622fd114ac784db945c89ce2d58", "tabbable": null, "tooltip": null, "value": "build:  78%"}}, "aa0c23643f424759805f978f167241e2": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "ad1e8c895a2a459881470b8359a2456b": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "ProgressStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "ProgressStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "bar_color": null, "description_width": ""}}, "b6d79d676b1b4363838d968564452d09": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_f33fc752bb7f41b8a5f3cfe41756869a", "placeholder": "\u200b", "style": "IPY_MODEL_eff32c215cb34c59a1f6027f9a74be0a", "tabbable": null, "tooltip": null, "value": "pi_norm:  89%"}}, "b992180983874360bd0800e761eeabfb": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "cfd4469f2f02439189f79f8b52156b69": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "FloatProgressModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "FloatProgressModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "ProgressView", "bar_style": "", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_5f6a68b26613411ea1992bfa3ac607e9", "max": 2000.0, "min": 0.0, "orientation": "horizontal", "style": "IPY_MODEL_ad1e8c895a2a459881470b8359a2456b", "tabbable": null, "tooltip": null, "value": 2000.0}}, "eff32c215cb34c59a1f6027f9a74be0a": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLStyleModel", "state": {"_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLStyleModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "StyleView", "background": null, "description_width": "", "font_size": null, "text_color": null}}, "f33fc752bb7f41b8a5f3cfe41756869a": {"model_module": "@jupyter-widgets/base", "model_module_version": "2.0.0", "model_name": "LayoutModel", "state": {"_model_module": "@jupyter-widgets/base", "_model_module_version": "2.0.0", "_model_name": "LayoutModel", "_view_count": null, "_view_module": "@jupyter-widgets/base", "_view_module_version": "2.0.0", "_view_name": "LayoutView", "align_content": null, "align_items": null, "align_self": null, "border_bottom": null, "border_left": null, "border_right": null, "border_top": null, "bottom": null, "display": null, "flex": null, "flex_flow": null, "grid_area": null, "grid_auto_columns": null, "grid_auto_flow": null, "grid_auto_rows": null, "grid_column": null, "grid_gap": null, "grid_row": null, "grid_template_areas": null, "grid_template_columns": null, "grid_template_rows": null, "height": null, "justify_content": null, "justify_items": null, "left": null, "margin": null, "max_height": null, "max_width": null, "min_height": null, "min_width": null, "object_fit": null, "object_position": null, "order": null, "overflow": null, "padding": null, "right": null, "top": null, "visibility": null, "width": null}}, "f9c4485d0cd24bc99e632c57085fb992": {"model_module": "@jupyter-widgets/controls", "model_module_version": "2.0.0", "model_name": "HTMLModel", "state": {"_dom_classes": [], "_model_module": "@jupyter-widgets/controls", "_model_module_version": "2.0.0", "_model_name": "HTMLModel", "_view_count": null, "_view_module": "@jupyter-widgets/controls", "_view_module_version": "2.0.0", "_view_name": "HTMLView", "description": "", "description_allow_html": false, "layout": "IPY_MODEL_aa0c23643f424759805f978f167241e2", "placeholder": "\u200b", "style": "IPY_MODEL_b992180983874360bd0800e761eeabfb", "tabbable": null, "tooltip": null, "value": " 1786/2000 [00:00&lt;00:00, 17852.36it/s]"}}}, "version_major": 2, "version_minor": 0}</script>
    <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script crossorigin="anonymous" data-jupyter-widgets-cdn="https://cdn.jsdelivr.net/npm/" src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'notebooks/Basic_usage';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="API reference" href="../reference/index.html" />
    <link rel="prev" title="Installation" href="../installation.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    <p class="title logo__title">tmmc-lnpy 0.2.2 documentation</p>
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../index.html">
                    tmmc-lnpy
                </a>
            </li>
        </ul>
        <ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Why <code class="docutils literal notranslate"><span class="pre">tmmc-lnpy</span></code>?</a></li>






<li class="toctree-l1 has-children"><a class="reference internal" href="../reference/index.html">API reference</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../reference/api-public.html">Top level API (<code class="xref py py-mod docutils literal notranslate"><span class="pre">lnpy</span></code>)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/generated/lnpy.lnpidata.html">lnPi data classes and routines (<code class="xref py py-mod docutils literal notranslate"><span class="pre">lnpidata</span></code>)</a></li>



<li class="toctree-l2"><a class="reference internal" href="../reference/generated/lnpy.lnpienergy.html">Local free energy of lnPi (<code class="xref py py-mod docutils literal notranslate"><span class="pre">lnpienergy</span></code>)</a></li>











<li class="toctree-l2"><a class="reference internal" href="../reference/generated/lnpy.segment.html">Segmentation of lnPi (<code class="xref py py-mod docutils literal notranslate"><span class="pre">segment</span></code>)</a></li>






<li class="toctree-l2"><a class="reference internal" href="../reference/generated/lnpy.ensembles.html">Ensemble averages (<code class="xref py py-mod docutils literal notranslate"><span class="pre">ensembles</span></code>)</a></li>






<li class="toctree-l2"><a class="reference internal" href="../reference/generated/lnpy.options.html">Options (<code class="xref py py-mod docutils literal notranslate"><span class="pre">options</span></code>)</a></li>

<li class="toctree-l2"><a class="reference internal" href="../reference/generated/lnpy.stability.html">Thermodynamic stability (<code class="xref py py-mod docutils literal notranslate"><span class="pre">stability</span></code>)</a></li>





<li class="toctree-l2"><a class="reference internal" href="../reference/generated/lnpy.utils.html">Utility functions (<code class="xref py py-mod docutils literal notranslate"><span class="pre">utils</span></code>)</a></li>










<li class="toctree-l2"><a class="reference internal" href="../reference/generated/lnpy.examples.html">Examples (<code class="xref py py-mod docutils literal notranslate"><span class="pre">examples</span></code>)</a></li>








<li class="toctree-l2"><a class="reference internal" href="../reference/generated/lnpy.lnpiseries.html">Collection of lnPi objects (<code class="xref py py-mod docutils literal notranslate"><span class="pre">lnpiseries</span></code>)</a></li>


<li class="toctree-l2"><a class="reference internal" href="../reference/generated/lnpy.maskedlnpi_legacy.html">Legacy lnPi array routines (<code class="xref py py-mod docutils literal notranslate"><span class="pre">maskedlnpi_legacy</span></code>)</a></li>

<li class="toctree-l2"><a class="reference internal" href="../reference/api-other.html">Base classes and other methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../reference/api-legacy.html">Legacy API</a></li>
</ul>
</li>

<li class="toctree-l1"><a class="reference internal" href="../license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../authors.html">Credits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../history.html">History</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../navigation.html">Indices and tables</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../genindex.html">Index</a></li>
<li class="toctree-l2"><a class="reference internal" href="../py-modindex.html">Module Index</a></li>
</ul>
</li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/usnistgov/cmomy" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/usnistgov/cmomy/issues/new?title=Issue%20on%20page%20%2Fnotebooks/Basic_usage.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/notebooks/Basic_usage.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Why tmmc-lnpy?</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Why <code class="docutils literal notranslate"><span class="pre">tmmc-lnpy</span></code>?</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#usage">Usage</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lnpimasked">lnPiMasked</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reweighting-results">Reweighting results</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-ensemble-properties">Calculating Ensemble properties</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#collections-of-lnpi-values">Collections of lnPi Values</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#accessing-properties-of-collection">Accessing properties of collection</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#loading-examples">Loading examples</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#single-component-system-with-phase-transitions">Single component system with phase transitions.</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#local-maxima">Local maxima</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed">Watershed</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#local-free-energy">local free energy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#construct-collection">Construct collection</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#at-a-different-ln-z-value">At a different <span class="math notranslate nohighlight">\(\ln z\)</span> value</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tagging-phases">Tagging phases</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#calculation-binodal-and-spinodal">Calculation Binodal and spinodal</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#multi-component-systems">Multi component systems</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#considering-lines-of-constant-ln-z-or-constant-delta-ln-z">Considering lines of constant <span class="math notranslate nohighlight">\(\ln z\)</span> or constant <span class="math notranslate nohighlight">\(\Delta \ln z\)</span>.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#multicomponent-system-with-phase-transitions">Multicomponent system with phase transitions</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="why-tmmc-lnpy">
<h1>Why <code class="docutils literal notranslate"><span class="pre">tmmc-lnpy</span></code>?<a class="headerlink" href="#why-tmmc-lnpy" title="Permalink to this heading">#</a></h1>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>While the distribution is named <code class="docutils literal notranslate"><span class="pre">tmmc-lnpy</span></code>, it provides the python package <a class="reference internal" href="../reference/api-public.html#module-lnpy" title="lnpy"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lnpy</span></code></a>.  This naming was done to avoid conflicts with other packages on pypi.   The name of the module <a class="reference internal" href="../reference/api-public.html#module-lnpy" title="lnpy"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lnpy</span></code></a> may be changed in the future.</p>
</div>
<p><a class="reference internal" href="../reference/api-public.html#module-lnpy" title="lnpy"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lnpy</span></code></a> is a python package to analyze the main output of Grand Canonical Transition Matrix Monte Carlo (GC-TMMC) simulations: <span class="math notranslate nohighlight">\(\ln \Pi(N)\)</span>.  Hence the name. <a class="reference internal" href="../reference/api-public.html#module-lnpy" title="lnpy"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lnpy</span></code></a> is designed to calculate a host of properties in the Canonical and Grand Canonical ensembles.   For a review of GC-TMMC and the property <span class="math notranslate nohighlight">\(\ln \Pi(N)\)</span>, look at some of the following references:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://journals.aps.org/pre/abstract/10.1103/PhysRevE.67.012102">Evaluating surface tension using grand-canonical transition-matrix Monte Carlo simulation and finite-size scaling</a></p></li>
<li><p><a class="reference external" href="http://dx.doi.org/10.1063/1.2064628">Direct evaluation of multicomponent phase equilibria using flat-histogram methods</a></p></li>
<li><p><a class="reference external" href="http://link.aip.org/link/?JCP/118/9915/1">Direct calculation of liquid–vapor phase equilibria from transition matrix Monte Carlo simulation</a></p></li>
<li><p><a class="reference external" href="https://pubs.acs.org/doi/10.1021/jp040218y">Metastability and instability in the Lennard-Jones fluid investigated by transition-matrix Monte Carlo</a></p></li>
</ul>
<p><span class="math notranslate nohighlight">\(\Pi(N; \mu, T, V)\)</span> is the macrostate probability of observing <span class="math notranslate nohighlight">\(N\)</span> particles at a given chemical potential <span class="math notranslate nohighlight">\(\mu\)</span>, temperature <span class="math notranslate nohighlight">\(T\)</span> and volume <span class="math notranslate nohighlight">\(V\)</span>.  We drop the explicit mention of <span class="math notranslate nohighlight">\(\mu\)</span>, <span class="math notranslate nohighlight">\(V\)</span> and <span class="math notranslate nohighlight">\(T\)</span> below for simplicity.  This distribution is related to the grand canonical ensemble by:</p>
<div class="math notranslate nohighlight">
\[ \Pi(N) = \frac{\exp(\beta \mu N) Q(N, V, T)}{\Xi(\mu, V, T)}\]</div>
<p>Where <span class="math notranslate nohighlight">\(\beta = 1 / (k_{\rm B} T)\)</span> is the inverse temperature, <span class="math notranslate nohighlight">\(k_{\rm B}\)</span> is Boltzmann’s constant, <span class="math notranslate nohighlight">\(Q(N, V, T)\)</span> is the canonical partition function, and <span class="math notranslate nohighlight">\(\Xi(\mu, V, T)\)</span> is the grand canonical partition function.   GC-TMMC simulation provide a means to calculate the <span class="math notranslate nohighlight">\(\ln \Pi(N; \mu, V, T)\)</span> directly.  One of the truly excellent qualities of such simulations is that once <span class="math notranslate nohighlight">\(\ln \Pi\)</span> is collected at a given chemical potential <span class="math notranslate nohighlight">\(\mu_0\)</span>, it can be rescaled to any other chemical potential <span class="math notranslate nohighlight">\(\mu\)</span> through rescaling of the form:</p>
<div class="math notranslate nohighlight">
\[ \ln \Pi(N; \mu, V, T) = \ln \Pi(N; \mu_0, V, T) + \beta N (\mu - \mu_0) + C \]</div>
<p>where <span class="math notranslate nohighlight">\(C\)</span> is a normalization constant which does not effect most calculated properties.  From <span class="math notranslate nohighlight">\(\ln \Pi(N)\)</span>, many thermodynamic properties can be calculated.  The grand potential <span class="math notranslate nohighlight">\(\Omega\)</span>, and hence the system pressure <span class="math notranslate nohighlight">\(p\)</span>, can be obtained from</p>
<div class="math notranslate nohighlight">
\[ \beta \Omega = -\beta p V = \ln \Pi(0) + \ln \left[\sum_N \Pi(N, \mu, V, T) \right]\]</div>
<p>Also, grand canonical averages can be calculated from canonical averages using <span class="math notranslate nohighlight">\(\ln \Pi(N)\)</span>:</p>
<div class="math notranslate nohighlight">
\[ \overline{X} = \frac{\sum_N \Pi(N) X(N)}{\sum_N \Pi(N)} \]</div>
<p>Plus, <span class="math notranslate nohighlight">\(\ln \Pi\)</span> can be directly analyzed to identify unique phases, phase transitions, limits of stability, etc.  The package <a class="reference internal" href="../reference/api-public.html#module-lnpy" title="lnpy"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lnpy</span></code></a> provides a simple means to perform all the above calculations simply, and quickly.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="usage">
<h1>Usage<a class="headerlink" href="#usage" title="Permalink to this heading">#</a></h1>
<p>Lets consider a simple example: a Lennard-Jones (LJ) fluid at supercritical temperatures.<br />
An example value of <span class="math notranslate nohighlight">\(\ln \Pi(N)\)</span> (shorted to <code class="docutils literal notranslate"><span class="pre">lnPi</span></code>) can be loaded directly from <a class="reference internal" href="../reference/api-public.html#module-lnpy" title="lnpy"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lnpy</span></code></a> package:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">lnpy.examples</span>

<span class="n">data_dict</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="n">load_example_dict</span><span class="p">(</span><span class="s2">&quot;lj_sup&quot;</span><span class="p">)</span>
<span class="k">with</span> <span class="n">np</span><span class="o">.</span><span class="n">printoptions</span><span class="p">(</span><span class="n">precision</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=</span><span class="mi">5</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">data_dict</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">:</span><span class="si">{</span><span class="n">v</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>lnPi_data:[-1559.75 -1550.74 -1542.43 ...   -10.01   -11.02   -12.08]
lnPi_mask:[False False False ... False False False]
state_kws:{&#39;beta&#39;: 0.6666666666666666, &#39;volume&#39;: 512.0}
extra_kws:{&#39;PE&#39;: array([    0.  ,     0.  ,    -0.02, ..., -1643.18, -1648.71, -1654.36])}
lnz:[2.77]
</pre></div>
</div>
</div>
</div>
<p>Here, we have the parameters</p>
<ul class="simple">
<li><p>lnPi_data: the actual value of <span class="math notranslate nohighlight">\(\ln \Pi(N)\)</span>.</p></li>
<li><p>lnPi_mask: bool array.  where <code class="docutils literal notranslate"><span class="pre">mask</span> <span class="pre">==</span> <span class="pre">True</span></code>, values are ‘masked out’</p></li>
<li><p>state_kws: dict of ‘state’ variables. Here, it include the inverse temperature ‘beta’ <span class="math notranslate nohighlight">\(=\beta = 1/(k_{\rm B} T)\)</span>
and the systems volume ‘volume’ <span class="math notranslate nohighlight">\(=V\)</span></p></li>
<li><p>extra_kws: dict of ‘extra’ variables.  Here, it include ‘PE’, the canonical potential energy</p></li>
<li><p>lnz: log of activity <span class="math notranslate nohighlight">\(\ln z = \beta \mu\)</span>, where <span class="math notranslate nohighlight">\(\mu\)</span> is chemical potential.</p></li>
</ul>
<section id="lnpimasked">
<h2>lnPiMasked<a class="headerlink" href="#lnpimasked" title="Permalink to this heading">#</a></h2>
<p>The first important class is <a class="reference internal" href="../reference/generated/lnpy.lnpidata.html#lnpy.lnpidata.lnPiMasked" title="lnpy.lnpidata.lnPiMasked"><code class="xref py py-class docutils literal notranslate"><span class="pre">lnPiMasked</span></code></a>.  This class handles the basics of dealing with <span class="math notranslate nohighlight">\(\ln \Pi(N)\)</span>. To create it, to the following.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>


<span class="n">ref</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">lnPiMasked</span><span class="o">.</span><span class="n">from_data</span><span class="p">(</span>
    <span class="n">lnz</span><span class="o">=</span><span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;lnz&quot;</span><span class="p">],</span>
    <span class="n">lnz_data</span><span class="o">=</span><span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;lnz&quot;</span><span class="p">],</span>
    <span class="n">data</span><span class="o">=</span><span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;lnPi_data&quot;</span><span class="p">],</span>
    <span class="n">mask</span><span class="o">=</span><span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;lnPi_mask&quot;</span><span class="p">],</span>
    <span class="n">state_kws</span><span class="o">=</span><span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;state_kws&quot;</span><span class="p">],</span>
    <span class="n">extra_kws</span><span class="o">=</span><span class="n">data_dict</span><span class="p">[</span><span class="s2">&quot;extra_kws&quot;</span><span class="p">],</span>
<span class="p">)</span>
<span class="n">ref</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;lnPi(lnz=[2.76512052])&gt;
</pre></div>
</div>
</div>
</div>
<p>To access the underlying data, use the following</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ref</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x1a5589180&gt;]
</pre></div>
</div>
<img alt="../_images/e220641324e88d93df319627f728b0d98f6be8c8e9ed9fcda801b0e142d47eae.png" src="../_images/e220641324e88d93df319627f728b0d98f6be8c8e9ed9fcda801b0e142d47eae.png" />
</div>
</div>
</section>
<section id="reweighting-results">
<h2>Reweighting results<a class="headerlink" href="#reweighting-results" title="Permalink to this heading">#</a></h2>
<p>One of the amazing things about <span class="math notranslate nohighlight">\(\ln \Pi(N)\)</span> calculated at some chemical potential <span class="math notranslate nohighlight">\(\mu_{\rm ref}\)</span> is that it can be
reweighted to any other chemical potential <span class="math notranslate nohighlight">\(\mu\)</span>.  This is done with the formula</p>
<div class="math notranslate nohighlight">
\[
\ln \Pi(N, \mu) = \ln \Pi(N, \mu_{\rm ref}) + \beta (\mu - \mu_{\rm ref}) N
\]</div>
<p>To reweight data to another value of <span class="math notranslate nohighlight">\(\ln z\)</span>, we use the <a class="reference internal" href="../reference/generated/lnpy.lnpidata.html#lnpy.lnpidata.lnPiMasked.reweight" title="lnpy.lnpidata.lnPiMasked.reweight"><code class="xref py py-meth docutils literal notranslate"><span class="pre">lnpy.lnpidata.lnPiMasked.reweight()</span></code></a> method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">new</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">reweight</span><span class="p">(</span><span class="mf">4.0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>

<span class="c1"># compare to orginal</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ref</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">ref</span><span class="o">.</span><span class="n">lnz</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">new</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">new</span><span class="o">.</span><span class="n">lnz</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;lnPi(lnz=[4.])&gt;
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x1a56836d0&gt;]
</pre></div>
</div>
<img alt="../_images/75748d2af229d44afda033f20b1473042e1df57e1b72197f374abaeb4e2153f4.png" src="../_images/75748d2af229d44afda033f20b1473042e1df57e1b72197f374abaeb4e2153f4.png" />
</div>
</div>
<p><a class="reference internal" href="../reference/generated/lnpy.lnpidata.html#lnpy.lnpidata.lnPiMasked" title="lnpy.lnpidata.lnPiMasked"><code class="xref py py-class docutils literal notranslate"><span class="pre">lnpy.lnpidata.lnPiMasked</span></code></a> has a variety of utilities to work with the <span class="math notranslate nohighlight">\(\ln \Pi(N)\)</span> data. For example</p>
<ul class="simple">
<li><p>zeromax: shift <span class="math notranslate nohighlight">\(\ln \Pi(N)\)</span> such that maximum value is zero.  Useful for numerical stability</p></li>
<li><p>ma : <code class="docutils literal notranslate"><span class="pre">MaskedArray</span></code> view of data.  Used when constructing phases, and working with multicomponent data.</p></li>
<li></li>
</ul>
<p>Check out the api docs for further details</p>
</section>
<section id="calculating-ensemble-properties">
<h2>Calculating Ensemble properties<a class="headerlink" href="#calculating-ensemble-properties" title="Permalink to this heading">#</a></h2>
<p><span class="math notranslate nohighlight">\(\ln \Pi(N)\)</span> can be used to calculate a variety of properties in the Canonical and Grand Canonical ensembles.
To make everything easier, the actual value of <span class="math notranslate nohighlight">\(\ln \Pi(N)\)</span> is wrapped in an DataArray object, which provides some nice data goodies.  To access this view, use the <a class="reference internal" href="../reference/generated/lnpy.lnpidata.html#lnpy.lnpidata.lnPiMasked.xce" title="lnpy.lnpidata.lnPiMasked.xce"><code class="xref py py-attr docutils literal notranslate"><span class="pre">xce</span></code></a> or <a class="reference internal" href="../reference/generated/lnpy.lnpidata.html#lnpy.lnpidata.lnPiMasked.xge" title="lnpy.lnpidata.lnPiMasked.xge"><code class="xref py py-attr docutils literal notranslate"><span class="pre">xge</span></code></a> accessors (short for Xarray Canonical Ensemble and Xarray Grand canonical Ensemble).  For example, the canonical properties can be obtained as follows:</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>We only show a small subset of functionality.  For further information, see <a class="reference internal" href="../reference/generated/lnpy.lnpidata.html#lnpy.lnpidata.lnPiMasked" title="lnpy.lnpidata.lnPiMasked"><code class="xref py py-class docutils literal notranslate"><span class="pre">lnPiMasked</span></code></a>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># pressure</span>
<span class="n">ref</span><span class="o">.</span><span class="n">xce</span><span class="o">.</span><span class="n">pressure</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;pressure&#x27; (n_0: 5)&gt;
array([-0.        ,  0.00100796,  0.00319043,  0.00560728,  0.00813105])
Coordinates:
    beta     float64 0.6667
    volume   float64 512.0
  * n_0      (n_0) int64 0 1 2 3 4
Attributes:
    long_name:  $p({\bf n},V,T)$</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'pressure'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>n_0</span>: 5</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-8b40291d-0684-4137-979d-554347f6bca6' class='xr-array-in' type='checkbox' checked><label for='section-8b40291d-0684-4137-979d-554347f6bca6' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>-0.0 0.001008 0.00319 0.005607 0.008131</span></div><div class='xr-array-data'><pre>array([-0.        ,  0.00100796,  0.00319043,  0.00560728,  0.00813105])</pre></div></div></li><li class='xr-section-item'><input id='section-549c0578-2370-4910-98d7-834bac0145bb' class='xr-section-summary-in' type='checkbox'  checked><label for='section-549c0578-2370-4910-98d7-834bac0145bb' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>beta</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.6667</div><input id='attrs-ededf3f7-cad9-4179-9c14-b97c78ed2b8e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ededf3f7-cad9-4179-9c14-b97c78ed2b8e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d42d8de0-7b25-4522-a168-dd4513e64985' class='xr-var-data-in' type='checkbox'><label for='data-d42d8de0-7b25-4522-a168-dd4513e64985' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(0.66666667)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>volume</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>512.0</div><input id='attrs-619b8fa5-4321-45b4-8016-6f48f0a97959' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-619b8fa5-4321-45b4-8016-6f48f0a97959' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4c84b22e-cab1-4edb-b84a-c7edaa7ffa83' class='xr-var-data-in' type='checkbox'><label for='data-4c84b22e-cab1-4edb-b84a-c7edaa7ffa83' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(512.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>n_0</span></div><div class='xr-var-dims'>(n_0)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4</div><input id='attrs-7087f408-9a1a-47ab-ae1a-77641e53194b' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-7087f408-9a1a-47ab-ae1a-77641e53194b' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0073036e-ca64-4ae1-acf8-921f6457bdf3' class='xr-var-data-in' type='checkbox'><label for='data-0073036e-ca64-4ae1-acf8-921f6457bdf3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>$n_0$</dd></dl></div><div class='xr-var-data'><pre>array([0, 1, 2, 3, 4])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-7c314eeb-331f-4259-add5-786b218fbfaf' class='xr-section-summary-in' type='checkbox'  ><label for='section-7c314eeb-331f-4259-add5-786b218fbfaf' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>n_0</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-942a1cee-3397-4d8a-8fb2-5c23e59fc865' class='xr-index-data-in' type='checkbox'/><label for='index-942a1cee-3397-4d8a-8fb2-5c23e59fc865' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Int64Index([0, 1, 2, 3, 4], dtype=&#x27;int64&#x27;, name=&#x27;n_0&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-8004d7de-aa6f-4624-939b-94a36b6dadb3' class='xr-section-summary-in' type='checkbox'  checked><label for='section-8004d7de-aa6f-4624-939b-94a36b6dadb3' class='xr-section-summary' >Attributes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>$p({\bf n},V,T)$</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#  scaled Helmholtz free energy</span>
<span class="n">ref</span><span class="o">.</span><span class="n">xce</span><span class="o">.</span><span class="n">betaF</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;betaF&#x27; (n_0: 5)&gt;
array([  0.        ,  -6.23817948, -11.78825896, -16.93743845,
       -21.80391793])
Coordinates:
    beta     float64 0.6667
    volume   float64 512.0
  * n_0      (n_0) int64 0 1 2 3 4
Attributes:
    dims_n:         [&#x27;n_0&#x27;]
    dims_lnz:       [&#x27;lnz_0&#x27;]
    dims_comp:      [&#x27;component&#x27;]
    dims_state:     [&#x27;lnz_0&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]
    dims_rec:       []
    standard_name:  helmholtz_free_energy
    long_name:      $\beta F({\bf n},V,T)$</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'betaF'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>n_0</span>: 5</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-c12065a7-5a29-4cb8-b5db-4631bec5a81d' class='xr-array-in' type='checkbox' checked><label for='section-c12065a7-5a29-4cb8-b5db-4631bec5a81d' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.0 -6.238 -11.79 -16.94 -21.8</span></div><div class='xr-array-data'><pre>array([  0.        ,  -6.23817948, -11.78825896, -16.93743845,
       -21.80391793])</pre></div></div></li><li class='xr-section-item'><input id='section-4dc78485-a5ee-44cd-8ec2-9369def84d95' class='xr-section-summary-in' type='checkbox'  checked><label for='section-4dc78485-a5ee-44cd-8ec2-9369def84d95' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>beta</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.6667</div><input id='attrs-a14c3f7e-001d-4d1f-89d7-e6e3c8e888bf' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a14c3f7e-001d-4d1f-89d7-e6e3c8e888bf' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4b68e304-0ea6-47fc-b419-7d4fad7c3a38' class='xr-var-data-in' type='checkbox'><label for='data-4b68e304-0ea6-47fc-b419-7d4fad7c3a38' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(0.66666667)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>volume</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>512.0</div><input id='attrs-98af6d5f-772d-421a-8a52-f096d8f766bc' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-98af6d5f-772d-421a-8a52-f096d8f766bc' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e9b4e580-2966-4a61-bd52-0da9d04d30a6' class='xr-var-data-in' type='checkbox'><label for='data-e9b4e580-2966-4a61-bd52-0da9d04d30a6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(512.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>n_0</span></div><div class='xr-var-dims'>(n_0)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4</div><input id='attrs-aa927bd7-7b43-4895-8f5c-b2c7992348da' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-aa927bd7-7b43-4895-8f5c-b2c7992348da' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-afd65e1f-c773-4e0f-8dc4-31bddcbaefcf' class='xr-var-data-in' type='checkbox'><label for='data-afd65e1f-c773-4e0f-8dc4-31bddcbaefcf' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>$n_0$</dd></dl></div><div class='xr-var-data'><pre>array([0, 1, 2, 3, 4])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-6e3b0957-714b-42c5-882f-82349003dcf1' class='xr-section-summary-in' type='checkbox'  ><label for='section-6e3b0957-714b-42c5-882f-82349003dcf1' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>n_0</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-bdd6f513-ff25-484e-8315-6202e6c2a91c' class='xr-index-data-in' type='checkbox'/><label for='index-bdd6f513-ff25-484e-8315-6202e6c2a91c' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Int64Index([0, 1, 2, 3, 4], dtype=&#x27;int64&#x27;, name=&#x27;n_0&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-0e0f94bf-3661-4e11-a894-2ccadb1bb979' class='xr-section-summary-in' type='checkbox'  checked><label for='section-0e0f94bf-3661-4e11-a894-2ccadb1bb979' class='xr-section-summary' >Attributes: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>dims_n :</span></dt><dd>[&#x27;n_0&#x27;]</dd><dt><span>dims_lnz :</span></dt><dd>[&#x27;lnz_0&#x27;]</dd><dt><span>dims_comp :</span></dt><dd>[&#x27;component&#x27;]</dd><dt><span>dims_state :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]</dd><dt><span>dims_rec :</span></dt><dd>[]</dd><dt><span>standard_name :</span></dt><dd>helmholtz_free_energy</dd><dt><span>long_name :</span></dt><dd>$\beta F({\bf n},V,T)$</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>Look at the documentation for all the properties available.  To quickly construct a dataset of multiple properties, use the <code class="docutils literal notranslate"><span class="pre">table</span></code> method.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">xce</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;pressure&quot;</span><span class="p">,</span> <span class="s2">&quot;betaF&quot;</span><span class="p">],</span> <span class="n">default_keys</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="n">ds</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:   (n_0: 436)
Coordinates:
    beta      float64 0.6667
    volume    float64 512.0
  * n_0       (n_0) int64 0 1 2 3 4 5 6 7 8 ... 428 429 430 431 432 433 434 435
Data variables:
    pressure  (n_0) float64 -0.0 0.001008 0.00319 0.005607 ... 5.786 5.854 5.893
    betaF     (n_0) float64 0.0 -6.238 -11.79 -16.94 ... -352.4 -348.7 -344.8
Attributes:
    long_name:  $p({\bf n},V,T)$</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-f54c5705-f36e-427f-bde2-319a39c64643' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-f54c5705-f36e-427f-bde2-319a39c64643' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>n_0</span>: 436</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-ff65555c-a2ae-450c-a1cd-723133af29a0' class='xr-section-summary-in' type='checkbox'  checked><label for='section-ff65555c-a2ae-450c-a1cd-723133af29a0' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>beta</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.6667</div><input id='attrs-c07c7c96-931d-40a2-8591-7fd37bda265f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-c07c7c96-931d-40a2-8591-7fd37bda265f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-98889c0a-8dc6-4234-9ecb-e79b0d5ae5db' class='xr-var-data-in' type='checkbox'><label for='data-98889c0a-8dc6-4234-9ecb-e79b0d5ae5db' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(0.66666667)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>volume</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>512.0</div><input id='attrs-22ec28c1-d6a2-41b9-a5ad-8ffe3814c881' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-22ec28c1-d6a2-41b9-a5ad-8ffe3814c881' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-40555215-d760-49ad-a444-14d02d5b01d4' class='xr-var-data-in' type='checkbox'><label for='data-40555215-d760-49ad-a444-14d02d5b01d4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(512.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>n_0</span></div><div class='xr-var-dims'>(n_0)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 2 3 4 5 ... 431 432 433 434 435</div><input id='attrs-79c2f696-7b87-4a4c-b7fe-5bbf0937830f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-79c2f696-7b87-4a4c-b7fe-5bbf0937830f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-6619b26a-462c-4e8c-b662-779ce6966f8e' class='xr-var-data-in' type='checkbox'><label for='data-6619b26a-462c-4e8c-b662-779ce6966f8e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>$n_0$</dd></dl></div><div class='xr-var-data'><pre>array([  0,   1,   2, ..., 433, 434, 435])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-f1adda68-b49b-4a92-bf24-a09798129684' class='xr-section-summary-in' type='checkbox'  checked><label for='section-f1adda68-b49b-4a92-bf24-a09798129684' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>pressure</span></div><div class='xr-var-dims'>(n_0)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-0.0 0.001008 ... 5.854 5.893</div><input id='attrs-8d3366af-6054-4ec0-8bfd-ca2c91f5421c' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-8d3366af-6054-4ec0-8bfd-ca2c91f5421c' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c6827410-1332-4718-bc19-6683402771e5' class='xr-var-data-in' type='checkbox'><label for='data-c6827410-1332-4718-bc19-6683402771e5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>$p({\bf n},V,T)$</dd></dl></div><div class='xr-var-data'><pre>array([-0.00000000e+00,  1.00795898e-03,  3.19042969e-03,  5.60727539e-03,
        8.13105469e-03,  1.07110840e-02,  1.33245117e-02,  1.59626221e-02,
        1.86035449e-02,  2.12531396e-02,  2.39138379e-02,  2.65724268e-02,
        2.92237793e-02,  3.18847852e-02,  3.45402539e-02,  3.71912988e-02,
        3.98437793e-02,  4.24513916e-02,  4.50499219e-02,  4.76741602e-02,
        5.02820508e-02,  5.28891064e-02,  5.55045117e-02,  5.80831055e-02,
        6.06579199e-02,  6.32146143e-02,  6.57673828e-02,  6.83276221e-02,
        7.08482520e-02,  7.33880127e-02,  7.59249902e-02,  7.84426318e-02,
        8.09484668e-02,  8.34514746e-02,  8.59810840e-02,  8.84699268e-02,
        9.09261328e-02,  9.33975293e-02,  9.58728223e-02,  9.83368213e-02,
        1.00797920e-01,  1.03231289e-01,  1.05678340e-01,  1.08122197e-01,
        1.10520381e-01,  1.12914243e-01,  1.15324980e-01,  1.17722622e-01,
        1.20133154e-01,  1.22532861e-01,  1.24934062e-01,  1.27297793e-01,
        1.29691787e-01,  1.32085884e-01,  1.34399619e-01,  1.36757651e-01,
        1.39123389e-01,  1.41462568e-01,  1.43806025e-01,  1.46144854e-01,
        1.48474775e-01,  1.50824722e-01,  1.53090674e-01,  1.55359731e-01,
        1.57746826e-01,  1.60114805e-01,  1.62430020e-01,  1.64709902e-01,
        1.67055029e-01,  1.69411143e-01,  1.71716338e-01,  1.73960508e-01,
        1.76163545e-01,  1.78509873e-01,  1.80828252e-01,  1.83095083e-01,
        1.85397539e-01,  1.87673262e-01,  1.89966621e-01,  1.92227944e-01,
...
        2.41144821e+00,  2.43941208e+00,  2.46474643e+00,  2.49182352e+00,
        2.52185649e+00,  2.55185917e+00,  2.58335501e+00,  2.61155211e+00,
        2.64050670e+00,  2.67121149e+00,  2.70174746e+00,  2.73371677e+00,
        2.76553628e+00,  2.79666366e+00,  2.82648006e+00,  2.85977036e+00,
        2.89344684e+00,  2.92455606e+00,  2.95870041e+00,  2.99367556e+00,
        3.02772368e+00,  3.06307060e+00,  3.09984945e+00,  3.13746029e+00,
        3.17279385e+00,  3.20745304e+00,  3.24353609e+00,  3.28000669e+00,
        3.31804157e+00,  3.35525206e+00,  3.39285756e+00,  3.43347425e+00,
        3.47512361e+00,  3.51374995e+00,  3.55369184e+00,  3.59754333e+00,
        3.63821462e+00,  3.67967000e+00,  3.72410434e+00,  3.76816885e+00,
        3.80753144e+00,  3.85033347e+00,  3.89739490e+00,  3.94103914e+00,
        3.98881466e+00,  4.03375941e+00,  4.07758450e+00,  4.12425794e+00,
        4.17009086e+00,  4.21737066e+00,  4.26946438e+00,  4.31971126e+00,
        4.36427285e+00,  4.41670709e+00,  4.46721311e+00,  4.51497176e+00,
        4.56795852e+00,  4.62053264e+00,  4.67139978e+00,  4.71933167e+00,
        4.77446846e+00,  4.83430838e+00,  4.88988394e+00,  4.94484867e+00,
        4.99826279e+00,  5.05576434e+00,  5.11593608e+00,  5.17409159e+00,
        5.23279714e+00,  5.29388224e+00,  5.35440210e+00,  5.41664957e+00,
        5.47422335e+00,  5.53065666e+00,  5.59730717e+00,  5.65966039e+00,
        5.72173746e+00,  5.78577560e+00,  5.85422369e+00,  5.89278464e+00])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>betaF</span></div><div class='xr-var-dims'>(n_0)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 -6.238 -11.79 ... -348.7 -344.8</div><input id='attrs-523e481b-9ae0-4c32-8012-dd3fa272131f' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-523e481b-9ae0-4c32-8012-dd3fa272131f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-63aaa9ed-0a23-4b72-87e0-9ea40d53ab76' class='xr-var-data-in' type='checkbox'><label for='data-63aaa9ed-0a23-4b72-87e0-9ea40d53ab76' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>dims_n :</span></dt><dd>[&#x27;n_0&#x27;]</dd><dt><span>dims_lnz :</span></dt><dd>[&#x27;lnz_0&#x27;]</dd><dt><span>dims_comp :</span></dt><dd>[&#x27;component&#x27;]</dd><dt><span>dims_state :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]</dd><dt><span>dims_rec :</span></dt><dd>[]</dd><dt><span>standard_name :</span></dt><dd>helmholtz_free_energy</dd><dt><span>long_name :</span></dt><dd>$\beta F({\bf n},V,T)$</dd></dl></div><div class='xr-var-data'><pre>array([   0.        ,   -6.23817948,  -11.78825896,  -16.93743845,
        -21.80391793,  -26.45169741,  -30.92217689,  -35.24305637,
        -39.43488586,  -43.51427534,  -47.49263482,  -51.3802843 ,
        -55.18540378,  -58.91534327,  -62.57494275,  -66.17037223,
        -69.70504171,  -73.18350119,  -76.61015068,  -79.98718016,
        -83.31692964,  -86.60257912,  -89.8454786 ,  -93.04802809,
        -96.21263757,  -99.34036705, -102.43368653, -105.49306601,
       -108.5203955 , -111.51717498, -114.48366446, -117.42170394,
       -120.33183342, -123.21554291, -126.07309239, -128.90524187,
       -131.71352135, -134.49843083, -137.26048032, -140.0003198 ,
       -142.71866928, -145.41596876, -148.09328824, -150.75033773,
       -153.38838721, -156.00779669, -158.60911617, -161.19235565,
       -163.75846514, -166.30706462, -168.8393841 , -171.35487358,
       -173.85522306, -176.33899255, -178.80819203, -181.26244151,
       -183.70210099, -186.12725047, -188.53863996, -190.93596944,
       -193.32005892, -195.6906584 , -198.04822788, -200.39366737,
       -202.72645685, -205.04623633, -207.35395581, -209.64960529,
       -211.93391478, -214.20585426, -216.46667374, -218.71597322,
       -220.9550527 , -223.18332219, -225.40031167, -227.60704115,
       -229.80326063, -231.98917011, -234.1650796 , -236.33078908,
...
       -517.57634594, -516.70443742, -515.8063279 , -514.88603639,
       -513.93637587, -512.95905135, -511.95257783, -510.91577731,
       -509.8561921 , -508.76502588, -507.64792636, -506.49973331,
       -505.32308209, -504.11578421, -502.88146288, -501.61907936,
       -500.32342584, -498.99915233, -497.64648581, -496.25981229,
       -494.84338477, -493.39481425, -491.91429574, -490.39921822,
       -488.8508627 , -487.27222118, -485.66168466, -484.01847615,
       -482.34284843, -480.63193791, -478.89023839, -477.11274027,
       -475.29930056, -473.44842984, -471.56710749, -469.6462433 ,
       -467.68825729, -465.6964695 , -463.66638676, -461.59751234,
       -459.49117603, -457.35434961, -455.17433569, -452.95667897,
       -450.70189785, -448.40261144, -446.07120492, -443.6974159 ,
       -441.28684118, -438.83551406, -436.34514405, -433.80612803,
       -431.23135871, -428.61769449, -425.95531147, -423.25743386,
       -420.51563787, -417.72985682, -414.90105215, -412.03128963,
       -409.12353928, -406.16320457, -403.15736475, -400.10615663,
       -397.01065581, -393.87252309, -390.68368018, -387.44808786,
       -384.16527904, -380.83505572, -377.4540159 , -374.02668999,
       -370.54602357, -367.02674195, -363.45618333, -359.83096831,
       -356.1615208 , -352.43810628, -348.66757176, -344.83638224])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-10639ff0-5f8f-4cd2-81b3-01a2c36abead' class='xr-section-summary-in' type='checkbox'  ><label for='section-10639ff0-5f8f-4cd2-81b3-01a2c36abead' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>n_0</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-f0118c51-4566-4a38-bd40-e3813002866a' class='xr-index-data-in' type='checkbox'/><label for='index-f0118c51-4566-4a38-bd40-e3813002866a' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Int64Index([  0,   1,   2,   3,   4,   5,   6,   7,   8,   9,
            ...
            426, 427, 428, 429, 430, 431, 432, 433, 434, 435],
           dtype=&#x27;int64&#x27;, name=&#x27;n_0&#x27;, length=436))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-e2e32245-d703-4227-afe8-37b4e83b6279' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e2e32245-d703-4227-afe8-37b4e83b6279' class='xr-section-summary' >Attributes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>long_name :</span></dt><dd>$p({\bf n},V,T)$</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>This can be easily converted to a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>beta</th>
      <th>volume</th>
      <th>pressure</th>
      <th>betaF</th>
    </tr>
    <tr>
      <th>n_0</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.666667</td>
      <td>512.0</td>
      <td>-0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.666667</td>
      <td>512.0</td>
      <td>0.001008</td>
      <td>-6.238179</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.666667</td>
      <td>512.0</td>
      <td>0.003190</td>
      <td>-11.788259</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.666667</td>
      <td>512.0</td>
      <td>0.005607</td>
      <td>-16.937438</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.666667</td>
      <td>512.0</td>
      <td>0.008131</td>
      <td>-21.803918</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>To access Grand Canonical properties, use the <code class="docutils literal notranslate"><span class="pre">xge</span></code> accessor</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ref</span><span class="o">.</span><span class="n">xge</span><span class="o">.</span><span class="n">pressure</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;pressure&#x27; ()&gt;
array(4.57687966)
Coordinates:
    lnz_0    float64 2.765
    beta     float64 0.6667
    volume   float64 512.0
Attributes:
    dims_n:      [&#x27;n_0&#x27;]
    dims_lnz:    [&#x27;lnz_0&#x27;]
    dims_comp:   [&#x27;component&#x27;]
    dims_state:  [&#x27;lnz_0&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]
    dims_rec:    []
    long_name:   $p(\mu,V,T)$</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'pressure'</div></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-e027433b-968e-4fc5-8656-0980fc7d0c32' class='xr-array-in' type='checkbox' checked><label for='section-e027433b-968e-4fc5-8656-0980fc7d0c32' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>4.577</span></div><div class='xr-array-data'><pre>array(4.57687966)</pre></div></div></li><li class='xr-section-item'><input id='section-7917bc2b-6304-469d-bfcc-5e110eef29bf' class='xr-section-summary-in' type='checkbox'  checked><label for='section-7917bc2b-6304-469d-bfcc-5e110eef29bf' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>lnz_0</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.765</div><input id='attrs-e614ec97-a96f-4e0b-a063-92405468dca9' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e614ec97-a96f-4e0b-a063-92405468dca9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c5d05a72-2b8e-441b-9b72-be219b76446f' class='xr-var-data-in' type='checkbox'><label for='data-c5d05a72-2b8e-441b-9b72-be219b76446f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(2.76512052)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>beta</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.6667</div><input id='attrs-1451f213-ca4c-402e-8951-f896b3b65997' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-1451f213-ca4c-402e-8951-f896b3b65997' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b8214f34-b89d-4feb-b507-dac06dcd8674' class='xr-var-data-in' type='checkbox'><label for='data-b8214f34-b89d-4feb-b507-dac06dcd8674' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(0.66666667)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>volume</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>512.0</div><input id='attrs-7eceab6a-bb06-4310-b668-10227fd4a4da' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7eceab6a-bb06-4310-b668-10227fd4a4da' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f7860b4b-46fc-49b8-b930-1925e20772be' class='xr-var-data-in' type='checkbox'><label for='data-f7860b4b-46fc-49b8-b930-1925e20772be' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(512.)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-5b982af1-88c9-4398-82a7-12cf25990490' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-5b982af1-88c9-4398-82a7-12cf25990490' class='xr-section-summary'  title='Expand/collapse section'>Indexes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'></ul></div></li><li class='xr-section-item'><input id='section-3cf684d3-cdb9-49bc-acc1-1661d3ad4921' class='xr-section-summary-in' type='checkbox'  checked><label for='section-3cf684d3-cdb9-49bc-acc1-1661d3ad4921' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>dims_n :</span></dt><dd>[&#x27;n_0&#x27;]</dd><dt><span>dims_lnz :</span></dt><dd>[&#x27;lnz_0&#x27;]</dd><dt><span>dims_comp :</span></dt><dd>[&#x27;component&#x27;]</dd><dt><span>dims_state :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]</dd><dt><span>dims_rec :</span></dt><dd>[]</dd><dt><span>long_name :</span></dt><dd>$p(\mu,V,T)$</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ref</span><span class="o">.</span><span class="n">xge</span><span class="o">.</span><span class="n">betaF</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;betaF&#x27; ()&gt;
array(-423.16867869)
Coordinates:
    lnz_0    float64 2.765
    beta     float64 0.6667
    volume   float64 512.0
Attributes:
    dims_n:         [&#x27;n_0&#x27;]
    dims_lnz:       [&#x27;lnz_0&#x27;]
    dims_comp:      [&#x27;component&#x27;]
    dims_state:     [&#x27;lnz_0&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]
    dims_rec:       []
    standard_name:  helmholtz_free_energy
    long_name:      $\beta F(\mu,V,T)$</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'betaF'</div></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-c9846e19-19e6-4dbc-a3a3-310e1b189adb' class='xr-array-in' type='checkbox' checked><label for='section-c9846e19-19e6-4dbc-a3a3-310e1b189adb' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>-423.2</span></div><div class='xr-array-data'><pre>array(-423.16867869)</pre></div></div></li><li class='xr-section-item'><input id='section-41925203-ce80-46c4-8871-df44b10a535a' class='xr-section-summary-in' type='checkbox'  checked><label for='section-41925203-ce80-46c4-8871-df44b10a535a' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>lnz_0</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.765</div><input id='attrs-fa87fc6c-cee3-4d37-9e13-f706276670d9' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-fa87fc6c-cee3-4d37-9e13-f706276670d9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3d6adae3-86ac-4169-9358-e968018a16c4' class='xr-var-data-in' type='checkbox'><label for='data-3d6adae3-86ac-4169-9358-e968018a16c4' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(2.76512052)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>beta</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.6667</div><input id='attrs-ff8c39b5-7119-4056-984a-4e4d3bacbc78' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ff8c39b5-7119-4056-984a-4e4d3bacbc78' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-834d785a-895f-4f2b-8a44-e89cddaf9d93' class='xr-var-data-in' type='checkbox'><label for='data-834d785a-895f-4f2b-8a44-e89cddaf9d93' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(0.66666667)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>volume</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>512.0</div><input id='attrs-fa79708a-5e09-4ccb-b1dd-00335b796a37' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-fa79708a-5e09-4ccb-b1dd-00335b796a37' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0aaee563-dd4e-41f5-bfd6-b744c0edec8d' class='xr-var-data-in' type='checkbox'><label for='data-0aaee563-dd4e-41f5-bfd6-b744c0edec8d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(512.)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-b7faedf8-a782-4640-9ae9-ca454832180d' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-b7faedf8-a782-4640-9ae9-ca454832180d' class='xr-section-summary'  title='Expand/collapse section'>Indexes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'></ul></div></li><li class='xr-section-item'><input id='section-3d452b4a-aad6-4322-9b8f-7b128250f796' class='xr-section-summary-in' type='checkbox'  checked><label for='section-3d452b4a-aad6-4322-9b8f-7b128250f796' class='xr-section-summary' >Attributes: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>dims_n :</span></dt><dd>[&#x27;n_0&#x27;]</dd><dt><span>dims_lnz :</span></dt><dd>[&#x27;lnz_0&#x27;]</dd><dt><span>dims_comp :</span></dt><dd>[&#x27;component&#x27;]</dd><dt><span>dims_state :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]</dd><dt><span>dims_rec :</span></dt><dd>[]</dd><dt><span>standard_name :</span></dt><dd>helmholtz_free_energy</dd><dt><span>long_name :</span></dt><dd>$\beta F(\mu,V,T)$</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>Or, to calculate multiple properties, again, use the <code class="docutils literal notranslate"><span class="pre">table</span></code> method</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ref</span><span class="o">.</span><span class="n">xge</span><span class="o">.</span><span class="n">table</span><span class="p">(</span><span class="n">keys</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;pressure&quot;</span><span class="p">,</span> <span class="s2">&quot;betaF&quot;</span><span class="p">],</span> <span class="n">default_keys</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:   ()
Coordinates:
    lnz_0     float64 2.765
    beta      float64 0.6667
    volume    float64 512.0
Data variables:
    pressure  float64 4.577
    betaF     float64 -423.2
Attributes:
    dims_n:      [&#x27;n_0&#x27;]
    dims_lnz:    [&#x27;lnz_0&#x27;]
    dims_comp:   [&#x27;component&#x27;]
    dims_state:  [&#x27;lnz_0&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]
    dims_rec:    []
    long_name:   $p(\mu,V,T)$</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-644c4ab2-4c27-4a49-a509-d54fce5faeea' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-644c4ab2-4c27-4a49-a509-d54fce5faeea' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-e24fe570-1638-4737-9013-1bec4597ab73' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e24fe570-1638-4737-9013-1bec4597ab73' class='xr-section-summary' >Coordinates: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>lnz_0</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.765</div><input id='attrs-10beab0f-0587-4fb4-ad7c-a587ce10cb89' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-10beab0f-0587-4fb4-ad7c-a587ce10cb89' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-491db82c-b999-461c-b44b-1295a73d8331' class='xr-var-data-in' type='checkbox'><label for='data-491db82c-b999-461c-b44b-1295a73d8331' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(2.76512052)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>beta</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.6667</div><input id='attrs-f268faf4-015d-409b-9c66-04e2980b0d63' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f268faf4-015d-409b-9c66-04e2980b0d63' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b977d4ad-fbe3-47f2-bb7d-dde50bdf72f5' class='xr-var-data-in' type='checkbox'><label for='data-b977d4ad-fbe3-47f2-bb7d-dde50bdf72f5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(0.66666667)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>volume</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>512.0</div><input id='attrs-68aa50b7-141f-47fc-ada2-cb90990c8957' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-68aa50b7-141f-47fc-ada2-cb90990c8957' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b47d6953-a919-4fb6-a144-0c36da8355ed' class='xr-var-data-in' type='checkbox'><label for='data-b47d6953-a919-4fb6-a144-0c36da8355ed' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(512.)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-1ee8a162-783c-48df-bdc4-bb8aa17574f1' class='xr-section-summary-in' type='checkbox'  checked><label for='section-1ee8a162-783c-48df-bdc4-bb8aa17574f1' class='xr-section-summary' >Data variables: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>pressure</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>4.577</div><input id='attrs-a9a1b861-b4b1-417f-a8ca-b22c6d0fc6be' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a9a1b861-b4b1-417f-a8ca-b22c6d0fc6be' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b8f2eb4c-8ec9-4d61-af44-2ed8cd4d4df1' class='xr-var-data-in' type='checkbox'><label for='data-b8f2eb4c-8ec9-4d61-af44-2ed8cd4d4df1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>dims_n :</span></dt><dd>[&#x27;n_0&#x27;]</dd><dt><span>dims_lnz :</span></dt><dd>[&#x27;lnz_0&#x27;]</dd><dt><span>dims_comp :</span></dt><dd>[&#x27;component&#x27;]</dd><dt><span>dims_state :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]</dd><dt><span>dims_rec :</span></dt><dd>[]</dd><dt><span>long_name :</span></dt><dd>$p(\mu,V,T)$</dd></dl></div><div class='xr-var-data'><pre>array(4.57687966)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>betaF</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-423.2</div><input id='attrs-a8a86966-426b-43bc-8481-37b393fc0ef8' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-a8a86966-426b-43bc-8481-37b393fc0ef8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ae6e8684-3197-4054-8942-d250a3106ced' class='xr-var-data-in' type='checkbox'><label for='data-ae6e8684-3197-4054-8942-d250a3106ced' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>dims_n :</span></dt><dd>[&#x27;n_0&#x27;]</dd><dt><span>dims_lnz :</span></dt><dd>[&#x27;lnz_0&#x27;]</dd><dt><span>dims_comp :</span></dt><dd>[&#x27;component&#x27;]</dd><dt><span>dims_state :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]</dd><dt><span>dims_rec :</span></dt><dd>[]</dd><dt><span>standard_name :</span></dt><dd>helmholtz_free_energy</dd><dt><span>long_name :</span></dt><dd>$\beta F(\mu,V,T)$</dd></dl></div><div class='xr-var-data'><pre>array(-423.16867869)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-e7abd439-6c82-41f1-82cc-9f2bc0f111af' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-e7abd439-6c82-41f1-82cc-9f2bc0f111af' class='xr-section-summary'  title='Expand/collapse section'>Indexes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'></ul></div></li><li class='xr-section-item'><input id='section-0db2df2a-8b20-4c8f-b01f-a8daac25f340' class='xr-section-summary-in' type='checkbox'  checked><label for='section-0db2df2a-8b20-4c8f-b01f-a8daac25f340' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>dims_n :</span></dt><dd>[&#x27;n_0&#x27;]</dd><dt><span>dims_lnz :</span></dt><dd>[&#x27;lnz_0&#x27;]</dd><dt><span>dims_comp :</span></dt><dd>[&#x27;component&#x27;]</dd><dt><span>dims_state :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]</dd><dt><span>dims_rec :</span></dt><dd>[]</dd><dt><span>long_name :</span></dt><dd>$p(\mu,V,T)$</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>The great thing about using the xarray interface is that things like plotting become trivial.  For example, use</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ref</span><span class="o">.</span><span class="n">xge</span><span class="o">.</span><span class="n">lnpi</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x1a5786770&gt;]
</pre></div>
</div>
<img alt="../_images/bc9dd6c8cb1a07ebfb90058b05d1eedc5b0243756d1e7a5cc9a1184be76e363b.png" src="../_images/bc9dd6c8cb1a07ebfb90058b05d1eedc5b0243756d1e7a5cc9a1184be76e363b.png" />
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="collections-of-lnpi-values">
<h1>Collections of lnPi Values<a class="headerlink" href="#collections-of-lnpi-values" title="Permalink to this heading">#</a></h1>
<p>Ok, we can reweight a <span class="math notranslate nohighlight">\(\ln \Pi(N)\)</span> from one chemical potential to another, and calculate a variety of properties for a <span class="math notranslate nohighlight">\(\ln \Pi(N)\)</span>.  But what if we want to calculate properties at a variety of values of <span class="math notranslate nohighlight">\(\ln z\)</span>.  We could do list comprehension, but that’s slow, and can get unwieldy.  Instead, <code class="docutils literal notranslate"><span class="pre">lnpy</span></code> provides a helper class to deal with multiple <code class="docutils literal notranslate"><span class="pre">lnPi</span></code>s.  To use it, we must first have a <a class="reference internal" href="../reference/generated/lnpy.segment.html#lnpy.segment.PhaseCreator" title="lnpy.segment.PhaseCreator"><code class="xref py py-class docutils literal notranslate"><span class="pre">PhaseCreator</span></code></a> object.  We will discuss this object in detail later, but for now, know that for the simple case of a single component system that does not have any phase transitions, it suffices to use the following.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">phase_creator</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">PhaseCreator</span><span class="p">(</span><span class="n">nmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="n">ref</span><span class="p">)</span>

<span class="n">build_phases</span> <span class="o">=</span> <span class="n">phase_creator</span><span class="o">.</span><span class="n">build_phases_mu</span><span class="p">([</span><span class="kc">None</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>To create a collection of with of <code class="docutils literal notranslate"><span class="pre">lnPi</span></code> at different values of <code class="docutils literal notranslate"><span class="pre">lnz</span></code>, use the <a class="reference internal" href="../reference/generated/lnpy.lnpiseries.html#lnpy.lnpiseries.lnPiCollection" title="lnpy.lnpiseries.lnPiCollection"><code class="xref py py-class docutils literal notranslate"><span class="pre">lnpy.lnpiseries.lnPiCollection</span></code></a> class:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">lnPiCollection</span><span class="o">.</span><span class="n">from_builder</span><span class="p">(</span>
    <span class="n">lnzs</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2000</span><span class="p">),</span> <span class="n">build_phases</span><span class="o">=</span><span class="n">build_phases</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "3ee44ec6696b4eb284b32a1feb952bca", "version_major": 2, "version_minor": 0}</script></div>
</div>
<p><a class="reference internal" href="../reference/generated/lnpy.lnpiseries.html#lnpy.lnpiseries.lnPiCollection" title="lnpy.lnpiseries.lnPiCollection"><code class="xref py py-class docutils literal notranslate"><span class="pre">lnPiCollection</span></code></a> is a wrapper around <code class="docutils literal notranslate"><span class="pre">pandas.Series</span></code>.  This provides an index for each <a class="reference internal" href="../reference/generated/lnpy.lnpidata.html#lnpy.lnpidata.lnPiMasked" title="lnpy.lnpidata.lnPiMasked"><code class="xref py py-class docutils literal notranslate"><span class="pre">lnPiMasked</span></code></a> instance.  This
allows some niceties like indexing by value, groupby, etc.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Select by postion</span>
<span class="c1"># scalar index gives object</span>
<span class="n">c</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;lnPi(lnz=[-9.99349675])&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># array-like gives lnPiCollection instance</span>
<span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">iloc</span><span class="p">[[</span><span class="mi">1</span><span class="p">]])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class lnPiCollection&gt;
lnz_0      phase
-9.993497  0        [-9.993496748374188]
dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># select by value.  Same as indexing into pandas.Series</span>
<span class="n">c</span><span class="o">.</span><span class="n">loc</span><span class="p">[[</span><span class="mf">3.0</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class lnPiCollection&gt;
lnz_0  phase
3.0    0        [3.0]
dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># can also query</span>
<span class="n">c</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;lnz_0 &gt; 2.95&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class lnPiCollection&gt;
lnz_0     phase
2.954477  0         [2.95447723861931]
2.960980  0        [2.960980490245122]
2.967484  0        [2.967483741870936]
2.973987  0        [2.973986993496748]
2.980490  0        [2.980490245122562]
2.986993  0        [2.986993496748374]
2.993497  0        [2.993496748374188]
3.000000  0                      [3.0]
dtype: object
</pre></div>
</div>
</div>
</div>
<section id="accessing-properties-of-collection">
<h2>Accessing properties of collection<a class="headerlink" href="#accessing-properties-of-collection" title="Permalink to this heading">#</a></h2>
<p>The really nice thing about <a class="reference internal" href="../reference/generated/lnpy.lnpiseries.html#lnpy.lnpiseries.lnPiCollection" title="lnpy.lnpiseries.lnPiCollection"><code class="xref py py-class docutils literal notranslate"><span class="pre">lnPiCollection</span></code></a> is that all the properties for <em>all</em> the <a class="reference internal" href="../reference/generated/lnpy.lnpidata.html#lnpy.lnpidata.lnPiMasked" title="lnpy.lnpidata.lnPiMasked"><code class="xref py py-class docutils literal notranslate"><span class="pre">lnPiMasked</span></code></a> objects can be calculated at once, in a vectorized way.  The same accessor <a class="reference internal" href="../reference/generated/lnpy.lnpiseries.html#lnpy.lnpiseries.lnPiCollection.xge" title="lnpy.lnpiseries.lnPiCollection.xge"><code class="xref py py-attr docutils literal notranslate"><span class="pre">xge</span></code></a> is available to <a class="reference internal" href="../reference/generated/lnpy.lnpiseries.html#lnpy.lnpiseries.lnPiCollection" title="lnpy.lnpiseries.lnPiCollection"><code class="xref py py-class docutils literal notranslate"><span class="pre">lnPiCollection</span></code></a> as for <a class="reference internal" href="../reference/generated/lnpy.lnpidata.html#lnpy.lnpidata.lnPiMasked" title="lnpy.lnpidata.lnPiMasked"><code class="xref py py-class docutils literal notranslate"><span class="pre">lnPiMasked</span></code></a>.  Note that the <code class="docutils literal notranslate"><span class="pre">xce</span></code> accessor is not available, as it only makes sense for a single value of <code class="docutils literal notranslate"><span class="pre">lnPiMasked</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Note the smart indexing.  The index is inherited from lnPiCollection.index</span>
<span class="n">c</span><span class="o">.</span><span class="n">xge</span><span class="o">.</span><span class="n">pressure</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "892de3457b9f44b5ba9e9413ff4167d1", "version_major": 2, "version_minor": 0}</script><div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;pressure&#x27; (lnz_0: 2000, phase: 1)&gt;
array([[6.80940123e-05],
       [6.85383141e-05],
       [6.89855151e-05],
       ...,
       [4.84631185e+00],
       [4.85425839e+00],
       [4.86220769e+00]])
Coordinates:
  * lnz_0    (lnz_0) float64 -10.0 -9.993 -9.987 -9.98 ... 2.98 2.987 2.993 3.0
  * phase    (phase) int64 0
    beta     float64 0.6667
    volume   float64 512.0
Attributes:
    dims_n:      [&#x27;n_0&#x27;]
    dims_lnz:    [&#x27;lnz_0&#x27;]
    dims_comp:   [&#x27;component&#x27;]
    dims_state:  [&#x27;lnz_0&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]
    dims_rec:    [&#x27;sample&#x27;]
    long_name:   $p(\mu,V,T)$</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'pressure'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>lnz_0</span>: 2000</li><li><span class='xr-has-index'>phase</span>: 1</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-0ec9e395-05b9-47d1-a1ef-a172323616bd' class='xr-array-in' type='checkbox' checked><label for='section-0ec9e395-05b9-47d1-a1ef-a172323616bd' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>6.809e-05 6.854e-05 6.899e-05 6.944e-05 ... 4.838 4.846 4.854 4.862</span></div><div class='xr-array-data'><pre>array([[6.80940123e-05],
       [6.85383141e-05],
       [6.89855151e-05],
       ...,
       [4.84631185e+00],
       [4.85425839e+00],
       [4.86220769e+00]])</pre></div></div></li><li class='xr-section-item'><input id='section-725cbcf6-7a39-4150-a431-c72a075358d3' class='xr-section-summary-in' type='checkbox'  checked><label for='section-725cbcf6-7a39-4150-a431-c72a075358d3' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lnz_0</span></div><div class='xr-var-dims'>(lnz_0)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-10.0 -9.993 -9.987 ... 2.993 3.0</div><input id='attrs-478c9477-7fe8-496a-83db-999a34966580' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-478c9477-7fe8-496a-83db-999a34966580' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f4be2094-ca12-48ca-bdc4-13d8e0d7b055' class='xr-var-data-in' type='checkbox'><label for='data-f4be2094-ca12-48ca-bdc4-13d8e0d7b055' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-10.      ,  -9.993497,  -9.986993, ...,   2.986993,   2.993497,
         3.      ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>phase</span></div><div class='xr-var-dims'>(phase)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-7d280b1c-a5ef-47f5-80e7-ba89cfa59cbe' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-7d280b1c-a5ef-47f5-80e7-ba89cfa59cbe' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-0387d0d5-d5bc-4b0f-b458-37443628eb04' class='xr-var-data-in' type='checkbox'><label for='data-0387d0d5-d5bc-4b0f-b458-37443628eb04' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>beta</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.6667</div><input id='attrs-3abc31a5-ae48-467c-912f-050039d953eb' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-3abc31a5-ae48-467c-912f-050039d953eb' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-1458da22-196a-4d30-baef-82d5bda5c414' class='xr-var-data-in' type='checkbox'><label for='data-1458da22-196a-4d30-baef-82d5bda5c414' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(0.66666667)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>volume</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>512.0</div><input id='attrs-53fc8438-dda1-4705-8fd1-9c2277064b39' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-53fc8438-dda1-4705-8fd1-9c2277064b39' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-16a38247-04c2-4e0f-b13c-ee9273b3c2c1' class='xr-var-data-in' type='checkbox'><label for='data-16a38247-04c2-4e0f-b13c-ee9273b3c2c1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(512.)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-ea26ffb3-9408-4e2a-b33c-eff0cdd5f71b' class='xr-section-summary-in' type='checkbox'  ><label for='section-ea26ffb3-9408-4e2a-b33c-eff0cdd5f71b' class='xr-section-summary' >Indexes: <span>(2)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lnz_0</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-71c12cbb-b2cd-4b7b-85e9-9378fede5847' class='xr-index-data-in' type='checkbox'/><label for='index-71c12cbb-b2cd-4b7b-85e9-9378fede5847' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([             -10.0, -9.993496748374188, -9.986993496748374,
              -9.980490245122562, -9.973986993496748, -9.967483741870936,
              -9.960980490245122,  -9.95447723861931, -9.947973986993496,
              -9.941470735367684,
              ...
               2.941470735367684, 2.9479739869934978,   2.95447723861931,
               2.960980490245122,  2.967483741870936,  2.973986993496748,
               2.980490245122562,  2.986993496748374,  2.993496748374188,
                             3.0],
             dtype=&#x27;float64&#x27;, name=&#x27;lnz_0&#x27;, length=2000))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>phase</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-e46715d8-5daf-455e-8d1f-cf1aa82b35df' class='xr-index-data-in' type='checkbox'/><label for='index-e46715d8-5daf-455e-8d1f-cf1aa82b35df' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Int64Index([0], dtype=&#x27;int64&#x27;, name=&#x27;phase&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-20dc4890-6c79-45ab-bcf1-e1fbe9fe5dee' class='xr-section-summary-in' type='checkbox'  checked><label for='section-20dc4890-6c79-45ab-bcf1-e1fbe9fe5dee' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>dims_n :</span></dt><dd>[&#x27;n_0&#x27;]</dd><dt><span>dims_lnz :</span></dt><dd>[&#x27;lnz_0&#x27;]</dd><dt><span>dims_comp :</span></dt><dd>[&#x27;component&#x27;]</dd><dt><span>dims_state :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]</dd><dt><span>dims_rec :</span></dt><dd>[&#x27;sample&#x27;]</dd><dt><span>long_name :</span></dt><dd>$p(\mu,V,T)$</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot the results</span>
<span class="n">c</span><span class="o">.</span><span class="n">xge</span><span class="o">.</span><span class="n">pressure</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x1a58f80d0&gt;]
</pre></div>
</div>
<img alt="../_images/7dd25e53087497df3e5a97e1803f031a3c73572acce21970510f89b11f448aff.png" src="../_images/7dd25e53087497df3e5a97e1803f031a3c73572acce21970510f89b11f448aff.png" />
</div>
</div>
<p>This is much more convenient (and much faster) than doing something like:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Don&#39;t do things like this</span>
<span class="c1"># It&#39;s super slow</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>

<span class="n">pressures</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">xge</span><span class="o">.</span><span class="n">pressure</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">c</span><span class="p">]</span>

<span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">pressures</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s2">&quot;lnz_0&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x1a5f362f0&gt;]
</pre></div>
</div>
<img alt="../_images/bf037a5314493b301bdb41015b5e5dd2c9f726792f400db80b9ff47a534144ac.png" src="../_images/bf037a5314493b301bdb41015b5e5dd2c9f726792f400db80b9ff47a534144ac.png" />
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="loading-examples">
<h1>Loading examples<a class="headerlink" href="#loading-examples" title="Permalink to this heading">#</a></h1>
<p>lnPi comes with some pre-defined examples in the <a class="reference internal" href="../reference/generated/lnpy.examples.html#module-lnpy.examples" title="lnpy.examples"><code class="xref py py-mod docutils literal notranslate"><span class="pre">examples</span></code></a> module.  We used it above to load a dictionary of data that we then turned into a <a class="reference internal" href="../reference/generated/lnpy.lnpidata.html#lnpy.lnpidata.lnPiMasked" title="lnpy.lnpidata.lnPiMasked"><code class="xref py py-class docutils literal notranslate"><span class="pre">lnPiMasked</span></code></a> object.  This can be streamlined using the following:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">lnpy.examples</span>

<span class="n">ref</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="n">load_example_maskddata</span><span class="p">(</span><span class="s2">&quot;lj_sup&quot;</span><span class="p">)</span>
<span class="n">ref</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;lnPi(lnz=[2.76512052])&gt;
</pre></div>
</div>
</div>
</div>
<p>Alternatively, for some examples, you can load an object with contains a predefined <a class="reference internal" href="../reference/generated/lnpy.segment.html#lnpy.segment.PhaseCreator" title="lnpy.segment.PhaseCreator"><code class="xref py py-class docutils literal notranslate"><span class="pre">PhaseCreator</span></code></a> object.  We’ll save this for later.</p>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="single-component-system-with-phase-transitions">
<h1>Single component system with phase transitions.<a class="headerlink" href="#single-component-system-with-phase-transitions" title="Permalink to this heading">#</a></h1>
<p>Next, let’s consider a system with a phase transition. First, lets load some example data</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">lnpy</span>
<span class="kn">import</span> <span class="nn">lnpy.examples</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>

<span class="c1"># Subcritical LJ data</span>
<span class="n">ref</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="n">load_example_maskddata</span><span class="p">(</span><span class="s2">&quot;lj_sub&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># look at the lnPi values</span>
<span class="n">ref</span><span class="o">.</span><span class="n">xge</span><span class="o">.</span><span class="n">lnpi</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x1a66d5180&gt;]
</pre></div>
</div>
<img alt="../_images/14bfb7af060841d1ffabb0eeb5fbaa04f802e4e4190838ec6ad19114c7c8b6a5.png" src="../_images/14bfb7af060841d1ffabb0eeb5fbaa04f802e4e4190838ec6ad19114c7c8b6a5.png" />
</div>
</div>
<p>Notice that this <span class="math notranslate nohighlight">\(\ln \Pi(N)\)</span> has multiple maxima.  This indicates that multiple phases coexist.<br />
So calculating properties from the total <a class="reference internal" href="../reference/generated/lnpy.lnpidata.html#lnpy.lnpidata.lnPiMasked" title="lnpy.lnpidata.lnPiMasked"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lnPiMasked</span></code></a> doesn’t make sense.  Instead, the <a class="reference internal" href="../reference/generated/lnpy.lnpidata.html#lnpy.lnpidata.lnPiMasked" title="lnpy.lnpidata.lnPiMasked"><code class="xref py py-class docutils literal notranslate"><span class="pre">lnPiMasked</span></code></a> should be divided into phases.  The division should be at the local minima in <span class="math notranslate nohighlight">\(\ln \Pi(N)\)</span> (at approximately <code class="docutils literal notranslate"><span class="pre">n_0=100</span></code> in the example above).  To perform the segmentation, we turn back to the <a class="reference internal" href="../reference/generated/lnpy.segment.html#lnpy.segment.PhaseCreator" title="lnpy.segment.PhaseCreator"><code class="xref py py-class docutils literal notranslate"><span class="pre">PhaseCreator</span></code></a> object.  Let see how this works</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># This creates a `PhaseCreator` object</span>
<span class="n">phase_creator</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">PhaseCreator</span><span class="p">(</span><span class="n">nmax</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nmax_peak</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="n">ref</span><span class="p">,</span> <span class="n">merge_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;efac&quot;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># call the `build_phases` method creates a lnPiCollection of phases</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">phase_creator</span><span class="o">.</span><span class="n">build_phases</span><span class="p">()</span>
<span class="n">p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class lnPiCollection&gt;
lnz_0      phase
-3.609956  0        [-3.6099564097351307]
           1        [-3.6099564097351307]
dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># plot the lnpi values for each &#39;phase&#39;</span>
<span class="n">p</span><span class="o">.</span><span class="n">xge</span><span class="o">.</span><span class="n">lnpi</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hue</span><span class="o">=</span><span class="s2">&quot;lnz_0&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x1a6778fa0&gt;,
 &lt;matplotlib.lines.Line2D at 0x1a67791e0&gt;]
</pre></div>
</div>
<img alt="../_images/8abce97563f2d71372272f5e36d498d4ea3ef9def384b93687efda52bf91d486.png" src="../_images/8abce97563f2d71372272f5e36d498d4ea3ef9def384b93687efda52bf91d486.png" />
</div>
</div>
<p>What just happened?  To segment <span class="math notranslate nohighlight">\(\ln \Pi(N)\)</span> the code does the following:, we   For this we do the following</p>
<ol class="arabic simple">
<li><p>Find the local maxima of the <span class="math notranslate nohighlight">\(\ln \Pi(N)\)</span>.  This is done using <a class="reference internal" href="../reference/generated/lnpy.segment.html#lnpy.segment.peak_local_max_adaptive" title="lnpy.segment.peak_local_max_adaptive"><code class="xref py py-func docutils literal notranslate"><span class="pre">peak_local_max_adaptive()</span></code></a>, which is an an adaptive version of <a class="reference external" href="https://scikit-image.org/docs/stable/api/skimage.feature.html#skimage.feature.peak_local_max" title="(in skimage v0.20.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">skimage.feature.peak_local_max()</span></code></a>.  This finds at most <code class="docutils literal notranslate"><span class="pre">nmax_peak</span></code>.  Note that <code class="docutils literal notranslate"><span class="pre">nmax_peak</span></code> can be any number.</p></li>
<li><p>Use the <a class="reference external" href="https://scikit-image.org/docs/stable/api/skimage.segmentation.html#skimage.segmentation.watershed" title="(in skimage v0.20.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">watershed()</span></code></a> segmentation algorithm to segment <span class="math notranslate nohighlight">\(-\ln \Pi\)</span> into regions about the local minima in <span class="math notranslate nohighlight">\(-\ln \Pi\)</span> (local maxima in <span class="math notranslate nohighlight">\(\ln \Pi\)</span>).</p></li>
<li><p>Remove any phases that have to low a transition energy.  We discuss this further below.</p></li>
<li><p>If the number of ‘phases’ is greater than the maximum allowed number of phases.  Merge them.  This is done by analyzing the transition energy between phases.  Discussed further below.</p></li>
<li><p>Merge phases that have same <code class="docutils literal notranslate"><span class="pre">phase_id</span></code>.  Discussed further below.</p></li>
<li><p>Pass list of <a class="reference internal" href="../reference/generated/lnpy.lnpidata.html#lnpy.lnpidata.lnPiMasked" title="lnpy.lnpidata.lnPiMasked"><code class="xref py py-class docutils literal notranslate"><span class="pre">lnPiMasked</span></code></a> objects and created <code class="docutils literal notranslate"><span class="pre">index</span></code> to <code class="docutils literal notranslate"><span class="pre">phases_factory</span></code> function. Discussed further below.</p></li>
<li><p>return result</p></li>
</ol>
<p>OK, that’s a bunch of steps.  Let take them one at a time.</p>
<section id="local-maxima">
<h2>Local maxima<a class="headerlink" href="#local-maxima" title="Permalink to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">maxima_marker</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">segment</span><span class="o">.</span><span class="n">peak_local_max_adaptive</span><span class="p">(</span>
    <span class="n">ref</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">num_peaks_max</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">mask</span><span class="o">=~</span><span class="n">ref</span><span class="o">.</span><span class="n">mask</span><span class="p">,</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;marker&quot;</span>
<span class="p">)</span>
<span class="n">maxima_index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">maxima_marker</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">ref</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">maxima_index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ref</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">maxima_index</span><span class="p">],</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;None&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x1a62da770&gt;]
</pre></div>
</div>
<img alt="../_images/d6e346091d50ad89fddd69642a4858ba75d0cb5df07eba99709f5ef29493a14e.png" src="../_images/d6e346091d50ad89fddd69642a4858ba75d0cb5df07eba99709f5ef29493a14e.png" />
</div>
</div>
</section>
<section id="watershed">
<h2>Watershed<a class="headerlink" href="#watershed" title="Permalink to this heading">#</a></h2>
<p>OK, great.  Now we can segment the data. <code class="docutils literal notranslate"><span class="pre">lnPi</span></code> provides a wrapper to <a class="reference external" href="https://scikit-image.org/docs/stable/api/skimage.segmentation.html#skimage.segmentation.watershed" title="(in skimage v0.20.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">skimage.segmentation.watershed()</span></code></a> through <a class="reference internal" href="../reference/generated/lnpy.segment.html#lnpy.segment.Segmenter.watershed" title="lnpy.segment.Segmenter.watershed"><code class="xref py py-meth docutils literal notranslate"><span class="pre">lnpy.segment.Segmenter.watershed()</span></code></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">s</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">segment</span><span class="o">.</span><span class="n">Segmenter</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">labels</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">watershed</span><span class="p">(</span><span class="o">-</span><span class="n">ref</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">markers</span><span class="o">=</span><span class="n">maxima_marker</span><span class="p">,</span> <span class="n">mask</span><span class="o">=~</span><span class="n">ref</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span>
<span class="n">labels</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2,
       2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2], dtype=int32)
</pre></div>
</div>
</div>
</div>
<p>Each unique value in <code class="docutils literal notranslate"><span class="pre">labels</span></code> corresponds to a phase.  We can construct multiple <code class="docutils literal notranslate"><span class="pre">lnPiMasked</span></code> objects from labels using</p>
</section>
<section id="local-free-energy">
<h2>local free energy<a class="headerlink" href="#local-free-energy" title="Permalink to this heading">#</a></h2>
<p>Now, we look at the local free energy.  The local (scaled) free energy is defined as <span class="math notranslate nohighlight">\(w(N) = \beta f(N) = -\ln \Pi(N)\)</span>. We consider the energy at the location of the local minima in <span class="math notranslate nohighlight">\(w\)</span> (local maxima in <span class="math notranslate nohighlight">\(\ln \Pi\)</span>) versus the value of <span class="math notranslate nohighlight">\(w\)</span> at the transition between phases (around <span class="math notranslate nohighlight">\(n=100\)</span> in the figure above).  This is performed by the class <a class="reference internal" href="../reference/generated/lnpy.lnpienergy.html#lnpy.lnpienergy.wFreeEnergy" title="lnpy.lnpienergy.wFreeEnergy"><code class="xref py py-class docutils literal notranslate"><span class="pre">lnpy.lnpienergy.wFreeEnergy</span></code></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">lnpy.lnpienergy</span> <span class="kn">import</span> <span class="n">wFreeEnergy</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">w</span> <span class="o">=</span> <span class="n">wFreeEnergy</span><span class="o">.</span><span class="n">from_labels</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">ref</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># this is the same as -lnPi[maxima]</span>
<span class="n">w</span><span class="o">.</span><span class="n">w_min</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[126.12754742],
       [ -0.        ]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">ref</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">maxima_index</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([126.12754742,  -0.        ])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># w.w_tran[i, j] is the &#39;transition&#39; energy going from phase i to phase j</span>
<span class="n">w</span><span class="o">.</span><span class="n">w_tran</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[         inf, 132.72931142],
       [132.72931142,          inf]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># the transition between phases &#39;0&#39; and &#39;1&#39; is at index 87</span>
<span class="n">w</span><span class="o">.</span><span class="n">w_argtran</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{(0, 1): (87,)}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">-</span><span class="n">ref</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">87</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>132.72931142169
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># the change in energy between the phases</span>
<span class="n">w</span><span class="o">.</span><span class="n">delta_w</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([[         inf,   6.601764  ],
       [132.72931142,          inf]])
</pre></div>
</div>
</div>
</div>
<p>This transition energy means the two phases are stable.  So move on.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lnpis</span> <span class="o">=</span> <span class="n">ref</span><span class="o">.</span><span class="n">list_from_masks</span><span class="p">(</span><span class="n">w</span><span class="o">.</span><span class="n">masks</span><span class="p">)</span>
<span class="n">lnpis</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;lnPi(lnz=[-3.60995641])&gt;, &lt;lnPi(lnz=[-3.60995641])&gt;]
</pre></div>
</div>
</div>
</div>
</section>
<section id="construct-collection">
<h2>Construct collection<a class="headerlink" href="#construct-collection" title="Permalink to this heading">#</a></h2>
<p>Now these can be converted to a <a class="reference internal" href="../reference/generated/lnpy.lnpiseries.html#lnpy.lnpiseries.lnPiCollection" title="lnpy.lnpiseries.lnPiCollection"><code class="xref py py-class docutils literal notranslate"><span class="pre">lnPiCollection</span></code></a> object.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">lnPiCollection</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="n">lnpis</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class lnPiCollection&gt;
lnz_0      phase
-3.609956  0        [-3.6099564097351307]
           1        [-3.6099564097351307]
dtype: object
</pre></div>
</div>
</div>
</div>
<p>So, the segmentation can get pretty involved.  This is why there is the helper class <a class="reference internal" href="../reference/generated/lnpy.segment.html#lnpy.segment.PhaseCreator" title="lnpy.segment.PhaseCreator"><code class="xref py py-class docutils literal notranslate"><span class="pre">PhaseCreator</span></code></a>. There are a slew
of options to the different routines.  Look at the docs for more information</p>
</section>
<section id="at-a-different-ln-z-value">
<h2>At a different <span class="math notranslate nohighlight">\(\ln z\)</span> value<a class="headerlink" href="#at-a-different-ln-z-value" title="Permalink to this heading">#</a></h2>
<p>Let us instead consider a different value of chemical potential. One near the critical point.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">phase_creator</span><span class="o">.</span><span class="n">build_phases</span><span class="p">(</span><span class="o">-</span><span class="mf">3.49</span><span class="p">)</span>
<span class="n">p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class lnPiCollection&gt;
lnz_0  phase
-3.49  0        [-3.49]
       1        [-3.49]
dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span><span class="o">.</span><span class="n">xge</span><span class="o">.</span><span class="n">lnpi</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hue</span><span class="o">=</span><span class="s2">&quot;phase&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x1a66eeb60&gt;,
 &lt;matplotlib.lines.Line2D at 0x1a66eeb00&gt;]
</pre></div>
</div>
<img alt="../_images/5b06175949dc37bb17a4ecc956f6f627ac10ebd02dce5ebc26fd0f301358c0e4.png" src="../_images/5b06175949dc37bb17a4ecc956f6f627ac10ebd02dce5ebc26fd0f301358c0e4.png" />
</div>
</div>
<p>But lets look at the local free energy ‘w’ defined above.  This can be obtained by the accessor <a class="reference internal" href="../reference/generated/lnpy.lnpiseries.html#lnpy.lnpiseries.lnPiCollection.wfe" title="lnpy.lnpiseries.lnPiCollection.wfe"><code class="xref py py-attr docutils literal notranslate"><span class="pre">wfe</span></code></a> in <a class="reference internal" href="../reference/generated/lnpy.lnpiseries.html#lnpy.lnpiseries.lnPiCollection" title="lnpy.lnpiseries.lnPiCollection"><code class="xref py py-class docutils literal notranslate"><span class="pre">lnPiCollection</span></code></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># min(w) in each phase</span>
<span class="n">p</span><span class="o">.</span><span class="n">wfe</span><span class="o">.</span><span class="n">w_min</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>lnz_0  phase
-3.49  0        122.930891
       1        -45.776165
Name: w_min, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># transition w from phase to phase_nebr</span>
<span class="n">p</span><span class="o">.</span><span class="n">wfe</span><span class="o">.</span><span class="n">w_tran</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>lnz_0  phase  phase_nebr
-3.49  0      0                    inf
              1             123.785912
       1      0             123.785912
              1                    inf
Name: w_tran, dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># w_tran - w_min</span>
<span class="n">p</span><span class="o">.</span><span class="n">wfe</span><span class="o">.</span><span class="n">dw</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>lnz_0  phase  phase_nebr
-3.49  0      0                    inf
              1               0.855021
       1      0             169.562078
              1                    inf
Name: delta_w, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>We see that the <span class="math notranslate nohighlight">\(\Delta w\)</span> is pretty low at this value of <span class="math notranslate nohighlight">\(\ln z\)</span>.  We passed in the parameter <code class="docutils literal notranslate"><span class="pre">efac=0.8</span></code> in the definition of <code class="docutils literal notranslate"><span class="pre">phase_creator</span></code>.  If we instead wish to remove phases with an energy this low, we can do the following:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="n">phase_creator</span><span class="o">.</span><span class="n">build_phases</span><span class="p">(</span><span class="o">-</span><span class="mf">3.49</span><span class="p">,</span> <span class="n">efac</span><span class="o">=</span><span class="mf">0.9</span><span class="p">)</span>
<span class="n">p</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class lnPiCollection&gt;
lnz_0  phase
-3.49  0        [-3.49]
dtype: object
</pre></div>
</div>
</div>
</div>
<p>Now if the <span class="math notranslate nohighlight">\(\Delta w\)</span> between phases is smaller than <code class="docutils literal notranslate"><span class="pre">efac</span></code>, the phases are merged.  For more information, see that api docs.</p>
</section>
<section id="tagging-phases">
<h2>Tagging phases<a class="headerlink" href="#tagging-phases" title="Permalink to this heading">#</a></h2>
<p><a class="reference internal" href="../reference/generated/lnpy.segment.html#lnpy.segment.PhaseCreator" title="lnpy.segment.PhaseCreator"><code class="xref py py-class docutils literal notranslate"><span class="pre">PhaseCreator</span></code></a> allows passing a callback <code class="docutils literal notranslate"><span class="pre">tag_phases</span></code> to attach a label to each phase.  By default, the phases are labeled by there list index.  This can be confusing, because over a range of <span class="math notranslate nohighlight">\(\ln z\)</span> values, different physical phases can have the same label.  For example</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">phase_creator</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">PhaseCreator</span><span class="p">(</span><span class="n">nmax</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nmax_peak</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="n">ref</span><span class="p">,</span> <span class="n">merge_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;efac&quot;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">})</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">lnPiCollection</span><span class="o">.</span><span class="n">from_builder</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="n">build_phases</span><span class="o">=</span><span class="n">phase_creator</span><span class="o">.</span><span class="n">build_phases</span>
<span class="p">)</span>

<span class="c1"># this looks weird because have multiple phases and not sure which is which</span>
<span class="n">c</span><span class="o">.</span><span class="n">xge</span><span class="o">.</span><span class="n">pressure</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hue</span><span class="o">=</span><span class="s2">&quot;phase&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x1a695beb0&gt;,
 &lt;matplotlib.lines.Line2D at 0x1a695bf10&gt;]
</pre></div>
</div>
<img alt="../_images/e872852122badafe85561c4a1577ab6a8cca3bd8c3bdaa12bade32f28034f5d0.png" src="../_images/e872852122badafe85561c4a1577ab6a8cca3bd8c3bdaa12bade32f28034f5d0.png" />
</div>
</div>
<p>Note that this can be fixed by considering ‘stable’ phases only</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">(</span>
    <span class="n">c</span><span class="o">.</span><span class="n">xge</span><span class="o">.</span><span class="n">table</span><span class="p">([</span><span class="s2">&quot;mask_stable&quot;</span><span class="p">,</span> <span class="s2">&quot;pressure&quot;</span><span class="p">],</span> <span class="n">default_keys</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
    <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">pressure_stable</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;pressure&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="s2">&quot;mask_stable&quot;</span><span class="p">]))</span>
    <span class="o">.</span><span class="n">pressure_stable</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="s2">&quot;phase&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">plot</span><span class="p">()</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x1a69354e0&gt;]
</pre></div>
</div>
<img alt="../_images/d114311c3d72889736b0f1ce965366c2f0c366f848f2aea00b330decdc5f5ddc.png" src="../_images/d114311c3d72889736b0f1ce965366c2f0c366f848f2aea00b330decdc5f5ddc.png" />
</div>
</div>
<p>There are two clear phases here.  It would be beneficial to label the liquid and vapor phases differently.
So we define the callback tag_phases</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">tag_phases</span><span class="p">(</span><span class="n">list_of_phases</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Simple tag_phases callback</span>

<span class="sd">    This looks at the local maximum of each lnPiMasked object.</span>

<span class="sd">    If location of maximum &lt; len(data)/2 -&gt; phase = 0</span>
<span class="sd">    else -&gt; phase = 1</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_of_phases</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;bad tag function&quot;</span><span class="p">)</span>
    <span class="n">argmax0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">xx</span><span class="o">.</span><span class="n">local_argmax</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">xx</span> <span class="ow">in</span> <span class="n">list_of_phases</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">argmax0</span> <span class="o">&lt;=</span> <span class="n">list_of_phases</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">phase_creator</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">PhaseCreator</span><span class="p">(</span>
    <span class="n">nmax</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nmax_peak</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="n">ref</span><span class="p">,</span> <span class="n">merge_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;efac&quot;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">},</span> <span class="n">tag_phases</span><span class="o">=</span><span class="n">tag_phases</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">lnPiCollection</span><span class="o">.</span><span class="n">from_builder</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="n">build_phases</span><span class="o">=</span><span class="n">phase_creator</span><span class="o">.</span><span class="n">build_phases</span>
<span class="p">)</span>

<span class="n">c</span><span class="o">.</span><span class="n">xge</span><span class="o">.</span><span class="n">pressure</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hue</span><span class="o">=</span><span class="s2">&quot;phase&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x1a632e2f0&gt;,
 &lt;matplotlib.lines.Line2D at 0x1a632e350&gt;]
</pre></div>
</div>
<img alt="../_images/fbb1e2aa53b9585a06450bd53e4635e02a420b50117e62746a33ec6ee46164a6.png" src="../_images/fbb1e2aa53b9585a06450bd53e4635e02a420b50117e62746a33ec6ee46164a6.png" />
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="calculation-binodal-and-spinodal">
<h1>Calculation Binodal and spinodal<a class="headerlink" href="#calculation-binodal-and-spinodal" title="Permalink to this heading">#</a></h1>
<p>The binodal and spinodal can be found using the <a class="reference internal" href="../reference/generated/lnpy.stability.html#module-lnpy.stability" title="lnpy.stability"><code class="xref py py-mod docutils literal notranslate"><span class="pre">lnpy.stability</span></code></a> module.  This module adds accessors to <a class="reference internal" href="../reference/generated/lnpy.lnpiseries.html#lnpy.lnpiseries.lnPiCollection" title="lnpy.lnpiseries.lnPiCollection"><code class="xref py py-class docutils literal notranslate"><span class="pre">lnPiCollection</span></code></a> class.  A collection is needed to provide a decent guess for the location of the binodal and spinodal.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># must import stability to add the accessors to lnPiCollection</span>
<span class="kn">import</span> <span class="nn">lnpy.stability</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">lnpy</span>
<span class="kn">import</span> <span class="nn">lnpy.examples</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>

<span class="c1"># Subcritical LJ data</span>
<span class="n">ref</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="n">load_example_maskddata</span><span class="p">(</span><span class="s2">&quot;lj_sub&quot;</span><span class="p">)</span>

<span class="n">phase_creator</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">PhaseCreator</span><span class="p">(</span>
    <span class="n">nmax</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nmax_peak</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="n">ref</span><span class="p">,</span> <span class="n">merge_kws</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;efac&quot;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">},</span> <span class="n">tag_phases</span><span class="o">=</span><span class="n">tag_phases</span>
<span class="p">)</span>

<span class="c1"># Here we need a scalar builder object.</span>
<span class="n">build_phases</span> <span class="o">=</span> <span class="n">phase_creator</span><span class="o">.</span><span class="n">build_phases_mu</span><span class="p">([</span><span class="kc">None</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># initial guess</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">lnPiCollection</span><span class="o">.</span><span class="n">from_builder</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">build_phases</span><span class="o">=</span><span class="n">phase_creator</span><span class="o">.</span><span class="n">build_phases_mu</span><span class="p">([</span><span class="kc">None</span><span class="p">])</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>The spinodal is calculates as the location where <span class="math notranslate nohighlight">\(\Delta w\)</span> equals some value.  Lets say we want to define the spinodal
as the location where <span class="math notranslate nohighlight">\(\Delta w = 1.0\)</span>.  We do the following:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">spinodal</span><span class="p">(</span>
    <span class="n">phase_ids</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span>  <span class="c1"># the id&#39;s of the phases we&#39;re considering</span>
    <span class="n">build_phases</span><span class="o">=</span><span class="n">phase_creator</span><span class="o">.</span><span class="n">build_phases_mu</span><span class="p">([</span><span class="kc">None</span><span class="p">]),</span>
    <span class="c1"># this is the efac parameter for</span>
    <span class="n">build_kws</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">efac</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span>
    <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">as_dict</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="n">efac</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># to access the data as a collection, use the `access` attribute</span>
<span class="n">c</span><span class="o">.</span><span class="n">spinodal</span><span class="o">.</span><span class="n">access</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class lnPiCollection&gt;
spinodal  lnz_0      phase
0         -3.494734  0        [-3.494734034735128]
                     1        [-3.494734034735128]
1         -4.379828  0        [-4.379828176267564]
                     1        [-4.379828176267564]
dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># energetics</span>
<span class="c1"># spinodal 0 is the limit of stability for phase 0 -&gt; phase 1</span>
<span class="c1"># spinodal 1 is the limit of stability for phase 1 -&gt; phase 0</span>
<span class="n">c</span><span class="o">.</span><span class="n">spinodal</span><span class="o">.</span><span class="n">access</span><span class="o">.</span><span class="n">wfe</span><span class="o">.</span><span class="n">dw</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>spinodal  lnz_0      phase  phase_nebr
0         -3.494734  0      0                    inf
                            1               1.000000
                     1      0             168.038523
                            1                    inf
1         -4.379828  0      0                    inf
                            1             142.179651
                     1      0               1.000000
                            1                    inf
Name: delta_w, dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Now that we have the spinodal, we can calculation the binodal</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">binodal</span><span class="p">(</span>
    <span class="n">phase_ids</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
    <span class="n">build_phases</span><span class="o">=</span><span class="n">phase_creator</span><span class="o">.</span><span class="n">build_phases_mu</span><span class="p">([</span><span class="kc">None</span><span class="p">]),</span>
    <span class="n">build_kws</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">efac</span><span class="o">=</span><span class="mf">0.5</span><span class="p">),</span>
    <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># access as collection with the `access` attribute</span>
<span class="n">c</span><span class="o">.</span><span class="n">binodal</span><span class="o">.</span><span class="n">access</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class lnPiCollection&gt;
binodal  lnz_0      phase
0        -3.966438  0        [-3.966438059499727]
                    1        [-3.966438059499727]
dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># at the binodal, the two phases should have equal pressure</span>
<span class="n">c</span><span class="o">.</span><span class="n">binodal</span><span class="o">.</span><span class="n">access</span><span class="o">.</span><span class="n">xge</span><span class="o">.</span><span class="n">pressure</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;pressure&#x27; (binodal: 1, lnz_0: 1, phase: 2)&gt;
array([[[0.01594237, 0.01594237]]])
Coordinates:
  * binodal  (binodal) int64 0
  * lnz_0    (lnz_0) float64 -3.966
  * phase    (phase) int64 0 1
    beta     float64 1.372
    volume   float64 512.0
Attributes:
    dims_n:      [&#x27;n_0&#x27;]
    dims_lnz:    [&#x27;lnz_0&#x27;]
    dims_comp:   [&#x27;component&#x27;]
    dims_state:  [&#x27;lnz_0&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]
    dims_rec:    [&#x27;sample&#x27;]
    long_name:   $p(\mu,V,T)$</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'pressure'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>binodal</span>: 1</li><li><span class='xr-has-index'>lnz_0</span>: 1</li><li><span class='xr-has-index'>phase</span>: 2</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-acd3e4a5-e34f-4520-8e53-c08ade1c464d' class='xr-array-in' type='checkbox' checked><label for='section-acd3e4a5-e34f-4520-8e53-c08ade1c464d' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>0.01594 0.01594</span></div><div class='xr-array-data'><pre>array([[[0.01594237, 0.01594237]]])</pre></div></div></li><li class='xr-section-item'><input id='section-32cfe9ab-1266-4362-91a5-a11d74f4018f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-32cfe9ab-1266-4362-91a5-a11d74f4018f' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>binodal</span></div><div class='xr-var-dims'>(binodal)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0</div><input id='attrs-70e17e48-2dc7-451b-b87b-c622e80a510d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-70e17e48-2dc7-451b-b87b-c622e80a510d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-592767ee-4475-4c13-917a-6514944c6a7b' class='xr-var-data-in' type='checkbox'><label for='data-592767ee-4475-4c13-917a-6514944c6a7b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lnz_0</span></div><div class='xr-var-dims'>(lnz_0)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-3.966</div><input id='attrs-938354c5-9682-453f-804c-97e396422a29' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-938354c5-9682-453f-804c-97e396422a29' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-c5dc7de4-fa49-4b7a-9b96-db47f9bf36aa' class='xr-var-data-in' type='checkbox'><label for='data-c5dc7de4-fa49-4b7a-9b96-db47f9bf36aa' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-3.966438])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>phase</span></div><div class='xr-var-dims'>(phase)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1</div><input id='attrs-cd5da125-a9ed-475a-94c5-5452a8555d33' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-cd5da125-a9ed-475a-94c5-5452a8555d33' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-742472d7-1575-450a-985b-8fe7a234ceb8' class='xr-var-data-in' type='checkbox'><label for='data-742472d7-1575-450a-985b-8fe7a234ceb8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 1])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>beta</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.372</div><input id='attrs-9a41dc6f-7007-40e3-bf0b-f3c32fd474e9' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-9a41dc6f-7007-40e3-bf0b-f3c32fd474e9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9c5f459c-e8a4-49ea-81b2-0e10608c8b03' class='xr-var-data-in' type='checkbox'><label for='data-9c5f459c-e8a4-49ea-81b2-0e10608c8b03' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(1.37228802)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>volume</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>512.0</div><input id='attrs-a5468ff5-cc92-4d52-8837-533c1f822001' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-a5468ff5-cc92-4d52-8837-533c1f822001' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-d12b3a0d-d98a-46fe-90b7-d1c4cfc7eab8' class='xr-var-data-in' type='checkbox'><label for='data-d12b3a0d-d98a-46fe-90b7-d1c4cfc7eab8' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(512.)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-0ce5cc26-b4d2-40c4-8666-bfd810524d06' class='xr-section-summary-in' type='checkbox'  ><label for='section-0ce5cc26-b4d2-40c4-8666-bfd810524d06' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>binodal</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-521b2266-13b8-4cdf-a07c-8f35ccda2c6d' class='xr-index-data-in' type='checkbox'/><label for='index-521b2266-13b8-4cdf-a07c-8f35ccda2c6d' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Int64Index([0], dtype=&#x27;int64&#x27;, name=&#x27;binodal&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lnz_0</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-bf8ecea4-6c88-41fa-9d97-945f72bf22c9' class='xr-index-data-in' type='checkbox'/><label for='index-bf8ecea4-6c88-41fa-9d97-945f72bf22c9' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([-3.966438059499727], dtype=&#x27;float64&#x27;, name=&#x27;lnz_0&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>phase</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-8b2661ec-a0aa-4e85-aaaa-bda4571961d2' class='xr-index-data-in' type='checkbox'/><label for='index-8b2661ec-a0aa-4e85-aaaa-bda4571961d2' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Int64Index([0, 1], dtype=&#x27;int64&#x27;, name=&#x27;phase&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-98163ba1-4cb6-4cc4-b076-9c808c91accc' class='xr-section-summary-in' type='checkbox'  checked><label for='section-98163ba1-4cb6-4cc4-b076-9c808c91accc' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>dims_n :</span></dt><dd>[&#x27;n_0&#x27;]</dd><dt><span>dims_lnz :</span></dt><dd>[&#x27;lnz_0&#x27;]</dd><dt><span>dims_comp :</span></dt><dd>[&#x27;component&#x27;]</dd><dt><span>dims_state :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]</dd><dt><span>dims_rec :</span></dt><dd>[&#x27;sample&#x27;]</dd><dt><span>long_name :</span></dt><dd>$p(\mu,V,T)$</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>To append spinodal/binodal to the dataset, use the following:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c_total</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">spinodal</span><span class="o">.</span><span class="n">appender</span><span class="p">)</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="o">.</span><span class="n">binodal</span><span class="o">.</span><span class="n">appender</span><span class="p">)</span>
<span class="n">c_total</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class lnPiCollection&gt;
lnz_0       phase
-10.000000  0                      [-10.0]
-9.111111   0          [-9.11111111111111]
-8.222222   0         [-8.222222222222221]
-7.333333   0         [-7.333333333333334]
-6.444444   0         [-6.444444444444445]
-5.555556   0         [-5.555555555555555]
-4.666667   0         [-4.666666666666667]
-3.777778   0        [-3.7777777777777786]
            1        [-3.7777777777777786]
-2.888889   1        [-2.8888888888888893]
-2.000000   1                       [-2.0]
-3.494734   0         [-3.494734034735128]
            1         [-3.494734034735128]
-4.379828   0         [-4.379828176267564]
            1         [-4.379828176267564]
-3.966438   0         [-3.966438059499727]
            1         [-3.966438059499727]
dtype: object
</pre></div>
</div>
</div>
</div>
<p>and if you’d like to sort the index:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c_total</span><span class="o">.</span><span class="n">sort_index</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class lnPiCollection&gt;
lnz_0       phase
-10.000000  0                      [-10.0]
-9.111111   0          [-9.11111111111111]
-8.222222   0         [-8.222222222222221]
-7.333333   0         [-7.333333333333334]
-6.444444   0         [-6.444444444444445]
-5.555556   0         [-5.555555555555555]
-4.666667   0         [-4.666666666666667]
-4.379828   0         [-4.379828176267564]
            1         [-4.379828176267564]
-3.966438   0         [-3.966438059499727]
            1         [-3.966438059499727]
-3.777778   0        [-3.7777777777777786]
            1        [-3.7777777777777786]
-3.494734   0         [-3.494734034735128]
            1         [-3.494734034735128]
-2.888889   1        [-2.8888888888888893]
-2.000000   1                       [-2.0]
dtype: object
</pre></div>
</div>
</div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="multi-component-systems">
<h1>Multi component systems<a class="headerlink" href="#multi-component-systems" title="Permalink to this heading">#</a></h1>
<p>lnPi is designed to work with single and multicomponent systems.   Let’s take a look at a system without phase transitions to start.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">lnpy.examples</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="n">load_example_dict</span><span class="p">(</span><span class="s2">&quot;ljmix_sup&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">f</span><span class="p">,</span> <span class="n">a</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">a</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;lnPi_data&quot;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x1a67131c0&gt;
</pre></div>
</div>
<img alt="../_images/572ab7d69ed6a9a0016064e54dd08802c5a6266a5623bf162d12909bdfc54160.png" src="../_images/572ab7d69ed6a9a0016064e54dd08802c5a6266a5623bf162d12909bdfc54160.png" />
</div>
</div>
<p>We have finite data along the upper corner of the matrix ‘lnPi_data’. Therefore, the base <code class="docutils literal notranslate"><span class="pre">lnPiMasked</span></code> object, without splitting into phases, also will have a mask.  This is why everything was build up from the <code class="docutils literal notranslate"><span class="pre">numpy.ma.MaskedArray</span></code> class.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;lnPi_data&#39;: array([[-759.26449941, -756.19423037, -753.77081946, ..., -424.28411489,
         -425.66274776, -426.93571412],
        [-755.52637941, -752.42375982, -749.96557613, ..., -418.59148639,
         -419.73805248,           nan],
        [-752.45715941, -749.31971691, -746.82151608, ..., -413.26963103,
         -414.54424182,           nan],
        ...,
        [-104.40479985, -102.4117824 ,           nan, ...,           nan,
                   nan,           nan],
        [-105.98668385,           nan,           nan, ...,           nan,
                   nan,           nan],
        [-107.62349885,           nan,           nan, ...,           nan,
                   nan,           nan]]),
 &#39;lnPi_mask&#39;: array([[False, False, False, ..., False, False, False],
        [False, False, False, ..., False, False,  True],
        [False, False, False, ..., False, False,  True],
        ...,
        [False, False,  True, ...,  True,  True,  True],
        [False,  True,  True, ...,  True,  True,  True],
        [False,  True,  True, ...,  True,  True,  True]]),
 &#39;state_kws&#39;: {&#39;temp&#39;: 0.8, &#39;beta&#39;: 1.25, &#39;volume&#39;: 512},
 &#39;extra_kws&#39;: {},
 &#39;lnz&#39;: array([-2.5, -2.5])}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ref</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">lnPiMasked</span><span class="o">.</span><span class="n">from_data</span><span class="p">(</span>
    <span class="n">lnz</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;lnz&quot;</span><span class="p">],</span>
    <span class="n">lnz_data</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;lnz&quot;</span><span class="p">],</span>
    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;lnPi_data&quot;</span><span class="p">],</span>
    <span class="n">mask</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;lnPi_mask&quot;</span><span class="p">],</span>
    <span class="n">state_kws</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;state_kws&quot;</span><span class="p">],</span>
    <span class="n">extra_kws</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;extra_kws&quot;</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Note that we could have also done:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ref</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">lnPiMasked</span><span class="o">.</span><span class="n">from_data</span><span class="p">(</span>
    <span class="n">lnz</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;lnz&quot;</span><span class="p">],</span>
    <span class="n">lnz_data</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;lnz&quot;</span><span class="p">],</span>
    <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;lnPi_data&quot;</span><span class="p">],</span>
    <span class="n">mask</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;lnPi_data&quot;</span><span class="p">]),</span>
    <span class="n">state_kws</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;state_kws&quot;</span><span class="p">],</span>
    <span class="n">extra_kws</span><span class="o">=</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;extra_kws&quot;</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<section id="considering-lines-of-constant-ln-z-or-constant-delta-ln-z">
<h2>Considering lines of constant <span class="math notranslate nohighlight">\(\ln z\)</span> or constant <span class="math notranslate nohighlight">\(\Delta \ln z\)</span>.<a class="headerlink" href="#considering-lines-of-constant-ln-z-or-constant-delta-ln-z" title="Permalink to this heading">#</a></h2>
<p>Considering a multicomponent system will hopefully help explain why some design choices were made for <code class="docutils literal notranslate"><span class="pre">lnpy</span></code>.</p>
<p>It is common to want to consider a multicomponent system along lines of constant ‘something’.  For example, we might want to consider a spectrum of values of <span class="math notranslate nohighlight">\(\ln z_0\)</span> while holding <span class="math notranslate nohighlight">\(\ln z_1\)</span> constant.  This can be accomplished using some built in <a class="reference internal" href="../reference/generated/lnpy.segment.html#lnpy.segment.PhaseCreator" title="lnpy.segment.PhaseCreator"><code class="xref py py-class docutils literal notranslate"><span class="pre">PhaseCreator</span></code></a> constructors.</p>
<p>First, note that if you know that a particular system will not have a phase transition, specify <code class="docutils literal notranslate"><span class="pre">nmax=1</span></code>.  This will make the system skip the <code class="docutils literal notranslate"><span class="pre">lnPi</span></code> segmentation, which is the slowest process in analyzing <span class="math notranslate nohighlight">\(\ln \Pi(N)\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">phase_creator</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">PhaseCreator</span><span class="p">(</span><span class="n">nmax</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="n">ref</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>If you just call the <code class="docutils literal notranslate"><span class="pre">phase_creator.build_phases</span></code> constructor, we have to specify the total (vector) value of <span class="math notranslate nohighlight">\(\ln z\)</span>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">phase_creator</span><span class="o">.</span><span class="n">build_phases</span><span class="p">(</span><span class="n">lnz</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class lnPiCollection&gt;
lnz_0  lnz_1  phase
0.0    0.0    0        [0.0, 0.0]
dtype: object
</pre></div>
</div>
</div>
</div>
<p>This is fine.  But things like <a class="reference internal" href="../reference/generated/lnpy.lnpiseries.html#lnpy.lnpiseries.lnPiCollection" title="lnpy.lnpiseries.lnPiCollection"><code class="xref py py-class docutils literal notranslate"><span class="pre">lnPiCollection</span></code></a>, <a class="reference internal" href="../reference/generated/lnpy.stability.html#lnpy.stability.Spinodals" title="lnpy.stability.Spinodals"><code class="xref py py-class docutils literal notranslate"><span class="pre">Spinodals</span></code></a>, and <a class="reference internal" href="../reference/generated/lnpy.stability.html#lnpy.stability.Binodals" title="lnpy.stability.Binodals"><code class="xref py py-class docutils literal notranslate"><span class="pre">Binodals</span></code></a> are setup to work with scalar values of <span class="math notranslate nohighlight">\(\ln z\)</span>.  So, we have the following constructors:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">build_phases</span> <span class="o">=</span> <span class="n">phase_creator</span><span class="o">.</span><span class="n">build_phases_mu</span><span class="p">([</span><span class="kc">None</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.0</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">build_phases</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class lnPiCollection&gt;
lnz_0  lnz_1  phase
0.0    -1.0   0        [0.0, -1.0]
dtype: object
</pre></div>
</div>
</div>
</div>
<p><a class="reference internal" href="../reference/generated/lnpy.segment.html#lnpy.segment.PhaseCreator.build_phases_mu" title="lnpy.segment.PhaseCreator.build_phases_mu"><code class="xref py py-meth docutils literal notranslate"><span class="pre">build_phases_mu()</span></code></a> returns a constructor at fixed values of <span class="math notranslate nohighlight">\(\ln z\)</span> for all but one component. The component given a value of None (the first component in the example above) is the one we can vary.  Then calling this constructor will make a new collection with the requested value of <span class="math notranslate nohighlight">\(\ln z\)</span> for the variable component and the fixed values of <span class="math notranslate nohighlight">\(\ln z\)</span> for other components as defined in the constructor.</p>
<p>We can use this to define a collection easily</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">lnPiCollection</span><span class="o">.</span><span class="n">from_builder</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">build_phases</span><span class="p">)</span>

<span class="n">c</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class lnPiCollection&gt;
lnz_0  lnz_1  phase
-3.0   -1.0   0        [-3.0, -1.0]
-1.5   -1.0   0        [-1.5, -1.0]
 0.0   -1.0   0         [0.0, -1.0]
 1.5   -1.0   0         [1.5, -1.0]
 3.0   -1.0   0         [3.0, -1.0]
dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># At a different fixed value.  This time at fixed lnz_0</span>
<span class="n">build_phases</span> <span class="o">=</span> <span class="n">phase_creator</span><span class="o">.</span><span class="n">build_phases_mu</span><span class="p">([</span><span class="mf">0.5</span><span class="p">,</span> <span class="kc">None</span><span class="p">])</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">lnPiCollection</span><span class="o">.</span><span class="n">from_builder</span><span class="p">(</span>
    <span class="n">lnzs</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">build_phases</span><span class="o">=</span><span class="n">build_phases</span>
<span class="p">)</span>
<span class="n">c</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class lnPiCollection&gt;
lnz_0  lnz_1  phase
0.5    -3.0   0        [0.5, -3.0]
       -1.5   0        [0.5, -1.5]
        0.0   0         [0.5, 0.0]
        1.5   0         [0.5, 1.5]
        3.0   0         [0.5, 3.0]
dtype: object
</pre></div>
</div>
</div>
</div>
<p>Similarly, we can create <code class="docutils literal notranslate"><span class="pre">lnPi</span></code>s at fixed value of <span class="math notranslate nohighlight">\(\Delta \ln z\)</span>, where <span class="math notranslate nohighlight">\(\Delta \ln z_k = \ln z_k - \ln z_f\)</span> where <span class="math notranslate nohighlight">\(f\)</span> is the index of the variable component using the <a class="reference internal" href="../reference/generated/lnpy.segment.html#lnpy.segment.PhaseCreator.build_phases_dmu" title="lnpy.segment.PhaseCreator.build_phases_dmu"><code class="xref py py-meth docutils literal notranslate"><span class="pre">build_phases_dmu()</span></code></a> method:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># fixed value of dlnz_1 = lnz_1 - lnz_0 = 1.0</span>
<span class="n">build_phases</span> <span class="o">=</span> <span class="n">phase_creator</span><span class="o">.</span><span class="n">build_phases_dmu</span><span class="p">([</span><span class="kc">None</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">])</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">lnPiCollection</span><span class="o">.</span><span class="n">from_builder</span><span class="p">(</span>
    <span class="n">lnzs</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">build_phases</span><span class="o">=</span><span class="n">build_phases</span>
<span class="p">)</span>
<span class="n">c</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class lnPiCollection&gt;
lnz_0  lnz_1  phase
-3.0   -2.0   0        [-3.0, -2.0]
-1.5   -0.5   0        [-1.5, -0.5]
 0.0    1.0   0          [0.0, 1.0]
 1.5    2.5   0          [1.5, 2.5]
 3.0    4.0   0          [3.0, 4.0]
dtype: object
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lnz_0</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">get_index_level</span><span class="p">(</span><span class="s2">&quot;lnz_0&quot;</span><span class="p">)</span>
<span class="n">lnz_1</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">get_index_level</span><span class="p">(</span><span class="s2">&quot;lnz_1&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lnz_1</span> <span class="o">-</span> <span class="n">lnz_0</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Float64Index([1.0, 1.0, 1.0, 1.0, 1.0], dtype=&#39;float64&#39;)
</pre></div>
</div>
</div>
</div>
</section>
<section id="multicomponent-system-with-phase-transitions">
<h2>Multicomponent system with phase transitions<a class="headerlink" href="#multicomponent-system-with-phase-transitions" title="Permalink to this heading">#</a></h2>
<p>Next, we consider a multicomponent system</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ref</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">examples</span><span class="o">.</span><span class="n">load_example_maskddata</span><span class="p">(</span><span class="s2">&quot;hsmix&quot;</span><span class="p">)</span>
<span class="n">ref</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;lnPi(lnz=[0.5 0.5])&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ref</span><span class="o">.</span><span class="n">xge</span><span class="o">.</span><span class="n">lnpi</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.QuadMesh at 0x1a65b6110&gt;
</pre></div>
</div>
<img alt="../_images/48d17be8fdf7197b614ee2ac3920ef05355b34acc0547337e26f821ae305903d.png" src="../_images/48d17be8fdf7197b614ee2ac3920ef05355b34acc0547337e26f821ae305903d.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># function to tag &#39;LD&#39; and &#39;HD&#39; phases</span>
<span class="k">def</span> <span class="nf">tag_phases</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;bad tag function&quot;</span><span class="p">)</span>
    <span class="n">argmax0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">xx</span><span class="o">.</span><span class="n">local_argmax</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">xx</span> <span class="ow">in</span> <span class="n">x</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">argmax0</span> <span class="o">&lt;=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>


<span class="n">phase_creator</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">PhaseCreator</span><span class="p">(</span>
    <span class="n">nmax</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">nmax_peak</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">ref</span><span class="o">=</span><span class="n">ref</span><span class="p">,</span> <span class="n">tag_phases</span><span class="o">=</span><span class="n">tag_phases</span><span class="p">,</span> <span class="n">merge_kws</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="n">efac</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">build_phases</span> <span class="o">=</span> <span class="n">phase_creator</span><span class="o">.</span><span class="n">build_phases_mu</span><span class="p">([</span><span class="kc">None</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">])</span>

<span class="n">c</span> <span class="o">=</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">lnPiCollection</span><span class="o">.</span><span class="n">from_builder</span><span class="p">(</span>
    <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span> <span class="n">build_phases</span><span class="p">,</span> <span class="n">unstack</span><span class="o">=</span><span class="kc">False</span>
<span class="p">)</span>
<span class="n">c</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class lnPiCollection&gt;
lnz_0      lnz_1  phase
-5.000000  0.0    0                      [-5.0, 0.0]
-4.795918  0.0    0        [-4.795918367346939, 0.0]
-4.591837  0.0    0        [-4.591836734693878, 0.0]
-4.387755  0.0    0        [-4.387755102040816, 0.0]
-4.183673  0.0    0        [-4.183673469387755, 0.0]
                                     ...            
 4.183673  0.0    1         [4.183673469387756, 0.0]
 4.387755  0.0    1         [4.387755102040817, 0.0]
 4.591837  0.0    1         [4.591836734693878, 0.0]
 4.795918  0.0    1         [4.795918367346939, 0.0]
 5.000000  0.0    1                       [5.0, 0.0]
Length: 65, dtype: object
</pre></div>
</div>
</div>
</div>
<p>Note that here we have used the <code class="docutils literal notranslate"><span class="pre">unstack=False</span></code> option.  This means that the results from <a class="reference internal" href="../reference/generated/lnpy.lnpiseries.html#lnpy.lnpiseries.lnPiCollection.xge" title="lnpy.lnpiseries.lnPiCollection.xge"><code class="xref py py-attr docutils literal notranslate"><span class="pre">lnpy.lnpiseries.lnPiCollection.xge</span></code></a> will <em>not</em> be unstacked.  For example:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">xge</span><span class="o">.</span><span class="n">betaOmega</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;betaOmega&#x27; (sample: 65)&gt;
array([-1246.12388491, -1246.12448998, -1246.12523222, -1246.12614278,
       -1246.12725991, -1246.1286306 , -1246.13031256, -1246.13237676,
       -1246.13491046, -1246.13802107, -1246.14184087, -1246.14653294,
       -1246.15229859, -1246.1593867 , -1246.16810551, -1246.1788377 ,
       -1246.19205972, -1010.9087438 , -1246.20836701, -1054.37219518,
       -1246.22850704, -1098.99423283, -1246.25342379, -1144.4775693 ,
       -1246.28431829, -1190.70729484, -1246.32273372, -1237.62335537,
       -1246.37067871, -1285.1875377 , -1246.43081409, -1333.37342804,
       -1246.50675309, -1382.15798324, -1246.60358765, -1431.51759825,
       -1246.72896095, -1481.42620374, -1246.89609727, -1531.84252007,
       -1247.1319439 , -1582.68976406, -1247.47204378, -1633.86017062,
       -1247.86446355, -1685.24884688, -1736.77785101, -1788.39701972,
       -1840.07559237, -1891.79461328, -1943.54206924, -1995.3100774 ,
       -2047.093286  , -2098.88794914, -2150.69137525, -2202.50158717,
       -2254.3171055 , -2306.13680626, -2357.95982463, -2409.78548824,
       -2461.61326981, -2513.44275296, -2565.27360693, -2617.10556771,
       -2668.9384238 ])
Coordinates:
  * sample   (sample) object MultiIndex
  * lnz_0    (sample) float64 -5.0 -4.796 -4.592 -4.388 ... 4.592 4.796 5.0
  * lnz_1    (sample) float64 0.0 0.0 0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0 0.0
  * phase    (sample) int64 0 0 0 0 0 0 0 0 0 0 0 0 ... 1 1 1 1 1 1 1 1 1 1 1 1
    beta     float64 1.0
    volume   float64 1.0
Attributes:
    dims_n:         [&#x27;n_0&#x27;, &#x27;n_1&#x27;]
    dims_lnz:       [&#x27;lnz_0&#x27;, &#x27;lnz_1&#x27;]
    dims_comp:      [&#x27;component&#x27;]
    dims_state:     [&#x27;lnz_0&#x27;, &#x27;lnz_1&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]
    dims_rec:       [&#x27;sample&#x27;]
    standard_name:  grand_potential
    long_name:      $\beta \Omega(\mu,V,T)$</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'betaOmega'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>sample</span>: 65</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-3ce3c704-8bca-46c3-8d93-533b2ca8da23' class='xr-array-in' type='checkbox' checked><label for='section-3ce3c704-8bca-46c3-8d93-533b2ca8da23' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>-1.246e+03 -1.246e+03 -1.246e+03 ... -2.565e+03 -2.617e+03 -2.669e+03</span></div><div class='xr-array-data'><pre>array([-1246.12388491, -1246.12448998, -1246.12523222, -1246.12614278,
       -1246.12725991, -1246.1286306 , -1246.13031256, -1246.13237676,
       -1246.13491046, -1246.13802107, -1246.14184087, -1246.14653294,
       -1246.15229859, -1246.1593867 , -1246.16810551, -1246.1788377 ,
       -1246.19205972, -1010.9087438 , -1246.20836701, -1054.37219518,
       -1246.22850704, -1098.99423283, -1246.25342379, -1144.4775693 ,
       -1246.28431829, -1190.70729484, -1246.32273372, -1237.62335537,
       -1246.37067871, -1285.1875377 , -1246.43081409, -1333.37342804,
       -1246.50675309, -1382.15798324, -1246.60358765, -1431.51759825,
       -1246.72896095, -1481.42620374, -1246.89609727, -1531.84252007,
       -1247.1319439 , -1582.68976406, -1247.47204378, -1633.86017062,
       -1247.86446355, -1685.24884688, -1736.77785101, -1788.39701972,
       -1840.07559237, -1891.79461328, -1943.54206924, -1995.3100774 ,
       -2047.093286  , -2098.88794914, -2150.69137525, -2202.50158717,
       -2254.3171055 , -2306.13680626, -2357.95982463, -2409.78548824,
       -2461.61326981, -2513.44275296, -2565.27360693, -2617.10556771,
       -2668.9384238 ])</pre></div></div></li><li class='xr-section-item'><input id='section-4fc5d94a-fe1e-4e93-bd76-28bd1dde0771' class='xr-section-summary-in' type='checkbox'  checked><label for='section-4fc5d94a-fe1e-4e93-bd76-28bd1dde0771' class='xr-section-summary' >Coordinates: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>sample</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>MultiIndex</div><input id='attrs-505bdb93-d099-44b1-ae19-d7212831545e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-505bdb93-d099-44b1-ae19-d7212831545e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-a4a5cd66-d6e6-454b-9e51-ff0777352926' class='xr-var-data-in' type='checkbox'><label for='data-a4a5cd66-d6e6-454b-9e51-ff0777352926' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([(-5.0, 0.0, 0), (-4.795918367346939, 0.0, 0),
       (-4.591836734693878, 0.0, 0), (-4.387755102040816, 0.0, 0),
       (-4.183673469387755, 0.0, 0), (-3.979591836734694, 0.0, 0),
       (-3.7755102040816326, 0.0, 0), (-3.571428571428571, 0.0, 0),
       (-3.36734693877551, 0.0, 0), (-3.163265306122449, 0.0, 0),
       (-2.9591836734693877, 0.0, 0), (-2.7551020408163263, 0.0, 0),
       (-2.5510204081632653, 0.0, 0), (-2.3469387755102042, 0.0, 0),
       (-2.142857142857143, 0.0, 0), (-1.9387755102040813, 0.0, 0),
       (-1.7346938775510203, 0.0, 0), (-1.7346938775510203, 0.0, 1),
       (-1.5306122448979593, 0.0, 0), (-1.5306122448979593, 0.0, 1),
       (-1.3265306122448979, 0.0, 0), (-1.3265306122448979, 0.0, 1),
       (-1.1224489795918364, 0.0, 0), (-1.1224489795918364, 0.0, 1),
       (-0.9183673469387754, 0.0, 0), (-0.9183673469387754, 0.0, 1),
       (-0.7142857142857144, 0.0, 0), (-0.7142857142857144, 0.0, 1),
       (-0.5102040816326525, 0.0, 0), (-0.5102040816326525, 0.0, 1),
       (-0.3061224489795915, 0.0, 0), (-0.3061224489795915, 0.0, 1),
       (-0.1020408163265305, 0.0, 0), (-0.1020408163265305, 0.0, 1),
       (0.1020408163265305, 0.0, 0), (0.1020408163265305, 0.0, 1),
       (0.3061224489795915, 0.0, 0), (0.3061224489795915, 0.0, 1),
       (0.5102040816326534, 0.0, 0), (0.5102040816326534, 0.0, 1),
       (0.7142857142857144, 0.0, 0), (0.7142857142857144, 0.0, 1),
       (0.9183673469387754, 0.0, 0), (0.9183673469387754, 0.0, 1),
       (1.1224489795918373, 0.0, 0), (1.1224489795918373, 0.0, 1),
       (1.3265306122448983, 0.0, 1), (1.5306122448979593, 0.0, 1),
       (1.7346938775510203, 0.0, 1), (1.9387755102040813, 0.0, 1),
       (2.1428571428571432, 0.0, 1), (2.3469387755102042, 0.0, 1),
       (2.5510204081632653, 0.0, 1), (2.755102040816327, 0.0, 1),
       (2.959183673469388, 0.0, 1), (3.163265306122449, 0.0, 1),
       (3.36734693877551, 0.0, 1), (3.571428571428571, 0.0, 1),
       (3.775510204081632, 0.0, 1), (3.979591836734695, 0.0, 1),
       (4.183673469387756, 0.0, 1), (4.387755102040817, 0.0, 1),
       (4.591836734693878, 0.0, 1), (4.795918367346939, 0.0, 1), (5.0, 0.0, 1)],
      dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lnz_0</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-5.0 -4.796 -4.592 ... 4.796 5.0</div><input id='attrs-e7e078a2-493e-4365-99f3-6a6fdfe616c8' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e7e078a2-493e-4365-99f3-6a6fdfe616c8' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-ad854bb5-1b7c-4652-b974-4c34ba6b3e4e' class='xr-var-data-in' type='checkbox'><label for='data-ad854bb5-1b7c-4652-b974-4c34ba6b3e4e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-5.      , -4.795918, -4.591837, -4.387755, -4.183673, -3.979592,
       -3.77551 , -3.571429, -3.367347, -3.163265, -2.959184, -2.755102,
       -2.55102 , -2.346939, -2.142857, -1.938776, -1.734694, -1.734694,
       -1.530612, -1.530612, -1.326531, -1.326531, -1.122449, -1.122449,
       -0.918367, -0.918367, -0.714286, -0.714286, -0.510204, -0.510204,
       -0.306122, -0.306122, -0.102041, -0.102041,  0.102041,  0.102041,
        0.306122,  0.306122,  0.510204,  0.510204,  0.714286,  0.714286,
        0.918367,  0.918367,  1.122449,  1.122449,  1.326531,  1.530612,
        1.734694,  1.938776,  2.142857,  2.346939,  2.55102 ,  2.755102,
        2.959184,  3.163265,  3.367347,  3.571429,  3.77551 ,  3.979592,
        4.183673,  4.387755,  4.591837,  4.795918,  5.      ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lnz_1</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 0.0 ... 0.0 0.0 0.0 0.0</div><input id='attrs-d713935b-7601-4911-8795-f84a67391d1e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-d713935b-7601-4911-8795-f84a67391d1e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-3e1e1250-39ef-4052-ab27-3b3709e0fcec' class='xr-var-data-in' type='checkbox'><label for='data-3e1e1250-39ef-4052-ab27-3b3709e0fcec' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.,
       0., 0., 0., 0., 0., 0., 0., 0., 0., 0., 0.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>phase</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 0 0 0 0 0 0 0 ... 1 1 1 1 1 1 1 1</div><input id='attrs-e523cb80-1280-41d8-82f2-f635ce477846' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e523cb80-1280-41d8-82f2-f635ce477846' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-b8138832-d707-4d44-b288-722ae9f5fd9f' class='xr-var-data-in' type='checkbox'><label for='data-b8138832-d707-4d44-b288-722ae9f5fd9f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 1,
       0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 0, 1, 1, 1,
       1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>beta</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.0</div><input id='attrs-4c951fb5-c068-467f-9814-6bf1eaec97d9' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-4c951fb5-c068-467f-9814-6bf1eaec97d9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-14271a72-952c-424a-a486-d94cc8e12d8d' class='xr-var-data-in' type='checkbox'><label for='data-14271a72-952c-424a-a486-d94cc8e12d8d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(1.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>volume</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.0</div><input id='attrs-98a149f3-f95c-4214-9d67-2b58aaab40af' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-98a149f3-f95c-4214-9d67-2b58aaab40af' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-64087836-38e4-4e69-b555-dfc402e71087' class='xr-var-data-in' type='checkbox'><label for='data-64087836-38e4-4e69-b555-dfc402e71087' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(1.)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-0ed0c237-e340-4022-b3c3-fd4d0161e69e' class='xr-section-summary-in' type='checkbox'  ><label for='section-0ed0c237-e340-4022-b3c3-fd4d0161e69e' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>sample<br>lnz_0<br>lnz_1<br>phase</div></div><div class='xr-index-preview'>PandasMultiIndex</div><div></div><input id='index-197af2f7-69e1-4c9c-b30b-646117e05e62' class='xr-index-data-in' type='checkbox'/><label for='index-197af2f7-69e1-4c9c-b30b-646117e05e62' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(MultiIndex([(               -5.0, 0.0, 0),
            ( -4.795918367346939, 0.0, 0),
            ( -4.591836734693878, 0.0, 0),
            ( -4.387755102040816, 0.0, 0),
            ( -4.183673469387755, 0.0, 0),
            ( -3.979591836734694, 0.0, 0),
            (-3.7755102040816326, 0.0, 0),
            ( -3.571428571428571, 0.0, 0),
            (  -3.36734693877551, 0.0, 0),
            ( -3.163265306122449, 0.0, 0),
            (-2.9591836734693877, 0.0, 0),
            (-2.7551020408163263, 0.0, 0),
            (-2.5510204081632653, 0.0, 0),
            (-2.3469387755102042, 0.0, 0),
            ( -2.142857142857143, 0.0, 0),
            (-1.9387755102040813, 0.0, 0),
            (-1.7346938775510203, 0.0, 0),
            (-1.7346938775510203, 0.0, 1),
            (-1.5306122448979593, 0.0, 0),
            (-1.5306122448979593, 0.0, 1),
            (-1.3265306122448979, 0.0, 0),
            (-1.3265306122448979, 0.0, 1),
            (-1.1224489795918364, 0.0, 0),
            (-1.1224489795918364, 0.0, 1),
            (-0.9183673469387754, 0.0, 0),
            (-0.9183673469387754, 0.0, 1),
            (-0.7142857142857144, 0.0, 0),
            (-0.7142857142857144, 0.0, 1),
            (-0.5102040816326525, 0.0, 0),
            (-0.5102040816326525, 0.0, 1),
            (-0.3061224489795915, 0.0, 0),
            (-0.3061224489795915, 0.0, 1),
            (-0.1020408163265305, 0.0, 0),
            (-0.1020408163265305, 0.0, 1),
            ( 0.1020408163265305, 0.0, 0),
            ( 0.1020408163265305, 0.0, 1),
            ( 0.3061224489795915, 0.0, 0),
            ( 0.3061224489795915, 0.0, 1),
            ( 0.5102040816326534, 0.0, 0),
            ( 0.5102040816326534, 0.0, 1),
            ( 0.7142857142857144, 0.0, 0),
            ( 0.7142857142857144, 0.0, 1),
            ( 0.9183673469387754, 0.0, 0),
            ( 0.9183673469387754, 0.0, 1),
            ( 1.1224489795918373, 0.0, 0),
            ( 1.1224489795918373, 0.0, 1),
            ( 1.3265306122448983, 0.0, 1),
            ( 1.5306122448979593, 0.0, 1),
            ( 1.7346938775510203, 0.0, 1),
            ( 1.9387755102040813, 0.0, 1),
            ( 2.1428571428571432, 0.0, 1),
            ( 2.3469387755102042, 0.0, 1),
            ( 2.5510204081632653, 0.0, 1),
            (  2.755102040816327, 0.0, 1),
            (  2.959183673469388, 0.0, 1),
            (  3.163265306122449, 0.0, 1),
            (   3.36734693877551, 0.0, 1),
            (  3.571428571428571, 0.0, 1),
            (  3.775510204081632, 0.0, 1),
            (  3.979591836734695, 0.0, 1),
            (  4.183673469387756, 0.0, 1),
            (  4.387755102040817, 0.0, 1),
            (  4.591836734693878, 0.0, 1),
            (  4.795918367346939, 0.0, 1),
            (                5.0, 0.0, 1)],
           name=&#x27;sample&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-e6157c14-6a3f-458e-b5e0-9a77ff62f198' class='xr-section-summary-in' type='checkbox'  checked><label for='section-e6157c14-6a3f-458e-b5e0-9a77ff62f198' class='xr-section-summary' >Attributes: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>dims_n :</span></dt><dd>[&#x27;n_0&#x27;, &#x27;n_1&#x27;]</dd><dt><span>dims_lnz :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;lnz_1&#x27;]</dd><dt><span>dims_comp :</span></dt><dd>[&#x27;component&#x27;]</dd><dt><span>dims_state :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;lnz_1&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]</dd><dt><span>dims_rec :</span></dt><dd>[&#x27;sample&#x27;]</dd><dt><span>standard_name :</span></dt><dd>grand_potential</dd><dt><span>long_name :</span></dt><dd>$\beta \Omega(\mu,V,T)$</dd></dl></div></li></ul></div></div></div></div>
</div>
<p>To ‘unstack’ from ‘sample’ dimension to ‘lnz_0’, ‘lnz_1’, etc, you can call <code class="docutils literal notranslate"><span class="pre">unstack</span></code> directly:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">xge</span><span class="o">.</span><span class="n">betaOmega</span><span class="p">()</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.DataArray &#x27;betaOmega&#x27; (lnz_0: 50, lnz_1: 1, phase: 2)&gt;
array([[[-1246.12388491,            nan]],

       [[-1246.12448998,            nan]],

       [[-1246.12523222,            nan]],

       [[-1246.12614278,            nan]],

       [[-1246.12725991,            nan]],

       [[-1246.1286306 ,            nan]],

       [[-1246.13031256,            nan]],

       [[-1246.13237676,            nan]],

       [[-1246.13491046,            nan]],

       [[-1246.13802107,            nan]],

...

       [[           nan, -2202.50158717]],

       [[           nan, -2254.3171055 ]],

       [[           nan, -2306.13680626]],

       [[           nan, -2357.95982463]],

       [[           nan, -2409.78548824]],

       [[           nan, -2461.61326981]],

       [[           nan, -2513.44275296]],

       [[           nan, -2565.27360693]],

       [[           nan, -2617.10556771]],

       [[           nan, -2668.9384238 ]]])
Coordinates:
  * lnz_0    (lnz_0) float64 -5.0 -4.796 -4.592 -4.388 ... 4.388 4.592 4.796 5.0
  * lnz_1    (lnz_1) float64 0.0
  * phase    (phase) int64 0 1
    beta     float64 1.0
    volume   float64 1.0
Attributes:
    dims_n:         [&#x27;n_0&#x27;, &#x27;n_1&#x27;]
    dims_lnz:       [&#x27;lnz_0&#x27;, &#x27;lnz_1&#x27;]
    dims_comp:      [&#x27;component&#x27;]
    dims_state:     [&#x27;lnz_0&#x27;, &#x27;lnz_1&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]
    dims_rec:       [&#x27;sample&#x27;]
    standard_name:  grand_potential
    long_name:      $\beta \Omega(\mu,V,T)$</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.DataArray</div><div class='xr-array-name'>'betaOmega'</div><ul class='xr-dim-list'><li><span class='xr-has-index'>lnz_0</span>: 50</li><li><span class='xr-has-index'>lnz_1</span>: 1</li><li><span class='xr-has-index'>phase</span>: 2</li></ul></div><ul class='xr-sections'><li class='xr-section-item'><div class='xr-array-wrap'><input id='section-07cbfd5d-1b17-4afc-bb41-3c9bf3b4a1c9' class='xr-array-in' type='checkbox' checked><label for='section-07cbfd5d-1b17-4afc-bb41-3c9bf3b4a1c9' title='Show/hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-array-preview xr-preview'><span>-1.246e+03 nan -1.246e+03 nan ... nan -2.617e+03 nan -2.669e+03</span></div><div class='xr-array-data'><pre>array([[[-1246.12388491,            nan]],

       [[-1246.12448998,            nan]],

       [[-1246.12523222,            nan]],

       [[-1246.12614278,            nan]],

       [[-1246.12725991,            nan]],

       [[-1246.1286306 ,            nan]],

       [[-1246.13031256,            nan]],

       [[-1246.13237676,            nan]],

       [[-1246.13491046,            nan]],

       [[-1246.13802107,            nan]],

...

       [[           nan, -2202.50158717]],

       [[           nan, -2254.3171055 ]],

       [[           nan, -2306.13680626]],

       [[           nan, -2357.95982463]],

       [[           nan, -2409.78548824]],

       [[           nan, -2461.61326981]],

       [[           nan, -2513.44275296]],

       [[           nan, -2565.27360693]],

       [[           nan, -2617.10556771]],

       [[           nan, -2668.9384238 ]]])</pre></div></div></li><li class='xr-section-item'><input id='section-3b1a2af7-1e82-4907-9e37-01598d92e75c' class='xr-section-summary-in' type='checkbox'  checked><label for='section-3b1a2af7-1e82-4907-9e37-01598d92e75c' class='xr-section-summary' >Coordinates: <span>(5)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lnz_0</span></div><div class='xr-var-dims'>(lnz_0)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>-5.0 -4.796 -4.592 ... 4.796 5.0</div><input id='attrs-83793ae3-5e78-4aaf-bc9c-99bc245e6e28' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-83793ae3-5e78-4aaf-bc9c-99bc245e6e28' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-f1b00f61-05bf-41af-9c7d-379cd5e3a077' class='xr-var-data-in' type='checkbox'><label for='data-f1b00f61-05bf-41af-9c7d-379cd5e3a077' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([-5.      , -4.795918, -4.591837, -4.387755, -4.183673, -3.979592,
       -3.77551 , -3.571429, -3.367347, -3.163265, -2.959184, -2.755102,
       -2.55102 , -2.346939, -2.142857, -1.938776, -1.734694, -1.530612,
       -1.326531, -1.122449, -0.918367, -0.714286, -0.510204, -0.306122,
       -0.102041,  0.102041,  0.306122,  0.510204,  0.714286,  0.918367,
        1.122449,  1.326531,  1.530612,  1.734694,  1.938776,  2.142857,
        2.346939,  2.55102 ,  2.755102,  2.959184,  3.163265,  3.367347,
        3.571429,  3.77551 ,  3.979592,  4.183673,  4.387755,  4.591837,
        4.795918,  5.      ])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lnz_1</span></div><div class='xr-var-dims'>(lnz_1)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0</div><input id='attrs-877ccc30-e4ff-4ee1-9ab3-f90fc327df8f' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-877ccc30-e4ff-4ee1-9ab3-f90fc327df8f' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-9e7b19f3-d26e-4fa9-933a-6db7902fe717' class='xr-var-data-in' type='checkbox'><label for='data-9e7b19f3-d26e-4fa9-933a-6db7902fe717' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>phase</span></div><div class='xr-var-dims'>(phase)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1</div><input id='attrs-dc70fc13-a7d3-4150-99fb-d995c9495aa2' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-dc70fc13-a7d3-4150-99fb-d995c9495aa2' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-507e8a33-e962-4fb4-9a8e-10fce3d19e0d' class='xr-var-data-in' type='checkbox'><label for='data-507e8a33-e962-4fb4-9a8e-10fce3d19e0d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 1])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>beta</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.0</div><input id='attrs-e2009da1-e250-48d9-9d33-892f5cd04c79' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-e2009da1-e250-48d9-9d33-892f5cd04c79' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5189a219-a419-4bd3-a2f9-dde90721142b' class='xr-var-data-in' type='checkbox'><label for='data-5189a219-a419-4bd3-a2f9-dde90721142b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(1.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>volume</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.0</div><input id='attrs-b86142e5-39cb-4e5d-a4a0-abcb7ac19d95' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b86142e5-39cb-4e5d-a4a0-abcb7ac19d95' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-629c9797-c395-427c-bb5f-feee9939ac4d' class='xr-var-data-in' type='checkbox'><label for='data-629c9797-c395-427c-bb5f-feee9939ac4d' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(1.)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-e480a97b-b763-4656-8814-c66a14ac5754' class='xr-section-summary-in' type='checkbox'  ><label for='section-e480a97b-b763-4656-8814-c66a14ac5754' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>lnz_0</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-c5473e83-a3b8-4c1e-bdcf-f41f14f4360a' class='xr-index-data-in' type='checkbox'/><label for='index-c5473e83-a3b8-4c1e-bdcf-f41f14f4360a' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([               -5.0,  -4.795918367346939,  -4.591836734693878,
               -4.387755102040816,  -4.183673469387755,  -3.979591836734694,
              -3.7755102040816326,  -3.571428571428571,   -3.36734693877551,
               -3.163265306122449, -2.9591836734693877, -2.7551020408163263,
              -2.5510204081632653, -2.3469387755102042,  -2.142857142857143,
              -1.9387755102040813, -1.7346938775510203, -1.5306122448979593,
              -1.3265306122448979, -1.1224489795918364, -0.9183673469387754,
              -0.7142857142857144, -0.5102040816326525, -0.3061224489795915,
              -0.1020408163265305,  0.1020408163265305,  0.3061224489795915,
               0.5102040816326534,  0.7142857142857144,  0.9183673469387754,
               1.1224489795918373,  1.3265306122448983,  1.5306122448979593,
               1.7346938775510203,  1.9387755102040813,  2.1428571428571432,
               2.3469387755102042,  2.5510204081632653,   2.755102040816327,
                2.959183673469388,   3.163265306122449,    3.36734693877551,
                3.571428571428571,   3.775510204081632,   3.979591836734695,
                4.183673469387756,   4.387755102040817,   4.591836734693878,
                4.795918367346939,                 5.0],
             dtype=&#x27;float64&#x27;, name=&#x27;lnz_0&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>lnz_1</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-450c90da-cc01-4929-8d63-592defad9b72' class='xr-index-data-in' type='checkbox'/><label for='index-450c90da-cc01-4929-8d63-592defad9b72' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([0.0], dtype=&#x27;float64&#x27;, name=&#x27;lnz_1&#x27;))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>phase</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-51eb6cd2-d477-4dc9-af6d-3f5461804a30' class='xr-index-data-in' type='checkbox'/><label for='index-51eb6cd2-d477-4dc9-af6d-3f5461804a30' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Int64Index([0, 1], dtype=&#x27;int64&#x27;, name=&#x27;phase&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-189c3730-5754-405c-aaae-a780d4a8ac93' class='xr-section-summary-in' type='checkbox'  checked><label for='section-189c3730-5754-405c-aaae-a780d4a8ac93' class='xr-section-summary' >Attributes: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>dims_n :</span></dt><dd>[&#x27;n_0&#x27;, &#x27;n_1&#x27;]</dd><dt><span>dims_lnz :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;lnz_1&#x27;]</dd><dt><span>dims_comp :</span></dt><dd>[&#x27;component&#x27;]</dd><dt><span>dims_state :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;lnz_1&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]</dd><dt><span>dims_rec :</span></dt><dd>[&#x27;sample&#x27;]</dd><dt><span>standard_name :</span></dt><dd>grand_potential</dd><dt><span>long_name :</span></dt><dd>$\beta \Omega(\mu,V,T)$</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">c</span><span class="o">.</span><span class="n">xge</span><span class="o">.</span><span class="n">betaOmega</span><span class="p">()</span><span class="o">.</span><span class="n">unstack</span><span class="p">()</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hue</span><span class="o">=</span><span class="s2">&quot;phase&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;matplotlib.lines.Line2D at 0x1a646e140&gt;,
 &lt;matplotlib.lines.Line2D at 0x1a641a980&gt;]
</pre></div>
</div>
<img alt="../_images/7bb8b370dc30afc885d06dc617343ddfd3055d3f750fe1fad9ee8fa753380531.png" src="../_images/7bb8b370dc30afc885d06dc617343ddfd3055d3f750fe1fad9ee8fa753380531.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># spinodal along line of constant lnz_2</span>

<span class="n">_</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">spinodal</span><span class="p">(</span><span class="n">phase_ids</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">build_phases</span><span class="o">=</span><span class="n">build_phases</span><span class="p">,</span> <span class="n">efac</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">_</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">binodal</span><span class="p">(</span><span class="n">phase_ids</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">build_phases</span><span class="o">=</span><span class="n">build_phases</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create table for spinodal/binodal</span>

<span class="n">t_spin</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">spinodal</span><span class="o">.</span><span class="n">access</span><span class="o">.</span><span class="n">xge</span><span class="o">.</span><span class="n">table</span><span class="p">([</span><span class="s2">&quot;molfrac&quot;</span><span class="p">],</span> <span class="n">ref</span><span class="o">=</span><span class="n">ref</span><span class="p">)</span>
<span class="n">t_bino</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">binodal</span><span class="o">.</span><span class="n">access</span><span class="o">.</span><span class="n">xge</span><span class="o">.</span><span class="n">table</span><span class="p">([</span><span class="s2">&quot;molfrac&quot;</span><span class="p">],</span> <span class="n">ref</span><span class="o">=</span><span class="n">ref</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t_spin</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:        (sample: 4, component: 2)
Coordinates:
  * sample         (sample) object MultiIndex
  * spinodal       (sample) int64 0 0 1 1
  * lnz_0          (sample) float64 1.202 1.202 -1.806 -1.806
  * lnz_1          (sample) float64 0.0 0.0 0.0 0.0
  * phase          (sample) int64 0 1 0 1
    beta           float64 1.0
    volume         float64 1.0
Dimensions without coordinates: component
Data variables:
    edge_distance  (sample) float64 31.11 1.0 31.11 29.7
    molfrac        (sample, component) float64 0.01297 0.987 ... 0.979 0.02102
    nvec           (sample, component) float64 2.715 206.5 252.4 ... 206.7 4.438
    betapV         (sample) float64 1.248e+03 1.705e+03 1.246e+03 996.1
Attributes:
    dims_n:      [&#x27;n_0&#x27;, &#x27;n_1&#x27;]
    dims_lnz:    [&#x27;lnz_0&#x27;, &#x27;lnz_1&#x27;]
    dims_comp:   [&#x27;component&#x27;]
    dims_state:  [&#x27;lnz_0&#x27;, &#x27;lnz_1&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]
    dims_rec:    [&#x27;sample&#x27;]
    long_name:   distance from upper edge</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-3ea2ff90-72e9-4b4a-825c-a6660c7f5a6e' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-3ea2ff90-72e9-4b4a-825c-a6660c7f5a6e' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>sample</span>: 4</li><li><span>component</span>: 2</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-bc5e6e96-83ca-4451-90ef-a0e18312db9f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-bc5e6e96-83ca-4451-90ef-a0e18312db9f' class='xr-section-summary' >Coordinates: <span>(7)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>sample</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>object</div><div class='xr-var-preview xr-preview'>MultiIndex</div><input id='attrs-fdcd87fd-6edc-4923-8b88-c67f0eae139d' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-fdcd87fd-6edc-4923-8b88-c67f0eae139d' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-680894e2-e710-44ce-b13a-eddd7f15618b' class='xr-var-data-in' type='checkbox'><label for='data-680894e2-e710-44ce-b13a-eddd7f15618b' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([(0, 1.2015754333333324, 0.0, 0), (0, 1.2015754333333324, 0.0, 1),
       (1, -1.8057242053333276, 0.0, 0), (1, -1.8057242053333276, 0.0, 1)],
      dtype=object)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>spinodal</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 0 1 1</div><input id='attrs-29818bf6-b6af-4cdd-b114-dd3213439923' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-29818bf6-b6af-4cdd-b114-dd3213439923' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-63c06f2d-9105-4ae2-b955-08d2e0674707' class='xr-var-data-in' type='checkbox'><label for='data-63c06f2d-9105-4ae2-b955-08d2e0674707' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 0, 1, 1])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lnz_0</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.202 1.202 -1.806 -1.806</div><input id='attrs-ff084d80-2f07-4bf0-9815-ab84e8d14b5e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-ff084d80-2f07-4bf0-9815-ab84e8d14b5e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-775bb275-ae22-4abf-aa37-69d51c088f44' class='xr-var-data-in' type='checkbox'><label for='data-775bb275-ae22-4abf-aa37-69d51c088f44' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([ 1.201575,  1.201575, -1.805724, -1.805724])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>lnz_1</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.0 0.0 0.0 0.0</div><input id='attrs-2afa8b1f-91da-42ec-957e-95f4df982503' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-2afa8b1f-91da-42ec-957e-95f4df982503' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-37f28fed-b671-462e-80c5-84a6152b4988' class='xr-var-data-in' type='checkbox'><label for='data-37f28fed-b671-462e-80c5-84a6152b4988' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0., 0., 0., 0.])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>phase</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>0 1 0 1</div><input id='attrs-b67959d7-5097-489b-917e-ab91574f9b70' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b67959d7-5097-489b-917e-ab91574f9b70' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-4701b58f-3f38-4742-9573-74bb8e9d259f' class='xr-var-data-in' type='checkbox'><label for='data-4701b58f-3f38-4742-9573-74bb8e9d259f' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([0, 1, 0, 1])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>beta</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.0</div><input id='attrs-408ffb1f-ad0f-4539-bd26-881455043a6e' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-408ffb1f-ad0f-4539-bd26-881455043a6e' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-83ccf603-b9a5-41d4-bc19-c69596a9e843' class='xr-var-data-in' type='checkbox'><label for='data-83ccf603-b9a5-41d4-bc19-c69596a9e843' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(1.)</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>volume</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.0</div><input id='attrs-b5c2a043-42f3-4bfb-9d48-936bdc9055c0' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-b5c2a043-42f3-4bfb-9d48-936bdc9055c0' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-41e76977-d00c-4dbd-b2c4-bfb3eb5c6aa5' class='xr-var-data-in' type='checkbox'><label for='data-41e76977-d00c-4dbd-b2c4-bfb3eb5c6aa5' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array(1.)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-04d0a9a7-b18b-484c-87ba-2c968ed3dc18' class='xr-section-summary-in' type='checkbox'  checked><label for='section-04d0a9a7-b18b-484c-87ba-2c968ed3dc18' class='xr-section-summary' >Data variables: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>edge_distance</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>31.11 1.0 31.11 29.7</div><input id='attrs-5748dc0b-1274-42de-a407-978984c23b86' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-5748dc0b-1274-42de-a407-978984c23b86' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-736bf4c9-4508-4d6d-8477-5357901d8397' class='xr-var-data-in' type='checkbox'><label for='data-736bf4c9-4508-4d6d-8477-5357901d8397' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>dims_n :</span></dt><dd>[&#x27;n_0&#x27;, &#x27;n_1&#x27;]</dd><dt><span>dims_lnz :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;lnz_1&#x27;]</dd><dt><span>dims_comp :</span></dt><dd>[&#x27;component&#x27;]</dd><dt><span>dims_state :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;lnz_1&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]</dd><dt><span>dims_rec :</span></dt><dd>[&#x27;sample&#x27;]</dd><dt><span>long_name :</span></dt><dd>distance from upper edge</dd></dl></div><div class='xr-var-data'><pre>array([31.11269837,  1.        , 31.11269837, 29.69848481])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>molfrac</span></div><div class='xr-var-dims'>(sample, component)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>0.01297 0.987 1.0 ... 0.979 0.02102</div><input id='attrs-e94764e0-dc77-4fc8-9bab-6c3b899c7f66' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-e94764e0-dc77-4fc8-9bab-6c3b899c7f66' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-7c1fd462-8267-4066-aaf3-ca74ac954ed3' class='xr-var-data-in' type='checkbox'><label for='data-7c1fd462-8267-4066-aaf3-ca74ac954ed3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>dims_n :</span></dt><dd>[&#x27;n_0&#x27;, &#x27;n_1&#x27;]</dd><dt><span>dims_lnz :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;lnz_1&#x27;]</dd><dt><span>dims_comp :</span></dt><dd>[&#x27;component&#x27;]</dd><dt><span>dims_state :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;lnz_1&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]</dd><dt><span>dims_rec :</span></dt><dd>[&#x27;sample&#x27;]</dd><dt><span>long_name :</span></dt><dd>${\bf x}(\mu,V,T)$</dd></dl></div><div class='xr-var-data'><pre>array([[1.29744853e-02, 9.87025515e-01],
       [9.99985806e-01, 1.41935483e-05],
       [3.17187024e-04, 9.99682813e-01],
       [9.78978241e-01, 2.10217585e-02]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>nvec</span></div><div class='xr-var-dims'>(sample, component)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>2.715 206.5 252.4 ... 206.7 4.438</div><input id='attrs-21f164a9-0094-40fc-b447-95d896e1d234' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-21f164a9-0094-40fc-b447-95d896e1d234' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-e54ff9eb-b806-4748-9b04-4e3cec808e67' class='xr-var-data-in' type='checkbox'><label for='data-e54ff9eb-b806-4748-9b04-4e3cec808e67' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>dims_n :</span></dt><dd>[&#x27;n_0&#x27;, &#x27;n_1&#x27;]</dd><dt><span>dims_lnz :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;lnz_1&#x27;]</dd><dt><span>dims_comp :</span></dt><dd>[&#x27;component&#x27;]</dd><dt><span>dims_state :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;lnz_1&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]</dd><dt><span>dims_rec :</span></dt><dd>[&#x27;sample&#x27;]</dd><dt><span>long_name :</span></dt><dd>${\bf n}(\mu,V,T)$</dd></dl></div><div class='xr-var-data'><pre>array([[2.71467322e+00, 2.06516996e+02],
       [2.52439940e+02, 3.58306932e-03],
       [6.67557447e-02, 2.10395021e+02],
       [2.06675356e+02, 4.43797344e+00]])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>betapV</span></div><div class='xr-var-dims'>(sample)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>1.248e+03 1.705e+03 1.246e+03 996.1</div><input id='attrs-2fd4eb09-8d8d-41ca-90fd-d1decd65ea04' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2fd4eb09-8d8d-41ca-90fd-d1decd65ea04' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-5a491177-76ed-46b4-af0a-890e2115eed1' class='xr-var-data-in' type='checkbox'><label for='data-5a491177-76ed-46b4-af0a-890e2115eed1' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>dims_n :</span></dt><dd>[&#x27;n_0&#x27;, &#x27;n_1&#x27;]</dd><dt><span>dims_lnz :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;lnz_1&#x27;]</dd><dt><span>dims_comp :</span></dt><dd>[&#x27;component&#x27;]</dd><dt><span>dims_state :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;lnz_1&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]</dd><dt><span>dims_rec :</span></dt><dd>[&#x27;sample&#x27;]</dd><dt><span>standard_name :</span></dt><dd>grand_potential</dd><dt><span>long_name :</span></dt><dd>$\beta p(\mu,V,T)V$</dd></dl></div><div class='xr-var-data'><pre>array([1248.00999152, 1705.21428595, 1246.18714097,  996.09560846])</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-764a1bf5-6a99-4bea-9b4d-a963f161da08' class='xr-section-summary-in' type='checkbox'  ><label for='section-764a1bf5-6a99-4bea-9b4d-a963f161da08' class='xr-section-summary' >Indexes: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>sample<br>spinodal<br>lnz_0<br>lnz_1<br>phase</div></div><div class='xr-index-preview'>PandasMultiIndex</div><div></div><input id='index-2f0958cc-eb4c-4937-b486-75252ae1b9ed' class='xr-index-data-in' type='checkbox'/><label for='index-2f0958cc-eb4c-4937-b486-75252ae1b9ed' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(MultiIndex([(0,  1.2015754333333324, 0.0, 0),
            (0,  1.2015754333333324, 0.0, 1),
            (1, -1.8057242053333276, 0.0, 0),
            (1, -1.8057242053333276, 0.0, 1)],
           name=&#x27;sample&#x27;))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-280b66cc-e3e4-433b-bc89-cf6824c504c6' class='xr-section-summary-in' type='checkbox'  checked><label for='section-280b66cc-e3e4-433b-bc89-cf6824c504c6' class='xr-section-summary' >Attributes: <span>(6)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'><dt><span>dims_n :</span></dt><dd>[&#x27;n_0&#x27;, &#x27;n_1&#x27;]</dd><dt><span>dims_lnz :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;lnz_1&#x27;]</dd><dt><span>dims_comp :</span></dt><dd>[&#x27;component&#x27;]</dd><dt><span>dims_state :</span></dt><dd>[&#x27;lnz_0&#x27;, &#x27;lnz_1&#x27;, &#x27;beta&#x27;, &#x27;volume&#x27;]</dd><dt><span>dims_rec :</span></dt><dd>[&#x27;sample&#x27;]</dd><dt><span>long_name :</span></dt><dd>distance from upper edge</dd></dl></div></li></ul></div></div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">t_spin</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="s2">&quot;sample&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span><span class="o">.</span><span class="n">query</span><span class="p">(</span>
    <span class="s2">&quot;component==0 and spinodal==phase&quot;</span>
<span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>spinodal</th>
      <th>lnz_0</th>
      <th>lnz_1</th>
      <th>phase</th>
      <th>beta</th>
      <th>volume</th>
      <th>edge_distance</th>
      <th>molfrac</th>
      <th>nvec</th>
      <th>betapV</th>
    </tr>
    <tr>
      <th>sample</th>
      <th>component</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <th>0</th>
      <td>0</td>
      <td>1.201575</td>
      <td>0.0</td>
      <td>0</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>31.112698</td>
      <td>0.012974</td>
      <td>2.714673</td>
      <td>1248.009992</td>
    </tr>
    <tr>
      <th>3</th>
      <th>0</th>
      <td>1</td>
      <td>-1.805724</td>
      <td>0.0</td>
      <td>1</td>
      <td>1.0</td>
      <td>1.0</td>
      <td>29.698485</td>
      <td>0.978978</td>
      <td>206.675356</td>
      <td>996.095608</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>doing this for multiple values of fixed <code class="docutils literal notranslate"><span class="pre">lnz_1</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">joblib</span> <span class="kn">import</span> <span class="n">Parallel</span><span class="p">,</span> <span class="n">delayed</span>
<span class="kn">from</span> <span class="nn">tqdm.notebook</span> <span class="kn">import</span> <span class="n">tqdm</span>


<span class="k">def</span> <span class="nf">get_bin_spin1</span><span class="p">(</span><span class="n">lnz2</span><span class="p">,</span> <span class="n">phase_creator</span><span class="p">,</span> <span class="n">from_builder</span><span class="p">,</span> <span class="n">from_builder_kws</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="c1"># reload stability here to make sure accessor available.</span>
    <span class="kn">import</span> <span class="nn">lnpy.stability</span>

    <span class="n">build_phases</span> <span class="o">=</span> <span class="n">phase_creator</span><span class="o">.</span><span class="n">build_phases_mu</span><span class="p">([</span><span class="kc">None</span><span class="p">,</span> <span class="n">lnz2</span><span class="p">])</span>
    <span class="n">lnzs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">from_builder_kws</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">from_builder_kws</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">from_builder</span><span class="p">(</span><span class="n">lnzs</span><span class="p">,</span> <span class="n">build_phases</span><span class="p">,</span> <span class="o">**</span><span class="n">from_builder_kws</span><span class="p">)</span>
    <span class="n">t_spin</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">t_bino</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">c</span><span class="o">.</span><span class="n">spinodal</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">build_phases</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">unstack</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">c</span><span class="o">.</span><span class="n">binodal</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">build_phases</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">unstack</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">t_spin</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">spinodal</span><span class="o">.</span><span class="n">access</span><span class="o">.</span><span class="n">xge</span><span class="o">.</span><span class="n">table</span><span class="p">([</span><span class="s2">&quot;molfrac&quot;</span><span class="p">],</span> <span class="n">ref</span><span class="o">=</span><span class="n">ref</span><span class="p">)</span>
        <span class="n">t_bino</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">binodal</span><span class="o">.</span><span class="n">access</span><span class="o">.</span><span class="n">xge</span><span class="o">.</span><span class="n">table</span><span class="p">([</span><span class="s2">&quot;molfrac&quot;</span><span class="p">],</span> <span class="n">ref</span><span class="o">=</span><span class="n">ref</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">pass</span>
    <span class="k">return</span> <span class="n">t_spin</span><span class="p">,</span> <span class="n">t_bino</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">out1</span> <span class="o">=</span> <span class="n">Parallel</span><span class="p">(</span><span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">)(</span>
    <span class="n">delayed</span><span class="p">(</span><span class="n">get_bin_spin1</span><span class="p">)(</span><span class="n">lnz2</span><span class="p">,</span> <span class="n">phase_creator</span><span class="p">,</span> <span class="n">lnpy</span><span class="o">.</span><span class="n">lnPiCollection</span><span class="o">.</span><span class="n">from_builder</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">lnz2</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">)</span>
<span class="p">)</span>
<span class="n">s</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;lnpy.segment.Segmenter at 0x1a66bfd00&gt;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">spin1</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">s</span> <span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">out1</span> <span class="k">if</span> <span class="n">s</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">],</span> <span class="s2">&quot;sample&quot;</span><span class="p">)</span>
<span class="n">bino1</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">b</span> <span class="k">for</span> <span class="n">s</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">out1</span> <span class="k">if</span> <span class="n">b</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">],</span> <span class="s2">&quot;sample&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_frame</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="o">**</span><span class="n">kws</span><span class="p">):</span>
    <span class="p">(</span>
        <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
        <span class="o">.</span><span class="n">set_index</span><span class="p">([</span><span class="s2">&quot;molfrac&quot;</span><span class="p">,</span> <span class="s2">&quot;phase&quot;</span><span class="p">])</span>
        <span class="o">.</span><span class="n">assign</span><span class="p">(</span><span class="n">pV</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;betapV&quot;</span><span class="p">]</span> <span class="o">/</span> <span class="n">x</span><span class="p">[</span><span class="s2">&quot;beta&quot;</span><span class="p">])[</span><span class="s2">&quot;pV&quot;</span><span class="p">]</span>
        <span class="o">.</span><span class="n">to_xarray</span><span class="p">()</span>
        <span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">hue</span><span class="o">=</span><span class="s2">&quot;phase&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kws</span><span class="p">)</span>
    <span class="p">)</span>


<span class="n">plot_frame</span><span class="p">(</span>
    <span class="n">spin1</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="s2">&quot;sample&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span>
    <span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;component==0 and spinodal==phase&quot;</span><span class="p">)</span>
    <span class="o">.</span><span class="n">dropna</span><span class="p">(),</span>
    <span class="n">ls</span><span class="o">=</span><span class="s2">&quot;--&quot;</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plot_frame</span><span class="p">(</span>
    <span class="n">bino1</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="s2">&quot;sample&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">to_dataframe</span><span class="p">()</span><span class="o">.</span><span class="n">query</span><span class="p">(</span><span class="s2">&quot;component==0&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">(),</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/d9d8278779a8ef70d777ba100a3dc80c3cc1c3c668b86fec6f3ddf4b29556ec4.png" src="../_images/d9d8278779a8ef70d777ba100a3dc80c3cc1c3c668b86fec6f3ddf4b29556ec4.png" />
</div>
</div>
</section>
</section>


                </article>
              

              
              
                <footer class="bd-footer-article">
                  <!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="../installation.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Installation</p>
      </div>
    </a>
    <a class="right-next"
       href="../reference/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">API reference</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Why <code class="docutils literal notranslate"><span class="pre">tmmc-lnpy</span></code>?</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#usage">Usage</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#lnpimasked">lnPiMasked</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#reweighting-results">Reweighting results</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#calculating-ensemble-properties">Calculating Ensemble properties</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#collections-of-lnpi-values">Collections of lnPi Values</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#accessing-properties-of-collection">Accessing properties of collection</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#loading-examples">Loading examples</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#single-component-system-with-phase-transitions">Single component system with phase transitions.</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#local-maxima">Local maxima</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#watershed">Watershed</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#local-free-energy">local free energy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#construct-collection">Construct collection</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#at-a-different-ln-z-value">At a different <span class="math notranslate nohighlight">\(\ln z\)</span> value</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#tagging-phases">Tagging phases</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#calculation-binodal-and-spinodal">Calculation Binodal and spinodal</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#multi-component-systems">Multi component systems</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#considering-lines-of-constant-ln-z-or-constant-delta-ln-z">Considering lines of constant <span class="math notranslate nohighlight">\(\ln z\)</span> or constant <span class="math notranslate nohighlight">\(\Delta \ln z\)</span>.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#multicomponent-system-with-phase-transitions">Multicomponent system with phase transitions</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            <div class="bd-footer-content__inner">
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By William P. Krekelberg
</p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    <p class="last-updated">
  Last updated on 2023-04-05.
  <br/>
</p>
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div></div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=12da95d707ffb74b382d"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=12da95d707ffb74b382d"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>